(function(t){function e(e){for(var s,r,o=e[0],l=e[1],c=e[2],u=0,h=[];u<o.length;u++)r=o[u],n[r]&&h.push(n[r][0]),n[r]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);d&&d(e);while(h.length)h.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],s=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(s=!1)}s&&(i.splice(e--,1),t=r(r.s=a[0]))}return t}var s={},n={app:0},i=[];function r(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=s,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(a,s,function(e){return t[e]}.bind(null,s));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var s=a("1356"),n=a.n(s);n.a},1356:function(t,e,a){},"15fa":function(t,e,a){"use strict";var s=a("e100"),n=a.n(s);n.a},1775:function(t,e,a){},2973:function(t,e,a){},"2c0b":function(t,e,a){},3244:function(t,e,a){"use strict";var s=a("2973"),n=a.n(s);n.a},"32e7":function(t,e,a){"use strict";var s=a("c2a5"),n=a.n(s);n.a},"355a":function(t,e,a){"use strict";var s=a("2c0b"),n=a.n(s);n.a},4678:function(t,e,a){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(t){var e=i(t);return a(e)}function i(t){var e=s[t];if(!(e+1)){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}return e}n.keys=function(){return Object.keys(s)},n.resolve=i,t.exports=n,n.id="4678"},"47e0":function(t,e,a){"use strict";var s=a("5eba"),n=a.n(s);n.a},"56d7":function(t,e,a){"use strict";a.r(e);var s=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[t.layout?a("simple-layout"):a("app-layout")],1)},i=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-navigation-drawer",{attrs:{"mini-variant":t.mini,app:"",clipped:""},scopedSlots:t._u([{key:"append",fn:function(){return[a("v-list-item",{staticClass:"elevation-24",on:{click:function(e){e.stopPropagation(),t.mini=!t.mini}}},[a("v-list-item-action",[t.mini?a("v-icon",[t._v("arrow_forward")]):a("v-icon",[t._v("arrow_back")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("COLLAPSE")])],1)],1)]},proxy:!0}]),model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{staticClass:"py-0",attrs:{dense:"",nav:"",dark:"",color:"#212121"}},[a("v-list-item",{attrs:{"two-line":""}},[a("v-list-item-avatar",[a("v-icon",{attrs:{large:""}},[t._v("person")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(t.username))]),a("v-list-item-subtitle",[t._v(t._s(t.email))])],1)],1)],1),a("v-divider"),t._l(t.routes,function(e){return a("v-list",{key:e.name,attrs:{dense:""}},[a("v-list-item",{attrs:{to:""+e.path}},[t.mini?a("v-list-item-action",[a("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(s){var n=s.on;return[a("v-icon",t._g({},n),[t._v(t._s(e.icon))])]}}],null,!0)},[a("span",[t._v(t._s(e.name))])])],1):a("v-list-item-action",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.name))])],1)],1)],1)}),a("v-divider"),a("v-list",{attrs:{dense:""}},[a("v-list-item",{attrs:{to:"/users"}},[t.mini?a("v-list-item-action",[a("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-icon",t._g({},s),[t._v("group")])]}}],null,!1,3527340433)},[a("span",[t._v("Users")])])],1):a("v-list-item-action",[a("v-icon",[t._v("group")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Users")])],1)],1),a("v-list-item",{attrs:{to:"/settings"}},[t.mini?a("v-list-item-action",[a("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-icon",t._g({},s),[t._v("settings")])]}}],null,!1,1926182315)},[a("span",[t._v("Settings")])])],1):a("v-list-item-action",[a("v-icon",[t._v("settings")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Settings")])],1)],1)],1)],2),a("v-app-bar",{attrs:{color:"black",dark:"",app:"","clipped-left":""}},[a("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),a("v-toolbar-title",{staticClass:"font-weight-bold"},[t._v("ALCALI")]),a("v-spacer"),a("v-expand-transition",[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:t.expand_search,expression:"expand_search"}],staticClass:"mx-auto",attrs:{flat:"","hide-details":"",label:"Search jids, minions, states...","solo-inverted":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchBar(e)}},model:{value:t.searchInput,callback:function(e){t.searchInput=e},expression:"searchInput"}})],1),a("v-btn",{staticClass:"mr-2",attrs:{icon:""},on:{click:function(e){t.expand_search=!t.expand_search}}},[a("v-icon",[t._v("mdi-magnify")])],1),a("v-menu",{attrs:{bottom:"",left:"","offset-y":"","offset-x":""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-badge",{attrs:{color:"primary",overlap:""},scopedSlots:t._u([{key:"badge",fn:function(){return[t.notif_nb>0?a("span",[t._v(t._s(t.notif_nb))]):t._e()]},proxy:!0}],null,!0)},[a("v-icon",t._g({on:{click:function(e){t.notif_nb=0}}},s),[t._v("notifications")])],1)]}}]),model:{value:t.notif_menu,callback:function(e){t.notif_menu=e},expression:"notif_menu"}},[a("v-card",{attrs:{"min-width":"500px","max-width":"500px"}},[a("v-list",{attrs:{"max-height":"700px"}},[0===t.messages.length?a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("No new notifications")])],1)],1):t._e(),t._l(t.messages,function(e,s){return a("v-list-item",{key:s,attrs:{to:e.link}},[a("v-list-item-avatar",[a("v-icon",{attrs:{dark:"",color:e.color,size:"62"}},[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.text))]),a("v-list-item-subtitle",[t._v(t._s(e.tag))])],1)],1)})],2),a("v-card-actions",{directives:[{name:"show",rawName:"v-show",value:t.messages.length>0,expression:"messages.length > 0"}]},[a("v-spacer"),a("v-btn",{attrs:{text:""},on:{click:function(e){t.messages=[]}}},[t._v("Clear")])],1)],1)],1),a("v-menu",{attrs:{bottom:"",left:"","offset-y":"","offset-x":"","close-on-click":""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-btn",t._g({attrs:{icon:""}},s),[a("v-icon",[t._v("mdi-dots-vertical")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:t.toggleTheme}},[a("v-list-item-title",[t._v("Toggle Theme")])],1),a("v-divider"),a("v-list-item",{on:{click:t.logout}},[a("v-list-item-title",[t._v("Logout")])],1)],1)],1)],1),a("v-content",[a("v-container",[a("v-fade-transition",{attrs:{mode:"out-in"}},[a("router-view")],1)],1)],1)],1)},o=[],l={methods:{fnmatch(t){if(-1===t.indexOf("*"))return e=>t===e;{let e=/[\\^$.*+?()[\]{}|]/g,a=t.replace(e,"\\$&"),s=new RegExp("^"+a.replace(/\\\*/g,".*")+"$");return t=>s.test(t)}},sleep(t){return new Promise(e=>setTimeout(e,t))}}},c={name:"Layout",props:{source:String},data:()=>({expand_search:!1,notif_menu:!1,searchInput:"",drawer:!0,mini:!0,messages:[],settings:null,notif_nb:0,notifs:{created:!1,published:!1,returned:!1,event:!1},routes:[{name:"Overview",path:"/",icon:"dashboard"},{name:"Minions",path:"/minions",icon:"device_hub"},{name:"Jobs",path:"/jobs",icon:"playlist_play"},{name:"Run",path:"/run",icon:"play_arrow"},{name:"Schedules",path:"/schedules",icon:"schedule"},{name:"Conformity",path:"/conformity",icon:"done_all"},{name:"Keys",path:"/keys",icon:"compare_arrows"},{name:"Events",path:"/events",icon:"playlist_add"}]}),methods:{logout:function(){this.$store.dispatch("logout").then(()=>{this.$router.push("/login")})},searchBar(){""!==this.searchInput&&this.$router.push({name:"search",query:{q:this.searchInput}})},getPrefs(){this.$http.get("api/userssettings/"+this.$store.getters.user_id+"/").then(t=>{this.settings=t.data,Object.keys(this.notifs).forEach(t=>{this.notifs[t]=this.settings["notifs_"+t]})})},toggleTheme(){this.$store.dispatch("toggleTheme").then(()=>{this.$vuetify.theme.dark=JSON.parse(this.$store.state.theme)})},saltStatus(){let t=l.methods.fnmatch("salt/job/*"),e=l.methods.fnmatch("salt/job/*/new"),a=l.methods.fnmatch("salt/job/*/ret/*"),s=new EventSource("/api/event_stream/");s.addEventListener("open",()=>{this.$store.dispatch("updateWs")}),s.addEventListener("message",s=>{let n=JSON.parse(s.data);if(e(n.tag)&&!0===this.notifs.published){n.type="new",n.color="green",n.icon="keyboard_tab",n.link="";let t="";t=n.data.hasOwnProperty("tgt")?n.data.tgt:n.data.minions.length+" minion(s)",n.text="Job "+n.data.fun+" published for "+t,this.messages.unshift(n),this.messages.length>this.settings.max_notifs&&this.messages.pop(),this.notif_nb+=1}else a(n.tag)&&!0===this.notifs.returned?(n.type="return",n.color="primary",n.icon="subdirectory_arrow_left",n.text="Job "+n.data.fun+" returned for "+n.data.id,n.link="/jobs/"+n.data.jid+"/"+n.data.id,this.messages.unshift(n),this.messages.length>this.settings.max_notifs&&this.messages.pop(),this.notif_nb+=1):t(n.tag)&&!0===this.notifs.event?(n.type="event",n.color="orange",n.icon="more_horiz",n.text="Job Event",n.link="",this.messages.unshift(n),this.messages.length>this.settings.max_notifs&&this.messages.pop(),this.notif_nb+=1):/^\w{20}$/.test(n.tag)&&!0===this.notifs.created&&(n.type="created",n.color="secondary",n.icon="add",n.text="New Job Created",n.link="",this.messages.unshift(n),this.messages.length>this.settings.max_notifs&&this.messages.pop(),this.notif_nb+=1)},!1)}},mounted(){this.getPrefs(),this.saltStatus(),this.$vuetify.theme.dark=JSON.parse(this.$store.getters.theme)},computed:{username(){return this.$store.state.username},email(){return this.$store.state.email},theme(){return this.$store.state.theme}}},d=c,u=(a("355a"),a("2877")),h=a("6544"),m=a.n(h),v=a("7496"),p=a("40dc"),f=a("5bc1"),b=a("4ca6"),_=a("8336"),g=a("b0af"),y=a("99d9"),x=a("a523"),k=a("a75b"),C=a("ce7e"),w=a("0789"),j=a("132d"),V=a("8860"),S=a("da13"),T=a("1800"),$=a("8270"),D=a("5d23"),O=a("e449"),E=a("f774"),R=a("2fa4"),A=a("8654"),I=a("2a7f"),F=a("3a2f"),P=Object(u["a"])(d,r,o,!1,null,null,null),M=P.exports;m()(P,{VApp:v["a"],VAppBar:p["a"],VAppBarNavIcon:f["a"],VBadge:b["a"],VBtn:_["a"],VCard:g["a"],VCardActions:y["a"],VContainer:x["a"],VContent:k["a"],VDivider:C["a"],VExpandTransition:w["a"],VFadeTransition:w["d"],VIcon:j["a"],VList:V["a"],VListItem:S["a"],VListItemAction:T["a"],VListItemAvatar:$["a"],VListItemContent:D["a"],VListItemSubtitle:D["b"],VListItemTitle:D["c"],VMenu:O["a"],VNavigationDrawer:E["a"],VSpacer:R["a"],VTextField:A["a"],VToolbarTitle:I["a"],VTooltip:F["a"]});var L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("router-view")},N=[],U={name:"SimpleLayout"},z=U,B=Object(u["a"])(z,L,N,!1,null,"0f66a338",null),J=B.exports,q={computed:{layout(){return this.$route.meta.plainLayout}},components:{"app-layout":M,"simple-layout":J}},H=q,K=(a("034f"),Object(u["a"])(H,n,i,!1,null,null,null)),G=K.exports;m()(K,{VApp:v["a"]});a("5363");var W=a("f309"),Y=a("2db4"),Q=a("87f6"),X=a.n(Q);s["a"].use(W["a"],{components:{VSnackbar:Y["a"],VBtn:_["a"],VIcon:j["a"]}}),s["a"].use(X.a,{x:"center",y:"bottom",color:"black",icon:"info",iconColor:"",classes:["body-2"],timeout:3e3,dismissable:!0,multiLine:!1,vertical:!1,queueable:!1,showClose:!0,closeText:"",closeColor:"",shorts:{custom:{color:"purple"}},property:"$toast"});var Z=new W["a"]({icons:{iconfont:"md"},theme:{themes:{light:{primary:"#6200EE",secondary:"#03DAC6"},dark:{secondary:"#BB86FC",primary:"#03DAC6"}}}}),tt=a("8c4f"),et=a("2f62"),at=a("bc3a"),st=a.n(at);s["a"].use(et["a"]);var nt=new et["a"].Store({state:{username:localStorage.getItem("username")||"",email:localStorage.getItem("email")||"",id:localStorage.getItem("id")||"",access:localStorage.getItem("access")||"",refresh:localStorage.getItem("refresh")||"",ws_status:!1,theme:localStorage.getItem("theme")||!1},mutations:{auth_success(t,e){Object.keys(e).forEach(a=>{t[a]=e[a]})},logout(t){t.access=""},updateWs(t){t.ws_status=!0},toggleTheme(t){t.theme=!t.theme,localStorage.setItem("theme",JSON.stringify(t.theme))}},getters:{isLoggedIn:t=>!!t.access,theme:t=>t.theme,user_id:t=>t.id},actions:{updateWs({commit:t}){t("updateWs")},toggleTheme({commit:t}){t("toggleTheme")},login({commit:t},e){return new Promise((a,s)=>{st()({url:"/api/token/",data:e,method:"POST"}).then(e=>{Object.keys(e.data).forEach(t=>{localStorage.setItem(t,e.data[t])}),st.a.defaults.headers.common.Authorization=`Bearer ${e.data.access}`,t("auth_success",e.data),a(e)}).catch(t=>{localStorage.clear(),s(t)})})},logout({commit:t}){return new Promise(e=>{t("logout"),localStorage.clear(),delete st.a.defaults.headers.common["Authorization"],e()})}}}),it=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"7"}},[a("ConformityChart")],1),a("v-col",{attrs:{sm:"6",lg:"2"}},[a("KeysStatusCard")],1),a("v-col",{attrs:{sm:"6",lg:"3"}},[a("AlcaliStatusCard")],1)],1),a("v-row",[a("v-col",{attrs:{lg:"12"}},[a("JobsChartCard")],1)],1),a("v-row",[a("v-col",{attrs:{lg:"12"}},[a("JobsTable",{attrs:{filter:{limit:10}}})],1)],1)],1)},rt=[],ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Keys")]),a("v-simple-table",[a("tbody",t._l(t.keys_status,function(e,s){return a("tr",{key:s},[a("td",{staticClass:"pr-0"},[a("v-icon",[t._v(t._s(t.statusIcon(s)))])],1),a("td",{staticClass:"pl-0"},[t._v(t._s(s))]),a("td",{staticClass:"text-right"},[t._v(t._s(e)+" / "+t._s(t.keys_total))])])}),0)])],1)],1)},lt=[],ct={name:"KeysStatusCard",data(){return{keys_status:{},keys_total:0}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/keys/keys_status/").then(t=>{this.keys_status=t.data,this.keys_total=Object.values(t.data).reduce((t,e)=>t+e)})},statusIcon(t){switch(t){case"accepted":return"check";case"rejected":return"first_page";case"denied":return"close";case"unaccepted":return"refresh"}}}},dt=ct,ut=a("1f4f"),ht=Object(u["a"])(dt,ot,lt,!1,null,"b6756222",null),mt=ht.exports;m()(ht,{VCard:g["a"],VCardTitle:y["c"],VContainer:x["a"],VIcon:j["a"],VSimpleTable:ut["a"]});var vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",{attrs:{elevation:null==t.minion?2:0}},[a("v-list-item",{attrs:{"three-line":"",dense:""}},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"headline mb-1"},[t._v("Jobs Stats")])],1),a("v-spacer"),a("v-list-item-content",{staticClass:"mr-6"},[a("v-select",{attrs:{items:t.filters,label:"Filter","return-object":""},on:{change:t.loadData},model:{value:t.selectedFilter,callback:function(e){t.selectedFilter=e},expression:"selectedFilter"}})],1),a("v-list-item-content",[a("v-select",{attrs:{items:t.periods,label:"Period","return-object":""},on:{change:t.loadData},model:{value:t.selectedPeriod,callback:function(e){t.selectedPeriod=e},expression:"selectedPeriod"}})],1)],1),a("canvas",{ref:"chart"})],1)],1)},pt=[],ft=a("30ef"),bt=a.n(ft);let _t={afterLayout:function(t){if(t.options.linearGradientLine){let e=t.chart.ctx;t.data.datasets.forEach(a=>{let s=Number.MAX_VALUE,n=Number.MIN_VALUE;for(let t=0;t<a.data.length;++t)s>a.data[t]&&(s=a.data[t]),n<a.data[t]&&(n=a.data[t]);let i=t.scales["y-axis-0"],r=i.getPixelForValue(s),o=i.getPixelForValue(n),l=e.createLinearGradient(0,r,0,o);l.addColorStop(0,a.colorStart),l.addColorStop(1,a.colorEnd),a.borderColor=l})}else if(t.options.radialGradientDonut){let e=t.chart.ctx;t.data.datasets.forEach(a=>{let s=(t.chartArea.left+t.chartArea.right)/2,n=(t.chartArea.top+t.chartArea.bottom)/2,i=e.createRadialGradient(s,n,2*t.innerRadius*.2,s,n,2*t.innerRadius);i.addColorStop(0,a.colorStart),i.addColorStop(1,a.colorEnd),a.backgroundColor=i})}}};var gt=_t,yt={name:"JobsChartCard",props:["minion"],data(){return{filters:[{text:"All",value:"all"},{text:"Highstate",value:"highstate"},{text:"Other",value:"other"}],periods:[{text:"Week",value:7},{text:"Two Weeks",value:14},{text:"Month",value:30},{text:"Year",value:365}],jobchart:null,selectedFilter:null,selectedPeriod:null,labels:null,chart_data:[]}},mounted(){this.createChart()},methods:{loadData(){let t=null==this.selectedFilter?"all":this.selectedFilter.value,e=null==this.selectedPeriod?7:this.selectedPeriod.value,a={params:{fun:t,period:e}};this.minion&&(a.params.id=this.minion),this.$http.get("api/jobs/graph",a).then(t=>{this.jobchart.data.labels=t.data.labels,this.jobchart.data.datasets[0].data=t.data.series[0],this.jobchart.data.datasets[1].data=t.data.series[1],this.jobchart.update()})},createChart(){let t=null==this.selectedFilter?"all":this.selectedFilter.value,e=null==this.selectedPeriod?7:this.selectedPeriod.value,a={params:{fun:t,period:e}};this.minion&&(a.params.id=this.minion),null!=this.jobchart&&this.jobchart.destroy(),this.$http.get("api/jobs/graph",a).then(t=>{this.labels=t.data.labels,this.chart_data[0]=t.data.series[0],this.chart_data[1]=t.data.series[1],this.$refs.chart.height=60,this.jobchart=new bt.a(this.$refs.chart,{type:"line",data:{labels:this.labels,datasets:[{lineTension:.1,pointRadius:1,data:this.chart_data[0],fill:!1,colorStart:"rgba(0, 173, 238, 1.0)",colorEnd:"rgba(231, 18, 143, 1.0)"},{lineTension:.1,pointRadius:1,data:this.chart_data[1],fill:!1,colorStart:"rgba(255, 255, 255, 1.0)",colorEnd:"rgba(255, 0, 0, 1.0)"}]},options:{linearGradientLine:!0,legend:{display:!1},scales:{xAxes:[{gridLines:{display:!0}}],yAxes:[{gridLines:{display:!0},ticks:{autoSkip:!0,beginAtZero:!0,maxTicksLimit:6}}]},responsive:!0},plugins:[gt]})})}}},xt=yt,kt=a("b974"),Ct=Object(u["a"])(xt,vt,pt,!1,null,"e0df043e",null),wt=Ct.exports;m()(Ct,{VCard:g["a"],VContainer:x["a"],VListItem:S["a"],VListItemContent:D["a"],VListItemTitle:D["c"],VSelect:kt["a"],VSpacer:R["a"]});var jt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Status")]),a("v-simple-table",[a("tbody",[a("tr",[a("td",[t._v("Salt WebSocket")]),a("td",{staticClass:"text-right"},[a("v-chip",{attrs:{color:t.wsStatus?"green":"red","text-color":"white"}},[t._v("\n            "+t._s(t.wsStatus?"OK":"NOT OK")+"\n          ")])],1)]),t._l(t.stats,function(e,s){return a("tr",{key:s},[a("td",[t._v(t._s(s))]),a("td",{staticClass:"text-right"},[t._v(t._s(e))])])})],2)])],1)],1)},Vt=[],St={name:"AlcaliStatusCard",mixins:[l],data(){return{stats:{}}},mounted(){this.loadData()},computed:{wsStatus(){return this.$store.state.ws_status}},methods:{loadData(){this.$http.get("api/stats/").then(t=>this.stats=t.data)}}},Tt=St,$t=a("cc20"),Dt=Object(u["a"])(Tt,jt,Vt,!1,null,"1eb41eb0",null),Ot=Dt.exports;m()(Dt,{VCard:g["a"],VCardTitle:y["c"],VChip:$t["a"],VContainer:x["a"],VSimpleTable:ut["a"]});var Et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Conformity")]),a("v-card-text",[a("v-container",[t._l(t.conformitynames,function(e){return[a("v-row",{key:e,attrs:{"no-gutters":"",align:"center",justify:"center"}},[a("v-col",{attrs:{sm:"2"}},[t._v(t._s(e))]),a("v-col",{attrs:{sm:"10"}},[a("v-menu",{attrs:{"open-on-hover":"","max-width":"250px"},scopedSlots:t._u([{key:"activator",fn:function(s){var n=s.on;return[a("canvas",t._g({ref:e,refInFor:!0,attrs:{height:"15"}},n))]}}],null,!0)},[a("v-simple-table",{attrs:{dense:""}},[a("thead",[a("tr",[a("th",[t._v(t._s(e))])])]),a("tbody",{domProps:{innerHTML:t._s(t.customTool)}})])],1)],1)],1)]})],2)],1)],1)],1)},Rt=[],At=(a("02d0"),a("fcf4")),It={name:"ConformityChart",data(){return{conformitynames:null,confchart:null,conformity:null,customTool:""}},created(){},mounted(){this.loadConformity()},methods:{loadConformity(){this.$http.get("api/minions/conformity/").then(t=>{this.conformity=t.data.data,this.conformitynames=t.data.name}).then(()=>{this.conformity.forEach((t,e)=>{let a={labels:[this.conformitynames[e]],datasets:[]};Object.keys(t).forEach(e=>{let s="";if(["conflict","false"].indexOf(e)>=0)s="#F44336";else if(["conform","true"].indexOf(e)>=0)s="#41f40e";else if(["None","unknown","null"].indexOf(e)>=0)s=this.$vuetify.theme.themes.light.primary;else{let t=Object.keys(At["a"]);s=At["a"][t[t.length*Math.random()<<0]].darken2}a.datasets.push({label:e,data:[t[e]],backgroundColor:s})}),new bt.a(this.$refs[this.conformitynames[e]],{type:"horizontalBar",data:a,options:{animation:!1,plugins:{stacked100:{enable:!0}},tooltips:{enabled:!1,mode:"index",intersect:!1,custom:t=>{if(t&&t.body){let e=t.body.map(t=>t.lines),a="";e.forEach(function(e,s){let n=t.labelColors[s],i="background:"+n.backgroundColor;i+="; border-color:"+n.borderColor,i+="; border-width: 2px";let r=`<span class="chartjs-tooltip-key" style="${i}">__</span>`;a+="<tr><td>"+r+"  "+e+"</td></tr>"}),this.customTool=a}}},legend:{display:!1},scales:{xAxes:[{stacked:!0,display:!1,gridLines:{display:!1,drawTicks:!1,drawBorder:!1},ticks:{display:!1,padding:-20}}],yAxes:[{stacked:!0,display:!1,ticks:{display:!1,padding:-20},gridLines:{drawTicks:!1,display:!1,drawBorder:!1}}]}}})})})}}},Ft=It,Pt=(a("3244"),a("62ad")),Mt=a("0fd9"),Lt=Object(u["a"])(Ft,Et,Rt,!1,null,"bcf3f6c0",null),Nt=Lt.exports;m()(Lt,{VCard:g["a"],VCardText:y["b"],VCardTitle:y["c"],VCol:Pt["a"],VContainer:x["a"],VMenu:O["a"],VRow:Mt["a"],VSimpleTable:ut["a"]});var Ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[null==t.filter?a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{sm:"12"}},[a("v-card",{staticClass:"mb-8"},[a("v-row",[a("v-col",{attrs:{lg:"2"}},[a("v-card-title",[t._v("Search Jobs")])],1),a("v-divider"),a("v-col",{attrs:{lg:"2","align-self":"center"}},[a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":t.selectedDate,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":function(e){t.selectedDate=e},"update:return-value":function(e){t.selectedDate=e}},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-text-field",t._g({attrs:{label:"Select date(s)",readonly:""},model:{value:t.dateRangeText,callback:function(e){t.dateRangeText=e},expression:"dateRangeText"}},s))]}}],null,!1,4129137489),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-date-picker",{attrs:{max:(new Date).toISOString().split("T")[0],reactive:"","no-title":"",range:""},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}},[a("div",{staticClass:"flex-grow-1"}),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu=!1}}},[t._v("Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu.save(t.selectedDate)}}},[t._v("OK")])],1)],1)],1),a("v-col",{attrs:{lg:"2"}},[a("v-autocomplete",{attrs:{items:t.users,label:"User(s)",multiple:"","single-line":""},scopedSlots:t._u([{key:"selection",fn:function(e){var s=e.item,n=e.index;return[0===n?a("span",[t._v(t._s(s))]):t._e(),1===n?a("span",{staticClass:"grey--text caption"},[t._v(" (+"+t._s(t.selectedUsers.length-1)+" others)")]):t._e()]}}],null,!1,2591977476),model:{value:t.selectedUsers,callback:function(e){t.selectedUsers=e},expression:"selectedUsers"}})],1),a("v-col",{attrs:{lg:"2"}},[a("v-autocomplete",{attrs:{items:t.minions,label:"Target(s)",multiple:"","single-line":""},scopedSlots:t._u([{key:"selection",fn:function(e){var s=e.item,n=e.index;return[0===n?a("span",[t._v(t._s(s))]):t._e(),1===n?a("span",{staticClass:"grey--text caption"},[t._v(" (+"+t._s(t.selectedTarget.length-1)+" others)")]):t._e()]}}],null,!1,3190666039),model:{value:t.selectedTarget,callback:function(e){t.selectedTarget=e},expression:"selectedTarget"}})],1),a("v-col",{attrs:{lg:"1"}},[a("v-select",{attrs:{items:t.limit,label:"Limit","single-line":""},model:{value:t.selectedLimit,callback:function(e){t.selectedLimit=e},expression:"selectedLimit"}})],1),a("v-col",{attrs:{lg:"1","align-self":"center"}},[a("div",{staticClass:"text-center"},[a("v-btn",{attrs:{color:"primary"},on:{click:t.filterJobs}},[t._v("Search\n              ")])],1)])],1)],1)],1)],1):t._e(),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{sm:"12"}},[a("v-card",{attrs:{elevation:null==t.filter?2:0}},[a("v-card-title",[t._v("\n          Jobs\n          "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"jid","sort-desc":"","item-key":"uniqueid",headers:t.headers,items:t.indexedItems,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.jid",fn:function(e){var s=e.item;return[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/jobs/"+s.jid+"/"+s.id}},[t._v(t._s(s.jid))])]}},{key:"item.arguments",fn:function(e){var a=e.item;return[t._v("\n            "+t._s(a.arguments.length>20?a.arguments.slice(0,20)+"...":a.arguments)+"\n          ")]}},{key:"item.success",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(s.success),dark:""}},[t._v(t._s(t.boolText(s.success)))])]}},{key:"item.alter_time",fn:function(e){var a=e.item;return[t._v("\n            "+t._s(new Date(a.alter_time).toLocaleString("en-GB"))+"\n          ")]}},{key:"item.action",fn:function(e){var s=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue",tile:"",dark:"",to:"/jobs/"+s.jid+"/"+s.id}},[t._v("\n                detail\n              ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue-grey",tile:"",dark:"",to:"/run/?target="+s.id+"&function="+s.fun+"&args="+s.arguments}},[t._v("\n                rerun\n              ")])],1)]}}])})],1)],1)],1)],1)},zt=[],Bt={name:"JobsTable",props:["filter"],data(){return{menu:!1,limit:[50,100,200,500,1e3],selectedDate:[],selectedLimit:null,selectedUsers:null,selectedTarget:null,minions:[],users:[],search:"",headers:[{text:"Jid",value:"jid"},{text:"Target",value:"id"},{text:"Function",value:"fun"},{text:"Arguments",value:"arguments"},{text:"User",value:"user"},{text:"Status",value:"success"},{text:"Date",value:"alter_time"},{text:"Actions",value:"action",sortable:!1}],jobs:[],loading:!0}},computed:{indexedItems(){return this.jobs.map((t,e)=>({uniqueid:e,...t}))},dateRangeText(){return this.selectedDate.join(" ~ ")}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/jobs/filters/").then(t=>{this.minions=t.data.minions,this.users=t.data.users}),this.$http.get("api/jobs/",{params:this.filter}).then(t=>{this.jobs=t.data,this.loading=!1})},filterJobs(){this.loading=!0;let t={limit:this.selectedLimit,target:this.selectedTarget,users:this.selectedUsers};this.selectedDate.length>0&&(t.start=this.selectedDate[0],t.end=this.selectedDate[1]||this.selectedDate[0]),this.$http.get("api/jobs/",{params:t}).then(t=>{this.jobs=t.data,this.loading=!1,this.selectedUsers=this.selectedTarget=this.selectedLimit=this.selectedDate=null,this.selectedDate=[]})},boolRepr(t){return!0===t?"green":"red"},boolText(t){return!0===t?"success":"failed"}}},Jt=Bt,qt=a("c6a6"),Ht=a("8fea"),Kt=a("2e4b"),Gt=Object(u["a"])(Jt,Ut,zt,!1,null,"87a068fc",null),Wt=Gt.exports;m()(Gt,{VAutocomplete:qt["a"],VBtn:_["a"],VCard:g["a"],VCardTitle:y["c"],VChip:$t["a"],VCol:Pt["a"],VContainer:x["a"],VDataTable:Ht["a"],VDatePicker:Kt["a"],VDivider:C["a"],VMenu:O["a"],VRow:Mt["a"],VSelect:kt["a"],VSpacer:R["a"],VTextField:A["a"]});var Yt={name:"home",components:{JobsTable:Wt,ConformityChart:Nt,AlcaliStatusCard:Ot,KeysStatusCard:mt,JobsChartCard:wt}},Qt=Yt,Xt=Object(u["a"])(Qt,it,rt,!1,null,null,null),Zt=Xt.exports;m()(Xt,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var te=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{attrs:{id:"inspire"}},[a("v-content",[a("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"12",sm:"8",md:"4"}},[a("h1",{staticClass:"text-center font-weight-bold display-4 mb-8"},[t._v("ALCALI")]),a("v-card",{staticClass:"elevation-12"},[a("v-toolbar",{attrs:{color:"black",dark:"",flat:""}},[a("v-toolbar-title",[t._v("Login")]),a("v-spacer")],1),a("v-card-text",[a("v-form",[a("v-text-field",{attrs:{label:"Login",name:"login","prepend-icon":"person",type:"text"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),a("v-text-field",{attrs:{label:"Password",name:"password","prepend-icon":"lock",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(e){return e.preventDefault(),t.authenticate(e)}}},[t._v("Login")])],1)],1)],1)],1)],1)],1)],1)},ee=[],ae={name:"Login",data:()=>({username:null,password:null}),methods:{authenticate(){let t=this.username,e=this.password;this.$store.dispatch("login",{username:t,password:e}).then(()=>this.$router.push("/"))}}},se=ae,ne=(a("47e0"),a("4bd4")),ie=a("71d9"),re=Object(u["a"])(se,te,ee,!1,null,"258c6f62",null),oe=re.exports;m()(re,{VApp:v["a"],VBtn:_["a"],VCard:g["a"],VCardActions:y["a"],VCardText:y["b"],VCol:Pt["a"],VContainer:x["a"],VContent:k["a"],VForm:ne["a"],VRow:Mt["a"],VSpacer:R["a"],VTextField:A["a"],VToolbar:ie["a"],VToolbarTitle:I["a"]});var le=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",cols:"12"}},[a("JobsTable")],1)],1)],1)},ce=[],de={name:"Jobs",components:{JobsTable:Wt}},ue=de,he=Object(u["a"])(ue,le,ce,!1,null,"4867fa69",null),me=he.exports;m()(he,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var ve=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("KeysTable",{key:t.refreshKey})],1)],1),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)},pe=[],fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("\n      Keys\n      "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion_id",headers:t.headers,items:t.keys,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.minion_id",fn:function(e){var s=e.item;return["accepted"===s.status?[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/minions/"+s.minion_id}},[t._v(t._s(s.minion_id))])]:[t._v("\n          "+t._s(s.minion_id)+"\n        ")]]}},{key:"item.status",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{color:t.keysRepr(s.status),dark:""}},[t._v(t._s(s.status))])]}},{key:"item.action",fn:function(e){var s=e.item;return[t._l(t.keyAction(s.status),function(e){return[a("v-btn",{key:e,staticClass:"ma-2",attrs:{small:"",dark:"",color:t.keysRepr(e)},on:{click:function(a){return t.manageKey(e,s.minion_id)}}},[t._v("\n            "+t._s(e)+"\n          ")])]})]}}])})],1)],1)},be=[],_e={name:"KeysTable",data(){return{search:"",headers:[{text:"Minion Id",value:"minion_id"},{text:"Status",value:"status"},{text:"Public Key",value:"pub"},{text:"Actions",value:"action",sortable:!1}],keys:[],loading:!0}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/keys/").then(t=>{this.keys=t.data,this.loading=!1})},sleep(t){return new Promise(e=>setTimeout(e,t))},keysRepr(t){return t.startsWith("accept")?"green":t.startsWith("reject")?"orange":t.startsWith("de")?"red":"grey"},keyAction(t){return"accepted"===t?["reject","delete"]:"rejected"===t?["accept","delete"]:"denied"===t?["accept"]:["accept","delete"]},manageKey(t,e){let a=new FormData;a.set("action",t),a.set("target",e),this.$http.post("api/keys/manage_keys/",a).then(t=>{this.$toast(t.data.result)}),this.sleep(2e3).then(()=>{this.loadData()})}}},ge=_e,ye=Object(u["a"])(ge,fe,be,!1,null,"cc44cbf4",null),xe=ye.exports;m()(ye,{VBtn:_["a"],VCard:g["a"],VCardTitle:y["c"],VChip:$t["a"],VContainer:x["a"],VDataTable:Ht["a"],VSpacer:R["a"],VTextField:A["a"]});var ke=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-speed-dial",{attrs:{fixed:"",bottom:"",right:"",direction:"top",transition:"slide-y-reverse-transition"},scopedSlots:t._u([{key:"activator",fn:function(){return[a("v-btn",{attrs:{color:"primary",fab:""},model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[t.fab?a("v-icon",[t._v("close")]):a("v-icon",[t._v("menu")])],1)]},proxy:!0}]),model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[t._l(t.fabs,function(e){return[a("v-tooltip",{key:e.tooltip,attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(s){var n=s.on;return[a("v-btn",t._g({attrs:{fab:"",dark:"",small:"",color:e.color},on:{click:function(a){return t.emit("fab_action",e.action)}}},n),[a("v-icon",[t._v(t._s(e.icon))])],1)]}}],null,!0)},[a("span",[t._v(t._s(e.tooltip))])])]})],2)},Ce=[],we={name:"Fab",props:["fabs"],methods:{emit(t,e){this.$emit(t,e)}},data:()=>({fab:!1})},je=we,Ve=a("c73b"),Se=Object(u["a"])(je,ke,Ce,!1,null,"56c34fbd",null),Te=Se.exports;m()(Se,{VBtn:_["a"],VIcon:j["a"],VSpeedDial:Ve["a"],VTooltip:F["a"]});var $e={name:"Keys",components:{Fab:Te,KeysTable:xe},data:()=>({fabs:[{color:"blue",action:"refreshKeys",icon:"compare_arrows",tooltip:"Refresh keys"},{color:"orange",action:"rejectAll",icon:"close",tooltip:"Reject all keys"},{color:"green",action:"acceptAll",icon:"done",tooltip:"Accept all keys"}],refreshKey:0}),methods:{fabAction(t){this[t]()},refreshKeys(){this.$toast("refreshing keys"),this.$http.post("/api/keys/refresh/").then(()=>{this.$toast("keys refreshed")}).then(()=>{this.refreshKey+=1}).catch(function(t){alert(t)})},acceptAll(){let t=new FormData;t.set("action","accept"),t.set("target","*"),this.$http.post("api/keys/manage_keys/",t).then(t=>{this.$toast(t.data.result)}).then(()=>{this.refreshKey+=1})},rejectAll(){let t=new FormData;t.set("action","reject"),t.set("target","*"),this.$http.post("api/keys/manage_keys/",t).then(t=>{this.$toast(t.data.result)}).then(()=>{this.refreshKey+=1})}}},De=$e,Oe=Object(u["a"])(De,ve,pe,!1,null,"47322cce",null),Ee=Oe.exports;m()(Oe,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var Re=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",cols:"12"}},[a("MinionsTable",{key:t.refreshKey}),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)],1)],1)},Ae=[],Ie=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("\n      Minions\n      "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion_id",headers:t.headers,items:t.minions,search:t.search,loading:t.loading,"loading-text":"Loading... Please wait"},scopedSlots:t._u([{key:"item.minion_id",fn:function(e){var s=e.item;return[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/minions/"+s.minion_id}},[t._v(t._s(s.minion_id))])]}},{key:"item.conformity",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(s.conformity),dark:""}},[t._v(t._s(null==s.conformity?"unknown":s.conformity)+"\n        ")])]}},{key:"item.last_job",fn:function(e){var a=e.item;return[t._v("\n        "+t._s(null===a.last_job?"":new Date(a.last_job).toLocaleString("en-GB"))+"\n      ")]}},{key:"item.last_highstate",fn:function(e){var a=e.item;return[t._v("\n        "+t._s(null===a.last_highstate?"":new Date(a.last_highstate).toLocaleString("en-GB"))+"\n      ")]}},{key:"item.action",fn:function(e){var s=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue",tile:"",dark:""},on:{click:function(e){return t.refreshMinion(s.minion_id)}}},[t._v("\n            refresh\n          ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue-grey",tile:"",dark:"",to:"/run?target="+s.minion_id}},[t._v("\n            run job\n          ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"red",tile:"",dark:""},on:{click:function(e){return e.stopPropagation(),t.showDialog(s.minion_id)}}},[t._v("\n            delete\n          ")])],1)]}}])})],1),a("div",{staticClass:"text-center"},[a("v-dialog",{attrs:{width:"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline red",attrs:{"primary-title":""}},[t._v("\n          Delete "+t._s(t.target)+" ?\n        ")]),a("v-card-text",[a("br"),t._v("\n          If you delete "+t._s(t.target)+" from the database, you will need to refresh all minions.\n        ")]),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialog=!1}}},[t._v("\n            close\n          ")]),a("v-btn",{attrs:{color:"red",text:""},on:{click:function(e){return t.deleteMinion(t.target)}}},[t._v("\n            delete\n          ")])],1)],1)],1)],1)],1)},Fe=[],Pe={name:"MinionsTable",data(){return{search:"",dialog:!1,headers:[{text:"Minion Id",value:"minion_id"},{text:"Highstate Conformity",value:"conformity"},{text:"F.Q.D.N",value:"fqdn"},{text:"O.S",value:"os"},{text:"O.S Version",value:"oscodename"},{text:"Kernel",value:"kernelrelease"},{text:"Last Job",value:"last_job"},{text:"Last Highstate",value:"last_highstate"},{text:"Actions",value:"action",sortable:!1}],minions:[],target:null,loading:!0}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/minions/").then(t=>{function e(t){return t.forEach(t=>{let e=JSON.parse(t.grain);for(let a in e)t[a]=e[a]}),t}this.minions=e(t.data),this.loading=!1})},boolRepr(t){return!0===t?"green":!1===t?"red":"primary"},refreshMinion(t){this.$toast("refreshing "+t);let e=new FormData;e.set("minion_id",t),this.$http.post("/api/minions/refresh_minions/",e).then(t=>{this.$toast(t.data.result)})},deleteMinion(t){this.dialog=!1,this.$http.delete("/api/minions/"+t).then(()=>{this.minions.splice(this.minions.indexOf(t),1),this.$toast(t+" deleted")})},showDialog(t){this.target=t,this.dialog=!0}}},Me=Pe,Le=a("169a"),Ne=Object(u["a"])(Me,Ie,Fe,!1,null,"d7d4fbf2",null),Ue=Ne.exports;m()(Ne,{VBtn:_["a"],VCard:g["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VChip:$t["a"],VContainer:x["a"],VDataTable:Ht["a"],VDialog:Le["a"],VDivider:C["a"],VSpacer:R["a"],VTextField:A["a"]});var ze={name:"Minions",components:{Fab:Te,MinionsTable:Ue},data:()=>({refreshKey:0,fabs:[{color:"pink",action:"refreshMinions",icon:"refresh",tooltip:"Refresh all minions"},{color:"orange",action:"runAll",icon:"playlist_play",tooltip:"Run job on all minions"}]}),methods:{fabAction(t){this[t]()},refreshMinions(){this.$toast("refreshing minions"),this.$http.post("/api/minions/refresh_minions/").then(()=>{this.$toast("minions refreshed")}).then(()=>{this.refreshKey+=1}).catch(function(t){alert(t)})},runAll(){this.$router.push("/run/?target=*")}}},Be=ze,Je=Object(u["a"])(Be,Re,Ae,!1,null,"31331556",null),qe=Je.exports;m()(Je,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var He=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"3"}},[null!==t.minion?a("InfosCard",{attrs:{minion:t.minion}}):t._e(),null!==t.minion?a("NetworkCard",{attrs:{minion:t.minion}}):t._e()],1),a("v-col",{attrs:{sm:"12",lg:"9"}},[null!==t.minion?a("MinionDetailCard",{attrs:{minion:t.minion}}):t._e()],1),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)],1)},Ke=[],Ge=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Infos")]),a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#common"}},[t._v("\n        Common\n      ")]),a("v-tab",{attrs:{href:"#salt"}},[t._v("\n        Salt\n      ")]),a("v-tab",{attrs:{href:"#hardware"}},[t._v("\n        Hardware\n      ")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"common"}},[a("v-simple-table",[a("tbody",t._l(t.common,function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),"last_job"===e.grain||"last_highstate"===e.grain&&null!==t.minion[e.grain]?a("td",{staticClass:"text-right"},[t._v(t._s(new Date(t.minion[e.grain]).toLocaleString("en-GB"))+"\n            ")]):"conformity"===e.grain?a("td",{staticClass:"text-right"},[a("v-chip",{attrs:{color:t.boolRepr(t.minion[e.grain]),dark:""}},[t._v(t._s(null==t.minion[e.grain]?"unknown":t.minion[e.grain]))])],1):a("td",{staticClass:"text-right"},[t._v(t._s(t.minion[e.grain]))])])}),0)])],1),a("v-tab-item",{attrs:{id:"salt"}},[a("v-simple-table",[a("tbody",t._l(t.salt,function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion[e.grain]))])])}),0)])],1),a("v-tab-item",{attrs:{id:"hardware"}},[a("v-simple-table",[a("tbody",t._l(t.hardware,function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion[e.grain]))])])}),0)])],1)],1)],1)],1)},We=[],Ye={name:"InfosCard",data(){return{tab:null,common:[{name:"F.Q.D.N",grain:"fqdn"},{name:"O.S",grain:"os"},{name:"O.S Version",grain:"oscodename"},{name:"Kernel",grain:"kernelrelease"},{name:"Last Job",grain:"last_job"},{name:"Last Highstate",grain:"last_highstate"},{name:"Highstate Conformity",grain:"conformity"}],salt:[{name:"ID",grain:"id"},{name:"Master",grain:"master"},{name:"Salt Version",grain:"saltversion"},{name:"Salt Path",grain:"saltpath"},{name:"Python Version",grain:"pythonversion"}],hardware:[{name:"C.P.U Model",grain:"cpu_model"},{name:"Number of C.P.U",grain:"num_cpus"},{name:"Total Memory",grain:"mem_total"},{name:"Total Swap",grain:"swap_total"},{name:"Virtual",grain:"virtual"}]}},props:["minion"],methods:{boolRepr(t){return!0===t?"green":!1===t?"red":"primary"}}},Qe=Ye,Xe=a("71a3"),Ze=a("c671"),ta=a("fe57"),ea=a("aac8"),aa=a("9a96"),sa=Object(u["a"])(Qe,Ge,We,!1,null,"88be39d6",null),na=sa.exports;m()(sa,{VCard:g["a"],VCardTitle:y["c"],VChip:$t["a"],VContainer:x["a"],VSimpleTable:ut["a"],VTab:Xe["a"],VTabItem:Ze["a"],VTabs:ta["a"],VTabsItems:ea["a"],VTabsSlider:aa["a"]});var ia=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Network")]),a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#interface"}},[t._v("\n        Interfaces\n      ")]),a("v-tab",{attrs:{href:"#mac"}},[t._v("\n        Mac\n      ")]),a("v-tab",{attrs:{href:"#dns"}},[t._v("\n        Dns\n      ")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"interface"}},[a("v-simple-table",[a("tbody",[t._l(t.minion.ip_interfaces,function(e,s){return a("tr",{key:s},[a("td",[t._v(t._s(s))]),t._l(e,function(e){return a("td",{staticClass:"text-right"},[t._v(t._s(e))])})],2)}),a("tr",[a("td",[t._v("IPv4 GATEWAY")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion.ip4_gw))])]),a("tr",[a("td",[t._v("IPv6 GATEWAY")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion.ip6_gw))])])],2)])],1),a("v-tab-item",{attrs:{id:"mac"}},[a("v-simple-table",[a("tbody",t._l(t.minion.hwaddr_interfaces,function(e,s){return a("tr",{key:s},[a("td",[t._v(t._s(s))]),a("td",{staticClass:"text-right"},[t._v(t._s(e))])])}),0)])],1),a("v-tab-item",{attrs:{id:"dns"}},[a("v-simple-table",[a("tbody",t._l(t.minion.dns,function(e,s){return a("tr",{key:s},[a("td",[t._v(t._s(s))]),a("td",{staticClass:"text-right"},[t._v(t._s(e.length>=1?e:""))])])}),0)])],1)],1)],1)],1)},ra=[],oa={name:"NetworkCard",data(){return{tab:null,tabs:3}},props:["minion"]},la=oa,ca=Object(u["a"])(la,ia,ra,!1,null,"4e9c41e8",null),da=ca.exports;m()(ca,{VCard:g["a"],VCardTitle:y["c"],VContainer:x["a"],VSimpleTable:ut["a"],VTab:Xe["a"],VTabItem:Ze["a"],VTabs:ta["a"],VTabsItems:ea["a"],VTabsSlider:aa["a"]});var ua=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#grain"}},[t._v("\n        Grains\n      ")]),a("v-tab",{attrs:{href:"#pillar"}},[t._v("\n        Pillar\n      ")]),a("v-tab",{attrs:{href:"#history"}},[t._v("\n        History\n      ")]),a("v-tab",{attrs:{href:"#graph"}},[t._v("\n        Graph\n      ")]),t._l(t.minion.custom_fields,function(e){return a("v-tab",{key:e.name},[t._v("\n        "+t._s(e.name)+"\n      ")])})],2),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"grain"}},[a("div",{staticClass:"text-right"},[a("v-btn",{staticClass:"overlayedBtn",on:{click:function(e){return t.fold("grainCm")}}},[t._v(t._s(t.grainCmFolded?"unfold":"fold"))])],1),a("codemirror",{ref:"grainCm",attrs:{options:t.cmOptions},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),a("v-tab-item",{attrs:{id:"pillar"}},[a("div",{staticClass:"text-right"},[a("v-btn",{staticClass:"overlayedBtn",on:{click:function(e){return t.fold("pillarCm")}}},[t._v(t._s(t.pillarCmFolded?"unfold":"fold"))])],1),a("codemirror",{ref:"pillarCm",attrs:{options:t.cmOptions},model:{value:t.codepillar,callback:function(e){t.codepillar=e},expression:"codepillar"}})],1),a("v-tab-item",{attrs:{id:"history"}},[a("JobsTable",{attrs:{filter:{"target[]":t.minion.minion_id}}})],1),a("v-tab-item",{attrs:{id:"graph",eager:""}},[t.minion?a("JobsChartCard",{attrs:{minion:t.minion.minion_id}}):t._e()],1),t._l(t.minion.custom_fields,function(e){return a("v-tab-item",{key:e.name},[a("codemirror",{attrs:{options:t.cmOptions,value:t.yamlRepr(e.value)}})],1)})],2)],1)],1)},ha=[],ma=a("56b3"),va=a.n(ma),pa=a("8f94"),fa=(a("f4ba"),a("4895"),a("aedd"),a("cbc8"),a("8d70"),a("f9d4"),a("a7be"),a("ced0"),a("efe9"),a("651e")),ba=a.n(fa),_a={name:"MinionDetailCard",components:{JobsTable:Wt,JobsChartCard:wt,codemirror:pa["codemirror"]},data(){return{tab:null,code:ba.a.safeDump(JSON.parse(this.minion.grain)),codepillar:ba.a.safeDump(JSON.parse(this.minion.pillar)),grainCmFolded:!1,pillarCmFolded:!1,cmOptions:{tabSize:4,mode:"yaml",theme:"made-of-code",line:!0,autoRefresh:!0,lineNumbers:!1,readOnly:!0,cursorBlinkRate:0,foldGutter:!0,gutters:["CodeMirror-foldgutter"]}}},methods:{yamlRepr(t){return ba.a.safeDump(JSON.parse(t))},fold(t){!0===this[t+"Folded"]?(va.a.commands.unfoldAll(this.$refs[t].codemirror),this[t+"Folded"]=!1):(va.a.commands.foldAll(this.$refs[t].codemirror),this[t+"Folded"]=!0)}},props:["minion"]},ga=_a,ya=(a("15fa"),Object(u["a"])(ga,ua,ha,!1,null,"107b300f",null)),xa=ya.exports;function ka(t){let e=JSON.parse(t.grain);for(let a in e)t[a]=e[a];return t}m()(ya,{VBtn:_["a"],VCard:g["a"],VContainer:x["a"],VTab:Xe["a"],VTabItem:Ze["a"],VTabs:ta["a"],VTabsItems:ea["a"],VTabsSlider:aa["a"]});var Ca={name:"MinionDetail",components:{Fab:Te,MinionDetailCard:xa,InfosCard:na,NetworkCard:da},data(){return{minion:null,fabs:[{color:"blue",action:"refreshMinion",icon:"refresh",tooltip:"Refresh "+this.minion_id},{color:"purple",action:"runMinion",icon:"play_arrow",tooltip:"Run job on "+this.minion_id},{color:"orange",action:"highstateMinion",icon:"all_inclusive",tooltip:"Run highstate on "+this.minion_id}]}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/minions/"+this.minion_id+"/").then(t=>this.minion=ka(t.data))},fabAction(t){this[t]()},refreshMinion(){this.$toast("refreshing "+this.minion_id);let t=new FormData;t.set("minion_id",this.minion_id),this.$http.post("/api/minions/refresh_minions/",t).then(()=>{this.$toast("minion refreshed")}).catch(function(t){alert(t)})},runMinion(){this.$router.push("/run/?target="+this.minion_id)},highstateMinion(){this.$router.push("/run/?target="+this.minion_id+"&function=state.apply")}},props:["minion_id"]},wa=Ca,ja=Object(u["a"])(wa,He,Ke,!1,null,"2b1fbb2b",null),Va=ja.exports;m()(ja,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var Sa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"4"}},[a("v-container",[a("v-card",[a("v-list-item",{attrs:{"two-line":""}},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"headline"},[t._v(t._s(t.job.fun))]),a("v-list-item-subtitle",[t._v("Run "+t._s(t.formatDate(t.job.alter_time)))])],1)],1),a("v-divider"),a("v-simple-table",[a("tbody",[a("tr",[a("td",[t._v("FUNCTION:")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.job.fun))])]),a("tr",[a("td",[t._v("JID:")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.job.jid))])]),t.job.arguments?a("tr",[a("td",[t._v("ARGUMENTS:")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.job.arguments))])]):t._e(),a("tr",[a("td",[t._v("MINION ID:")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.job.id))])]),a("tr",[a("td",[t._v("STATUS:")]),a("td",{staticClass:"text-right"},[a("v-chip",{attrs:{color:t.boolRepr(t.job.success),dark:""}},[t._v(t._s(t.boolText(t.job.success)))])],1)]),a("tr",[a("td",[t._v("START TIME:")]),a("td",{staticClass:"text-right"},[t._v(t._s(new Date(t.job.alter_time).toLocaleString("en-GB")))])])])])],1)],1)],1),a("v-col",{attrs:{sm:"12",lg:"8"}},[a("v-container",[a("v-card",[a("v-card-title",[t._v("Results")]),a("v-divider"),a("div",{staticClass:"ansiStyle",domProps:{innerHTML:t._s(t.ansiResult)}})],1)],1)],1)],1)],1)},Ta=[],$a={name:"JobDetail",props:["jid","minion_id"],data(){return{job:{},ansiResult:null}},mounted(){this.loadData(),this.loadRenderedJob()},methods:{loadData(){this.$http.get(`api/jobs/${this.jid}/${this.minion_id}/`).then(t=>this.job=t.data)},loadRenderedJob(){this.$http.get(`api/jobs/${this.jid}/${this.minion_id}/rendered_state/`).then(t=>this.ansiResult=t.data)},boolRepr(t){return!0===t?"green":"red"},boolText(t){return!0===t?"success":"failed"},formatDate(t){return new Date(t).toLocaleString("en-GB")}}},Da=$a,Oa=(a("ce2f"),Object(u["a"])(Da,Sa,Ta,!1,null,"ebea9e70",null)),Ea=Oa.exports;m()(Oa,{VCard:g["a"],VCardTitle:y["c"],VChip:$t["a"],VCol:Pt["a"],VContainer:x["a"],VDivider:C["a"],VListItem:S["a"],VListItemContent:D["a"],VListItemSubtitle:D["b"],VListItemTitle:D["c"],VRow:Mt["a"],VSimpleTable:ut["a"]});var Ra=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("EventsTable")],1)],1)],1)},Aa=[],Ia=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("\n      Events\n      "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"alter_time","sort-desc":"",headers:t.headers,items:t.events,search:t.search,"show-expand":"",loading:t.loading},scopedSlots:t._u([{key:"item.alter_time",fn:function(e){var a=e.item;return[t._v("\n        "+t._s(new Date(a.alter_time).toLocaleString("en-GB"))+"\n      ")]}},{key:"expanded-item",fn:function(e){var s=e.headers,n=e.item;return[a("td",{attrs:{colspan:s.length}},[a("pre",[t._v(t._s(JSON.stringify(JSON.parse(n.data),null,2)))])])]}}])})],1)],1)},Fa=[];function Pa(t){return t.forEach(t=>{let e=JSON.parse(t.data);for(let a in e)"id"===a?t["minion_id"]=e[a]:t[a]=e[a]}),t}var Ma={name:"EventsTable",data(){return{search:"",headers:[{text:"Tag",value:"tag"},{text:"Jid",value:"jid"},{text:"Target",value:"minion_id"},{text:"Function",value:"fun"},{text:"Arguments",value:"fun_args"},{text:"Date",value:"alter_time"}],events:[],loading:!0}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/events/").then(t=>{this.events=Pa(t.data),this.loading=!1})}}},La=Ma,Na=Object(u["a"])(La,Ia,Fa,!1,null,"e7265fc6",null),Ua=Na.exports;m()(Na,{VCard:g["a"],VCardTitle:y["c"],VContainer:x["a"],VDataTable:Ht["a"],VSpacer:R["a"],VTextField:A["a"]});var za={name:"Events",components:{EventsTable:Ua}},Ba=za,Ja=Object(u["a"])(Ba,Ra,Aa,!1,null,"7408d9dd",null),qa=Ja.exports;m()(Ja,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var Ha=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("RunCard")],1)],1)],1)},Ka=[],Ga=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{sm:"12"}},[a("v-card",{staticClass:"mb-8"},[a("v-card-title",[t._v("Run")]),a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#formatted"}},[t._v("\n            Formatted\n          ")]),a("v-tab",{attrs:{href:"#cli"}},[t._v("\n            Cli\n          ")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"formatted",eager:""}},[a("v-card",[a("v-spacer"),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{staticClass:"text-right",attrs:{sm:"3",lg:"1","align-self":"center"}},[a("span",[t._v("Client Type:")])]),a("v-col",{attrs:{sm:"3",lg:"1"}},[a("v-select",{attrs:{items:t.client},model:{value:t.selected_client,callback:function(e){t.selected_client=e},expression:"selected_client"}})],1),t.client_batch||t.scheduleSwitch?t._e():a("v-col",{attrs:{sm:"3",lg:"1","offset-lg":"1"}},[a("v-checkbox",{attrs:{label:"Async",color:"primary"},model:{value:t.client_async,callback:function(e){t.client_async=e},expression:"client_async"}})],1),"local"!==t.selected_client||t.scheduleSwitch?t._e():a("v-col",{attrs:{sm:"3",lg:"1","offset-lg":t.client_batch?3:1}},[a("v-checkbox",{attrs:{label:"Batch",color:"primary"},model:{value:t.client_batch,callback:function(e){t.client_batch=e},expression:"client_batch"}})],1),"local"===t.selected_client&&t.client_batch&&!t.scheduleSwitch?a("v-col",{attrs:{sm:"3",lg:"1"}},[a("v-text-field",{attrs:{label:"Batch"},model:{value:t.batch,callback:function(e){t.batch=e},expression:"batch"}})],1):t._e(),"local"!==t.selected_client||t.scheduleSwitch?t._e():a("v-col",{attrs:{sm:"3",lg:"1","offset-lg":t.client_batch?0:1}},[a("v-text-field",{attrs:{label:"Timeout",type:"number"},model:{value:t.timeout,callback:function(e){t.timeout=e},expression:"timeout"}})],1)],1),a("v-row",[a("v-col",{attrs:{lg:"1"}},["local"===t.selected_client?a("v-select",{attrs:{items:t.target_type,label:"Target Type"},on:{change:function(e){t.target=null}},model:{value:t.selected_target_type,callback:function(e){t.selected_target_type=e},expression:"selected_target_type"}}):t._e()],1),a("v-col",{attrs:{lg:"2"}},["local"===t.selected_client?a("v-text-field",{attrs:{label:"Target"},model:{value:t.target,callback:function(e){t.target=e},expression:"target"}}):t._e()],1),a("v-col",{attrs:{lg:"2"}},[a("v-combobox",{attrs:{"item-value":"name","item-text":"name",items:t.filteredFunction,label:"Function","return-object":""},scopedSlots:t._u([t.selectedFunction?{key:"append-outer",fn:function(){return[a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-icon",t._g({attrs:{color:"black"}},s),[t._v("info\n                              ")])]}}],null,!1,1349456046)},[a("div",{staticClass:"desc"},[a("pre",[t._v(t._s(t.selectedFunction.description))])])])]},proxy:!0}:null],null,!0),model:{value:t.selectedFunction,callback:function(e){t.selectedFunction=e},expression:"selectedFunction"}})],1),a("v-col",{attrs:{lg:"3"}},[a("v-text-field",{attrs:{label:"Arguments"},model:{value:t.args,callback:function(e){t.args=e},expression:"args"}})],1),a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Keyword Arguments"},model:{value:t.kwargs,callback:function(e){t.kwargs=e},expression:"kwargs"}})],1)],1),a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{sm:"3"}},[a("v-switch",{directives:[{name:"show",rawName:"v-show",value:"local"===t.selected_client,expression:"selected_client === 'local'"}],attrs:{label:"Schedule",color:"primary"},model:{value:t.scheduleSwitch,callback:function(e){t.scheduleSwitch=e},expression:"scheduleSwitch"}})],1),a("v-col",{attrs:{sm:"3"}},[a("v-switch",{directives:[{name:"show",rawName:"v-show",value:"local"===t.selected_client,expression:"selected_client === 'local'"}],attrs:{label:"Pillar",color:"primary"},model:{value:t.pillarSwitch,callback:function(e){t.pillarSwitch=e},expression:"pillarSwitch"}})],1),a("v-col",{directives:[{name:"show",rawName:"v-show",value:t.pillarSwitch,expression:"pillarSwitch"}],attrs:{sm:"12"}},[a("codemirror",{attrs:{options:t.cmOptions},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),a("v-col",{directives:[{name:"show",rawName:"v-show",value:t.pillarSwitch,expression:"pillarSwitch"}],attrs:{sm:"12"}},[a("span",{domProps:{innerHTML:t._s(t.pillarRendered)}})]),a("v-col",{directives:[{name:"show",rawName:"v-show",value:t.scheduleSwitch,expression:"scheduleSwitch"}],attrs:{sm:"12"}},[a("v-text-field",{staticStyle:{width:"350px"},attrs:{label:"Schedule name"},model:{value:t.scheduleName,callback:function(e){t.scheduleName=e},expression:"scheduleName"}}),a("v-radio-group",{staticClass:"mt-0",model:{value:t.scheduleType,callback:function(e){t.scheduleType=e},expression:"scheduleType"}},[a("v-radio",{attrs:{value:"once",color:"primary"},scopedSlots:t._u([{key:"label",fn:function(){return[a("span",[a("strong",[t._v("Once:  ")])]),a("v-row",[a("v-col",{staticClass:"ml-2",attrs:{sm:"4"}},[a("v-menu",{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-text-field",t._g({attrs:{readonly:""},model:{value:t.scheduleDate,callback:function(e){t.scheduleDate=e},expression:"scheduleDate"}},s))]}}]),model:{value:t.dateMenu,callback:function(e){t.dateMenu=e},expression:"dateMenu"}},[a("v-date-picker",{attrs:{min:t.scheduleDate},on:{input:function(e){t.dateMenu=!1}},model:{value:t.scheduleDate,callback:function(e){t.scheduleDate=e},expression:"scheduleDate"}})],1)],1),a("v-col",{attrs:{sm:"4"}},[a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-text-field",t._g({attrs:{readonly:""},model:{value:t.scheduleTime,callback:function(e){t.scheduleTime=e},expression:"scheduleTime"}},s))]}}]),model:{value:t.timeMenu,callback:function(e){t.timeMenu=e},expression:"timeMenu"}},[t.timeMenu?a("v-time-picker",{attrs:{"full-width":""},model:{value:t.scheduleTime,callback:function(e){t.scheduleTime=e},expression:"scheduleTime"}}):t._e()],1)],1)],1)]},proxy:!0}])}),a("v-radio",{attrs:{value:"recurring",color:"primary"},scopedSlots:t._u([{key:"label",fn:function(){return[a("div",[a("strong",[t._v("Recurring: ")]),t._v(" Every "),a("span",{attrs:{id:"cron"}})])]},proxy:!0}])})],1)],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"orange",large:"",dark:""},on:{click:function(e){return t.runJob(t.test=!0)}}},[t._v("Test")]),a("v-btn",{attrs:{color:"info",large:"",dark:""},on:{click:t.runJob}},[t._v("Run")])],1)],1)],1),a("v-tab-item",{attrs:{id:"cli"}},[null!==t.functions?a("TerminalCard",{attrs:{minions:t.minions,functions:t.functions}}):t._e()],1)],1)],1)],1)],1),a("v-row",[a("v-col",{attrs:{sm:"12"}},[t.results?a("v-card",[a("v-card-title",[t._v("Results")]),a("v-card-text",{staticClass:"ansiStyle",domProps:{innerHTML:t._s(t.results)}})],1):t._e()],1)],1)],1)},Wa=[],Ya=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-row",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}]},[a("v-col",{attrs:{sm:"12"}},[a("div",{staticClass:"console",attrs:{id:"terminal"}})])],1)},Qa=[],Xa=a("fcf3"),Za=a("47d0");a("abb2");class ts{constructor(t){this.size=t,this.entries=[],this.cursor=0}push(t){if(""===t.trim())return;const e=this.entries[this.entries.length-1];t!=e&&(this.entries.push(t),this.entries.length>this.size&&this.entries.pop(0),this.cursor=this.entries.length)}rewind(){this.cursor=this.entries.length}getPrevious(){const t=Math.max(0,this.cursor-1);return this.cursor=t,this.entries[t]}getNext(){const t=Math.min(this.entries.length,this.cursor+1);return this.cursor=t,this.entries[t]}}var es=a("8e33");function as(t,e=!0){let a;const s=[],n=/\w+/g;while(a=n.exec(t))e?s.push(a.index):s.push(a.index+a[0].length);return s}function ss(t,e){const a=as(t,!0).reverse().find(t=>t<e);return null==a?0:a}function ns(t,e){const a=as(t,!1).find(t=>t>e);return null==a?t.length:a}function is(t,e,a){let s=0,n=0;for(let i=0;i<e;++i){const e=t.charAt(i);"\n"==e?(n=0,s+=1):(n+=1,n>a&&(n=0,s+=1))}return{row:s,col:n}}function rs(t,e){return is(t,t.length,e).row+1}function os(t){return""!=t.trim()&&((t.match(/'/g)||[]).length%2!==0||((t.match(/"/g)||[]).length%2!==0||(""==t.split(/(\|\||\||&&)/g).pop().trim()||!(!t.endsWith("\\")||t.endsWith("\\\\")))))}function ls(t){return null!=t.match(/[^\\][ \t]$/m)}function cs(t){if(""===t.trim())return"";if(ls(t))return"";const e=Object(es["parse"])(t);return e.pop()||""}function ds(t,e){const a=Object(es["parse"])(e);let s=a.length-1,n=a[s]||"";""===e.trim()?(s=0,n=""):ls(e)&&(s+=1,n="");const i=t.reduce((t,{fn:e,args:n})=>{try{return t.concat(e(s,a,...n))}catch(i){return console.error("Auto-complete error:",i),t}},[]);return i.filter(t=>t.startsWith(n))}class us{constructor(t,e={}){this.term=t,this._handleTermData=this.handleTermData.bind(this),this._handleTermResize=this.handleTermResize.bind(this),this.history=new ts(e.historySize||100),this.maxAutocompleteEntries=e.maxAutocompleteEntries||100,this._autocompleteHandlers=[],this._active=!1,this._input="",this._cursor=0,this._activePrompt=null,this._activeCharPrompt=null,this._termSize={cols:this.term.cols,rows:this.term.rows},this.attach()}detach(){this.term.off("data",this._handleTermData),this.term.off("resize",this._handleTermResize)}attach(){this.term.onData(this._handleTermData),this.term.onResize(this._handleTermResize)}addAutocompleteHandler(t,...e){this._autocompleteHandlers.push({fn:t,args:e})}removeAutocompleteHandler(t){const e=this._autocompleteHandlers.findIndex(e=>e.fn===t);-1!==e&&this._autocompleteHandlers.splice(e,1)}read(t,e="> "){return new Promise((a,s)=>{this.term.write(t),this._activePrompt={prompt:t,continuationPrompt:e,resolve:a,reject:s},this._input="",this._cursor=0,this._active=!0})}readChar(t){return new Promise((e,a)=>{this.term.write(t),this._activeCharPrompt={prompt:t,resolve:e,reject:a}})}abortRead(t="aborted"){null==this._activePrompt&&null==this._activeCharPrompt||this.term.write("\r\n"),null!=this._activePrompt&&(this._activePrompt.reject(t),this._activePrompt=null),null!=this._activeCharPrompt&&(this._activeCharPrompt.reject(t),this._activeCharPrompt=null),this._active=!1}println(t){this.print(t+"\n")}print(t){const e=t.replace(/[\r\n]+/g,"\n");this.term.write(e.replace(/\n/g,"\r\n"))}printWide(t,e=2){if(0==t.length)return println("");const a=t.reduce((t,e)=>Math.max(t,e.length),0)+e,s=Math.floor(this._termSize.cols/a),n=Math.ceil(t.length/s);let i=0;for(let r=0;r<n;++r){let e="";for(let n=0;n<s;++n)if(i<t.length){let s=t[i++];s+=" ".repeat(a-s.length),e+=s}this.println(e)}}applyPrompts(t){const e=(this._activePrompt||{}).prompt||"",a=(this._activePrompt||{}).continuationPrompt||"";return e+t.replace(/\n/g,"\n"+a)}applyPromptOffset(t,e){const a=this.applyPrompts(t.substr(0,e));return a.length}clearInput(){const t=this.applyPrompts(this._input),e=rs(t,this._termSize.cols),a=this.applyPromptOffset(this._input,this._cursor),{col:s,row:n}=is(t,a,this._termSize.cols),i=e-n-1;for(var r=0;r<i;++r)this.term.write("[E");this.term.write("\r[K");for(r=1;r<e;++r)this.term.write("[F[K")}setInput(t,e=!0){e&&this.clearInput();const a=this.applyPrompts(t);this.print(a),this._cursor>t.length&&(this._cursor=t.length);const s=this.applyPromptOffset(t,this._cursor),n=rs(a,this._termSize.cols),{col:i,row:r}=is(a,s,this._termSize.cols),o=n-r-1;this.term.write("\r");for(var l=0;l<o;++l)this.term.write("[F");for(l=0;l<i;++l)this.term.write("[C");this._input=t}printAndRestartPrompt(t){const e=this._cursor;this.setCursor(this._input.length),this.term.write("\r\n");const a=()=>{this._cursor=e,this.setInput(this._input)},s=t();null==s?a():s.then(a)}setCursor(t){t<0&&(t=0),t>this._input.length&&(t=this._input.length);const e=this.applyPrompts(this._input),a=(rs(e,this._termSize.cols),this.applyPromptOffset(this._input,this._cursor)),{col:s,row:n}=is(e,a,this._termSize.cols),i=this.applyPromptOffset(this._input,t),{col:r,row:o}=is(e,i,this._termSize.cols);if(o>n)for(let l=n;l<o;++l)this.term.write("[B");else for(let l=o;l<n;++l)this.term.write("[A");if(r>s)for(let l=s;l<r;++l)this.term.write("[C");else for(let l=r;l<s;++l)this.term.write("[D");this._cursor=t}handleCursorMove(t){if(t>0){const e=Math.min(t,this._input.length-this._cursor);this.setCursor(this._cursor+e)}else if(t<0){const e=Math.max(t,-this._cursor);this.setCursor(this._cursor+e)}}handleCursorErase(t){const{_cursor:e,_input:a}=this;if(t){if(e<=0)return;const t=a.substr(0,e-1)+a.substr(e);this.clearInput(),this._cursor-=1,this.setInput(t,!1)}else{const t=a.substr(0,e)+a.substr(e+1);this.setInput(t)}}handleCursorInsert(t){const{_cursor:e,_input:a}=this,s=a.substr(0,e)+t+a.substr(e);this._cursor+=t.length,this.setInput(s)}handleReadComplete(){this.history&&this.history.push(this._input),this._activePrompt&&(this._activePrompt.resolve(this._input),this._activePrompt=null),this.term.write("\r\n"),this._active=!1}handleTermResize(t){const{rows:e,cols:a}=t;this.clearInput(),this._termSize={cols:a,rows:e},this.setInput(this._input,!1)}handleTermData(t){if(this._active){if(null!=this._activeCharPrompt)return this._activeCharPrompt.resolve(t),this._activeCharPrompt=null,void this.term.write("\r\n");if(t.length>3&&27!==t.charCodeAt(0)){const e=t.replace(/[\r\n]+/g,"\r");Array.from(e).forEach(t=>this.handleData(t))}else this.handleData(t)}}handleData(t){if(!this._active)return;const e=t.charCodeAt(0);let a;if(27==e)switch(t.substr(1)){case"[A":if(this.history){let t=this.history.getPrevious();t&&(this.setInput(t),this.setCursor(t.length))}break;case"[B":if(this.history){let t=this.history.getNext();t||(t=""),this.setInput(t),this.setCursor(t.length)}break;case"[D":this.handleCursorMove(-1);break;case"[C":this.handleCursorMove(1);break;case"[3~":this.handleCursorErase(!1);break;case"[F":this.setCursor(this._input.length);break;case"[H":this.setCursor(0);break;case"b":a=ss(this._input,this._cursor),null!=a&&this.setCursor(a);break;case"f":a=ns(this._input,this._cursor),null!=a&&this.setCursor(a);break;case"":a=ss(this._input,this._cursor),null!=a&&(this.setInput(this._input.substr(0,a)+this._input.substr(this._cursor)),this.setCursor(a));break}else if(e<32||127===e)switch(t){case"\r":os(this._input)?this.handleCursorInsert("\n"):this.handleReadComplete();break;case"":this.handleCursorErase(!0);break;case"\t":if(this._autocompleteHandlers.length>0){const t=this._input.substr(0,this._cursor),e=ls(t),a=ds(this._autocompleteHandlers,t);if(a.sort(),0===a.length)e||this.handleCursorInsert(" ");else if(1===a.length){const e=cs(t);this.handleCursorInsert(a[0].substr(e.length)+" ")}else a.length<=this.maxAutocompleteEntries?this.printAndRestartPrompt(()=>{this.printWide(a)}):this.printAndRestartPrompt(()=>this.readChar(`Display all ${a.length} possibilities? (y or n)`).then(t=>{"y"!=t&&"Y"!=t||this.printWide(a)}))}else this.handleCursorInsert("    ");break;case"":this.setCursor(this._input.length),this.term.write("^C\r\n"+((this._activePrompt||{}).prompt||"")),this._input="",this._cursor=0,this.history&&this.history.rewind();break}else this.handleCursorInsert(t)}}var hs={name:"TerminalCard",props:["minions","functions"],data(){return{term:null,fitter:null,functions_name:null}},methods:{initTerm(){let t=document.getElementById("terminal");this.term=new Xa["Terminal"]({cursorBlink:!0,fontSize:20,fontFamily:"'Roboto Mono', monospace"});const e=new Za["FitAddon"];this.term.loadAddon(e),this.term.open(t),e.fit(),this.fitter=e;const a=new us(this.term);a.addAutocompleteHandler(t=>{return 0!==t?[]:["salt","clear"]}),a.addAutocompleteHandler(t=>{return 1!==t?[]:this.minions}),a.addAutocompleteHandler(t=>{return 2!==t?[]:this.functions.map(t=>t.name)});const s="Usage: salt [options] '<target>' <function> [arguments]",n=()=>{a.read(" ~$ ").then(t=>{let e=t.split(" ").filter(t=>{return""!==t});if(0===e.length)n();else if(1===e.length&&"clear"===e[0])this.term.clear(),n();else if(e.length<=2)a.println(s),n();else if(t.split(" ").length>=3&&"salt"===e[0]){let e=new FormData;e.set("raw",!0),e.set("cli",!0),e.set("command",t),this.$toast("Running "+t),this.$http.post("api/run/",e).then(t=>{a.println(t.data.results)}).then(()=>n())}else a.println(s),n()})};n()},onResize(){null!==this.term&&this.fitter.fit()}},mounted(){setTimeout(()=>{this.initTerm()},100)},beforeDestroy(){null!==this.term&&this.term.dispose()}},ms=hs,vs=a("269a"),ps=a.n(vs),fs=a("dc22"),bs=Object(u["a"])(ms,Ya,Qa,!1,null,"cc052c0c",null),_s=bs.exports;function gs(t,e){if(t instanceof HTMLElement)this.el=t;else{if("string"!==typeof t)throw"CronUI: container parameter in initialization must be an html element or a string selector.";this.el=document.querySelector(t)}this.options=e||{},this.render(),"string"!==typeof this.options.initial&&(this.options.initial="* * * * *"),this.setCronString(this.options.initial),this.currentValue=this.options.initial}m()(bs,{VCol:Pt["a"],VRow:Mt["a"]}),ps()(bs,{Resize:fs["a"]}),gs.prototype.render=function(){let t,e,a,s=this.el,n="";for(a=0;a<60;a++)e=a<10?"0":"",n+="<option value='"+a+"'>"+e+a+"</option>\n";let i="";for(a=0;a<24;a++)e=a<10?"0":"",i+="<option value='"+a+"'>"+e+a+"</option>\n";let r="";for(a=1;a<32;a++)t=1==a||21==a||31==a?"st":2==a||22==a?"nd":3==a||23==a?"rd":"th",r+="<option value='"+a+"'>"+a+t+"</option>\n";let o="";const l=["January","February","March","April","May","June","July","August","September","October","November","December"];for(a=0;a<l.length;a++)o+="<option value='"+(a+1)+"'>"+l[a]+"</option>\n";let c="";const d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(a=0;a<d.length;a++)c+="<option value='"+a+"'>"+d[a]+"</option>\n";let u="";const h=["minute","hour","day","week","month","year"];for(a=0;a<h.length;a++)u+="<option value='"+h[a]+"'>"+h[a]+"</option>\n";let m={};s.insertAdjacentHTML("beforeend","<span class='cron-period'><select>"+u+"</select></span>");let v=s.querySelector(".cron-period select");v.addEventListener("change",this.periodChanged.bind(this)),v.addEventListener("change",this.changeEvent.bind(this)),s.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-dom'> on the <select name='cron-dom'>"+r+"</select> </span>"),m["dom"]=s.querySelector(".cron-block-dom"),s.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-month'> of <select name='cron-month'>"+o+"</select> </span>"),m["month"]=s.querySelector(".cron-block-month"),s.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-mins'> at <select name='cron-mins'>"+n+"</select> minutes past the hour </span>"),m["mins"]=s.querySelector(".cron-block-mins"),s.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-dow'> on <select name='cron-dow'>"+c+"</select> </span>"),m["dow"]=s.querySelector(".cron-block-dow"),s.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-time'> at <select name='cron-time-hour' class='cron-time-hour'>"+i+"</select>:<select name='cron-time-min' class='cron-time-min'>"+n+" </span>"),m["time"]=s.querySelector(".cron-block-time");for(let p in m)[].forEach.call(m[p].querySelectorAll("select"),function(t){t.addEventListener("change",this.changeEvent.bind(this))}.bind(this));this.blocks=m},gs.prototype.periodChanged=function(){let t=this.blocks,e=this.el.querySelector(".cron-period select"),a=e.options[e.selectedIndex].value;for(let s in t)t[s].style.display="none";if(gs.displayMatrix.hasOwnProperty(a)){let e=gs.displayMatrix[a];for(let a=0;a<e.length;a++)t[e[a]].style.display=""}},gs.prototype.changeEvent=function(){this.currentValue=this.getCronString(),"function"===typeof this.options.changeEvent&&this.options.changeEvent(this.currentValue)},gs.prototype.getCronString=function(){let t,e,a,s,n;t=e=a=s=n="*";let i=this.blocks,r=function(t){return t.options[t.selectedIndex].value},o=r(this.el.querySelector(".cron-period select"));switch(o){case"minute":break;case"hour":t=r(i["mins"].querySelector("select"));break;case"day":t=r(i["time"].querySelector(".cron-time-min")),e=r(i["time"].querySelector(".cron-time-hour"));break;case"week":t=r(i["time"].querySelector(".cron-time-min")),e=r(i["time"].querySelector(".cron-time-hour")),n=r(i["dow"].querySelector("select"));break;case"month":t=r(i["time"].querySelector(".cron-time-min")),e=r(i["time"].querySelector(".cron-time-hour")),a=r(i["dom"].querySelector("select"));break;case"year":t=r(i["time"].querySelector(".cron-time-min")),e=r(i["time"].querySelector(".cron-time-hour")),a=r(i["dom"].querySelector("select")),s=r(i["month"].querySelector("select"));break;default:return o}return[t,e,a,s,n].join(" ")},gs.prototype.setCronString=function(t){let e=this.blocks,a=gs.getCronType(t);if(!a)return!1;let s=t.split(" "),n={mins:s[0],hour:s[1],dom:s[2],month:s[3],dow:s[4]},i=gs.displayMatrix[a];for(let r=0;r<i.length;r++){let t=i[r];"time"==t?(e[t].querySelector(".cron-time-hour").value=n["hour"],e[t].querySelector(".cron-time-min").value=n["mins"]):e[t].querySelector("select").value=n[t]}return this.el.querySelector(".cron-period select").value=a,this.periodChanged(),this},gs.displayMatrix={minute:[],hour:["mins"],day:["time"],week:["dow","time"],month:["dom","time"],year:["dom","month","time"]},gs.cronTypes={minute:/^(\*\s){4}\*$/,hour:/^\d{1,2}\s(\*\s){3}\*$/,day:/^(\d{1,2}\s){2}(\*\s){2}\*$/,week:/^(\d{1,2}\s){2}(\*\s){2}\d{1,2}$/,month:/^(\d{1,2}\s){3}\*\s\*$/,year:/^(\d{1,2}\s){4}\*$/},gs.getCronType=function(t){t=t||this.getCronString();const e=/^((\d{1,2}|\*)\s){4}(\d{1,2}|\*)$/;if("string"!=typeof t||!e.test(t))return;let a=t.split(" "),s=[0,0,1,1,0],n=[59,23,31,12,6];for(var i=0;i<a.length;i++)if("*"!=a[i]){var r=parseInt(a[i]);if(!(r<=n[i]&&r>=s[i]))return}for(let o in gs.cronTypes)if(gs.cronTypes[o].test(t))return o};var ys=gs,xs={name:"RunCard",components:{TerminalCard:_s,codemirror:pa["codemirror"]},data(){return{scheduleSwitch:!1,pillarSwitch:!1,code:"# Type valid yaml to override pillars\n\n\n",cmOptions:{tabSize:4,mode:"yaml",theme:"made-of-code",line:!0,autoRefresh:!0,lineNumbers:!1,foldGutter:!0,gutters:["CodeMirror-foldgutter"]},tab:null,client:[{text:"Local",value:"local"},{text:"Runner",value:"runner"},{text:"Wheel",value:"wheel"}],selected_client:"local",client_async:!1,client_batch:!1,minions:[],functions:null,selectedFunction:null,description:null,batch:null,timeout:null,target_type:[{text:"glob",value:"glob"},{text:"pcre",value:"--pcre"},{text:"list",value:"--list"},{text:"grain",value:"--grain"},{text:"grain_pcre",value:"--grain-pcre"},{text:"pillar",value:"--pillar"},{text:"pillar_pcre",value:"--pillar-pcre"},{text:"range",value:"--range"},{text:"compound",value:"--compound"},{text:"nodegroup",value:"--nodegroup"}],selected_target_type:"glob",target:"",args:"",kwargs:"",results:"",termKey:0,cron:null,dateMenu:!1,timeMenu:!1,scheduleType:null,scheduleDate:(new Date).toISOString().substr(0,10),scheduleTime:(new Date).toISOString().substr(11,11).split(":").slice(0,-1).join(":"),scheduleName:null}},methods:{loadData(){this.$http.get("api/functions/").then(t=>{this.functions=t.data}),this.$http.get("api/minions/").then(t=>{t.data.forEach(t=>this.minions.push(t.minion_id))})},runJob(t=!1){let e="Running",a=`salt --client=${this.client_batch?"local_batch":this.selected_client}${this.client_async&&!this.client_batch?"_async":""}`;"local"===this.selected_client&&("glob"!==this.selected_target_type?a+=" "+this.selected_target_type+" "+this.target:a+=" "+this.target),a+=` ${this.selectedFunction.hasOwnProperty("name")?this.selectedFunction.name:this.selectedFunction}`,a+=`${this.args?` ${this.args}`:""}${!0===t?" test=True":""}${this.kwargs?` ${this.kwargs}`:""}`,a+=`${this.pillarSwitch?` pillar='${this.pillarRendered}'`:""}`,a+=`${this.client_batch&&this.batch?` -b ${this.batch}`:""}${this.timeout?` -t ${this.timeout}`:""}`;let s=new FormData;s.set("raw",!0),s.set("command",a),this.scheduleSwitch&&this.scheduleType&&(e="Scheduling",s.set("schedule_type",this.scheduleType),this.scheduleName&&s.set("schedule_name",this.scheduleName),"once"===this.scheduleType?s.set("schedule",this.scheduleDate+" "+this.scheduleTime+":00"):s.set("cron",this.cron.currentValue)),this.$toast(e+" "+a),this.$http.post("api/run/",s).then(t=>{let e=t.data;if(this.client_async){let t=new DOMParser,a=t.parseFromString(e,"text/html"),s=a.getElementsByClassName("ansi2html-content")[0].children,n=s[s.length-1].innerText;for(let e=1;e<s.length-2;e++){let t=document.createElement("a"),a=document.createTextNode(s[e].innerText);t.appendChild(a),t.title=`Async result to job for ${s[e].innerText.replace("- ","")}`,t.href=`/#/jobs/${n}/${s[e].innerText.replace("- ","")}`,s[e].innerHTML="",s[e].appendChild(t)}e=(new XMLSerializer).serializeToString(a)}this.results=e+this.results})}},computed:{filteredFunction:function(){if(null!==this.functions)return this.functions.filter(t=>{return t.type===this.selected_client})},pillarRendered:function(){return`${JSON.stringify(null===ba.a.safeLoad(this.code)?{}:ba.a.safeLoad(this.code))}`}},mounted(){this.cron=new ys("#cron",{initial:"* * * * *"}),this.loadData(),this.target=this.$route.query.target,this.selectedFunction=!0===this.$route.query.hasOwnProperty("function")?{name:this.$route.query.function}:this.selectedFunction,this.args=this.$route.query.args}},ks=xs,Cs=(a("32e7"),a("ac7c")),ws=a("2b5d"),js=a("67b6"),Vs=a("43a6"),Ss=a("b73d"),Ts=a("c964"),$s=Object(u["a"])(ks,Ga,Wa,!1,null,"455cd3a4",null),Ds=$s.exports;m()($s,{VBtn:_["a"],VCard:g["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VCheckbox:Cs["a"],VCol:Pt["a"],VCombobox:ws["a"],VContainer:x["a"],VDatePicker:Kt["a"],VIcon:j["a"],VMenu:O["a"],VRadio:js["a"],VRadioGroup:Vs["a"],VRow:Mt["a"],VSelect:kt["a"],VSpacer:R["a"],VSwitch:Ss["a"],VTab:Xe["a"],VTabItem:Ze["a"],VTabs:ta["a"],VTabsItems:ea["a"],VTabsSlider:aa["a"],VTextField:A["a"],VTimePicker:Ts["b"]});var Os={name:"Run",components:{RunCard:Ds}},Es=Os,Rs=Object(u["a"])(Es,Ha,Ka,!1,null,"74868f95",null),As=Rs.exports;m()(Rs,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var Is=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("CommonSettings")],1)],1),a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("UserSettings")],1)],1)],1)},Fs=[],Ps=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Common Settings")]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"4",lg:"2","align-self":"center"}},[t._v("\n            Parse modules from:\n          ")]),a("v-col",{attrs:{sm:"4",lg:"2"}},[a("v-select",{attrs:{items:t.minions,"item-text":"minion_id","item-value":"minion_id",label:"Target"},model:{value:t.target,callback:function(e){t.target=e},expression:"target"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:null==t.target,color:"primary"},on:{click:t.parseModules}},[t._v("Submit")])],1),a("v-col",{attrs:{sm:"4",lg:"1","align-self":"center"}},[t._v("\n            Alcali Version:\n          ")]),a("v-col",{attrs:{sm:"4",lg:"2","align-self":"center"}},[a("span",[t._v(t._s(t.version))])])],1),a("v-row",[a("v-col",{attrs:{sm:"12",lg:"6"}},[a("v-row",[t._v("Minions Fields")]),t._l(t.uniqueMinionField,function(e){return a("v-row",{key:e.name},[a("v-col",{attrs:{lg:"4"}},[a("b",[t._v(t._s(e.name))])]),a("v-col",{attrs:{lg:"4"}},[t._v(t._s(e["function"]))]),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{color:"red",dark:""},on:{click:function(a){return t.deleteMinionsFields(e.name)}}},[t._v("Delete")])],1)],1)}),a("v-row",[a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Name","single-line":""},model:{value:t.minionsfields_name,callback:function(e){t.minionsfields_name=e},expression:"minionsfields_name"}})],1),a("v-col",{attrs:{lg:"4"}},[a("v-combobox",{attrs:{items:t.functions,"item-value":"name","item-text":"name",label:"Functions"},model:{value:t.minionsfields_value,callback:function(e){t.minionsfields_value=e},expression:"minionsfields_value"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:null==t.minionsfields_name||null==t.minionsfields_value,color:"primary"},on:{click:t.createMinionsFields}},[t._v("Create\n                ")])],1)],1)],2),a("v-col",{attrs:{sm:"12",lg:"6"}},[a("v-row",[t._v("Custom Conformity")]),t._l(t.conformity,function(e){return a("v-row",{key:e.id},[a("v-col",{attrs:{lg:"4"}},[a("b",[t._v(t._s(e.name))])]),a("v-col",{attrs:{lg:"4"}},[t._v(t._s(e.function))]),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{color:"red",dark:""},on:{click:function(a){return t.deleteConformity(e.id)}}},[t._v("Delete")])],1)],1)}),a("v-row",[a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Name","single-line":""},model:{value:t.conformity_name,callback:function(e){t.conformity_name=e},expression:"conformity_name"}})],1),a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Function","single-line":""},model:{value:t.conformity_value,callback:function(e){t.conformity_value=e},expression:"conformity_value"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:null==t.conformity_name||null===t.conformity_value,color:"primary"},on:{click:t.createConformity}},[t._v("Create\n                ")])],1)],1)],2)],1)],1)],1)],1)],1)},Ms=[],Ls={name:"CommonSettings",data(){return{version:"unknown",minions:[],target:null,functions:null,minionsfields:[],minionsfields_name:null,minionsfields_value:null,conformity:null,conformity_name:null,conformity_value:null}},mounted(){this.loadData()},computed:{uniqueMinionField(){if(null!==this.minionsfields)return this.minionsfields.filter((t,e,a)=>e===a.findIndex(e=>e["function"]===t["function"]&&e.name===t.name))}},methods:{loadData(){this.$http.get("api/keys/").then(t=>{this.minions=t.data.filter(t=>"accepted"===t.status)}),this.$http.get("api/functions/").then(t=>{this.functions=t.data.filter(t=>"local"===t.type)}),this.$http.get("api/conformity/").then(t=>{this.conformity=t.data}),this.$http.get("api/minionsfields/").then(t=>{this.minionsfields=t.data}),this.$http.get("api/version/").then(t=>{this.version=t.data.version})},parseModules(){this.$toast("Parse module started");let t=new FormData;t.set("target",this.target),this.$http.post("api/settings/initdb",t).then(t=>{this.$toast(t.data.result)}).then(()=>{this.loadData()})},deleteConformity(t){let e=new FormData;e.set("id",t),this.$http.delete("/api/conformity/"+t).then(()=>{this.$toast("conformity deleted"),this.conformity.splice(this.conformity.indexOf(t),1)})},createConformity(){let t=new FormData;t.set("name",this.conformity_name),t.set("function",this.conformity_value),this.$http.post("/api/conformity/",t).then(()=>{this.conformity.push({name:this.conformity_name,function:this.conformity_value,id:this.conformity.length+2}),this.$toast("conformity created"),this.conformity_name=null,this.conformity_value=null})},createMinionsFields(){let t=new FormData;t.set("name",this.minionsfields_name),t.set("function",this.minionsfields_value.name),t.set("value","{}"),this.$http.post("/api/minionsfields/",t).then(()=>{this.minionsfields.push({name:this.minionsfields_name,function:this.minionsfields_value.name}),this.$toast("minions fields created"),this.minionsfields_name=null,this.minionsfields_value=null})},deleteMinionsFields(t){let e=new FormData;e.set("name",t),this.$http.post("/api/minionsfields/delete_field/",e).then(e=>{this.$toast(e.data.result),this.minionsfields=this.minionsfields.filter(e=>e.name!==t)})}}},Ns=Ls,Us=Object(u["a"])(Ns,Ps,Ms,!1,null,"ba67d60c",null),zs=Us.exports;m()(Us,{VBtn:_["a"],VCard:g["a"],VCardText:y["b"],VCardTitle:y["c"],VCol:Pt["a"],VCombobox:ws["a"],VContainer:x["a"],VRow:Mt["a"],VSelect:kt["a"],VTextField:A["a"]});var Bs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("User Settings")]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{lg:"2"}},[a("span",[t._v("Jobs Notifications")]),t._l(t.notifs,function(e,s){return a("div",{key:s},[a("v-switch",{attrs:{label:s,color:"primary","hide-details":""},model:{value:t.notifs[s],callback:function(e){t.$set(t.notifs,s,e)},expression:"notifs[name]"}})],1)})],2),a("v-col",{attrs:{lg:"2"}},[a("span",[t._v("Max Notifications")]),a("v-text-field",{attrs:{type:"number"},model:{value:t.max_notifs,callback:function(e){t.max_notifs=e},expression:"max_notifs"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:t.updateUserSettings}},[t._v("Submit")])],1)],1)],1)},Js=[],qs={name:"UserSettings",data(){return{switch1:!0,switch2:!1,notifs:{created:!1,published:!0,returned:!1,event:!1},settings:null,max_notifs:null}},methods:{loadData(){this.$http.get("api/userssettings/"+this.$store.getters.user_id+"/").then(t=>{this.settings=t.data,this.max_notifs=t.data.max_notifs,Object.keys(this.notifs).forEach(t=>{this.notifs[t]=this.settings["notifs_"+t]})})},updateUserSettings(){let t={max_notifs:this.max_notifs};Object.keys(this.notifs).forEach(e=>{t["notifs_"+e]=this.notifs[e]}),this.$http.patch("api/userssettings/"+this.$store.getters.user_id+"/",t).then(t=>{this.$toast("user settings updated")})}},mounted(){this.loadData()}},Hs=qs,Ks=Object(u["a"])(Hs,Bs,Js,!1,null,"50109ca2",null),Gs=Ks.exports;m()(Ks,{VBtn:_["a"],VCard:g["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"],VSpacer:R["a"],VSwitch:Ss["a"],VTextField:A["a"]});var Ws={name:"Settings",components:{UserSettings:Gs,CommonSettings:zs}},Ys=Ws,Qs=Object(u["a"])(Ys,Is,Fs,!1,null,"ef54e078",null),Xs=Qs.exports;m()(Qs,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var Zs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("ConformityTable")],1)],1)],1)},tn=[],en=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("\n      Conformity\n      "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion_id","item-key":"minion_id",headers:t.headers,items:t.conformity,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.minion_id",fn:function(e){var s=e.item;return[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/conformity/"+s.minion_id}},[t._v(t._s(s.minion_id))])]}},{key:"item.last_highstate",fn:function(e){var a=e.item;return[t._v("\n        "+t._s(null===a.last_highstate?"":new Date(a.last_highstate).toLocaleString("en-GB"))+"\n      ")]}},{key:"item.conformity",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(s.conformity),dark:""}},[t._v(t._s(null==s.conformity?"unknown":s.conformity)+"\n        ")])]}},{key:"item.succeeded",fn:function(e){var s=e.item;return[null!=s.succeeded?a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",color:"green","text-color":"base"}},[t._v("\n          "+t._s(s.succeeded)+"\n        ")]):t._e()]}},{key:"item.unchanged",fn:function(e){var s=e.item;return[null!=s.unchanged?a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",color:"orange","text-color":"base"}},[t._v("\n          "+t._s(s.unchanged)+"\n        ")]):t._e()]}},{key:"item.failed",fn:function(e){var s=e.item;return[null!=s.failed?a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",color:"red","text-color":"base"}},[t._v("\n          "+t._s(s.failed)+"\n        ")]):t._e()]}},{key:"item.action",fn:function(e){var s=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue",tile:"",dark:"",to:"/conformity/"+s.minion_id}},[t._v("\n            detail\n          ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"orange",tile:"",dark:"",to:"/run/?target="+s.minion_id+"&function=state.apply"}},[t._v("\n            highstate\n          ")])],1)]}}])})],1)],1)},an=[],sn={name:"ConformityTable",data(){return{search:"",headers:[],conformity:[],loading:!0}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/conformity/render/").then(t=>{this.headers=t.data.name,this.headers.push({text:"Actions",value:"action",sortable:!1}),this.conformity=t.data.data,this.loading=!1})},boolRepr(t){return!0===t?"green":!1===t?"red":"primary"}}},nn=sn,rn=Object(u["a"])(nn,en,an,!1,null,"7f0da613",null),on=rn.exports;m()(rn,{VBtn:_["a"],VCard:g["a"],VCardTitle:y["c"],VChip:$t["a"],VContainer:x["a"],VDataTable:Ht["a"],VSpacer:R["a"],VTextField:A["a"]});var ln={name:"Conformity",components:{ConformityTable:on}},cn=ln,dn=Object(u["a"])(cn,Zs,tn,!1,null,"090bf60e",null),un=dn.exports;m()(dn,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var hn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"4"}},[a("ConformityCard",{attrs:{minion_id:t.minion_id,conformity:t.conformity,custom_conformity:t.custom_conformity}})],1),a("v-col",{attrs:{sm:"12",lg:"8"}},[a("ConformityDetailCard",{attrs:{succeeded:t.succeeded,unchanged:t.unchanged,failed:t.failed}})],1)],1)],1)},mn=[],vn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("\n      Highstate Conformity\n      "),a("v-spacer"),a("v-checkbox",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.succeeded).length>0,expression:"Object.keys(succeeded).length>0"}],staticClass:"mb-0 mt-0",attrs:{color:"green",label:"Succeeded: "+Object.keys(t.succeeded).length},model:{value:t.succeeded_checkbox,callback:function(e){t.succeeded_checkbox=e},expression:"succeeded_checkbox"}}),a("v-checkbox",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.unchanged).length>0,expression:"Object.keys(unchanged).length>0"}],staticClass:"ml-3 mb-0 mt-0",attrs:{color:"orange",label:"Unchanged: "+Object.keys(t.unchanged).length},model:{value:t.unchanged_checkbox,callback:function(e){t.unchanged_checkbox=e},expression:"unchanged_checkbox"}}),a("v-checkbox",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.failed).length>0,expression:"Object.keys(failed).length>0"}],staticClass:"ml-3 mb-0 mt-0",attrs:{color:"red",label:"Failed: "+Object.keys(t.failed).length},model:{value:t.failed_checkbox,callback:function(e){t.failed_checkbox=e},expression:"failed_checkbox"}})],1),a("v-expansion-panels",t._l(t.succeeded,function(e,s){return t.succeeded_checkbox?a("v-expansion-panel",{key:s,attrs:{dark:""}},[a("v-expansion-panel-header",{scopedSlots:t._u([{key:"actions",fn:function(){return[a("v-icon",{attrs:{color:"green"}},[t._v("$vuetify.icons.expand")])]},proxy:!0}],null,!0)},[t._v(t._s(s)+"\n          ")]),a("v-expansion-panel-content",{domProps:{innerHTML:t._s(e)}})],1):t._e()}),1),a("v-expansion-panels",t._l(t.unchanged,function(e,s){return t.unchanged_checkbox?a("v-expansion-panel",{key:s},[a("v-expansion-panel-header",{scopedSlots:t._u([{key:"actions",fn:function(){return[a("v-icon",{attrs:{color:"orange"}},[t._v("$vuetify.icons.expand")])]},proxy:!0}],null,!0)},[t._v(t._s(s)+"\n          ")]),a("v-expansion-panel-content",{domProps:{innerHTML:t._s(e)}})],1):t._e()}),1),a("v-expansion-panels",t._l(t.failed,function(e,s){return t.failed_checkbox?a("v-expansion-panel",{key:s},[a("v-expansion-panel-header",{scopedSlots:t._u([{key:"actions",fn:function(){return[a("v-icon",{attrs:{color:"red"}},[t._v("$vuetify.icons.expand")])]},proxy:!0}],null,!0)},[t._v(t._s(s)+"\n          ")]),a("v-expansion-panel-content",{domProps:{innerHTML:t._s(e)}})],1):t._e()}),1)],1)],1)},pn=[],fn={name:"ConformityDetailCard",props:["succeeded","unchanged","failed"],data(){return{expand_search:!1,succeeded_checkbox:!0,unchanged_checkbox:!0,failed_checkbox:!0}}},bn=fn,_n=(a("cced"),a("cd55")),gn=a("49e2"),yn=a("c865"),xn=a("0393"),kn=Object(u["a"])(bn,vn,pn,!1,null,"69fc5fbb",null),Cn=kn.exports;m()(kn,{VCard:g["a"],VCardTitle:y["c"],VCheckbox:Cs["a"],VContainer:x["a"],VExpansionPanel:_n["a"],VExpansionPanelContent:gn["a"],VExpansionPanelHeader:yn["a"],VExpansionPanels:xn["a"],VIcon:j["a"],VSpacer:R["a"]});var wn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v(t._s(t.minion_id))]),a("v-simple-table",[a("tbody",[a("tr",[a("td",[t._v("Highstate")]),a("td",{staticClass:"text-right"},[a("v-chip",{attrs:{color:t.boolRepr(t.conformity),dark:""}},[t._v(t._s(t.valRepr(t.conformity)))])],1)])]),t._l(t.custom_conformity,function(e){return a("tbody",{key:e.key},t._l(e,function(e,s){return a("tr",{key:s},[a("td",[t._v(t._s(s))]),a("td",{staticClass:"text-right"},[t.isBool(e)?a("v-chip",{attrs:{color:t.boolRepr(t.conformity),dark:""}},[t._v(t._s(t.valRepr(t.conformity)))]):a("span",[t._v(t._s(t.valRepr(e)))])],1)])}),0)})],2)],1)],1)},jn=[],Vn={name:"ConformityCard",props:["minion_id","conformity","custom_conformity"],data(){return{}},methods:{boolRepr(t){return!0===t?"green":!1===t?"red":"primary"},isBool(t){return"boolean"===typeof t},valRepr(t){return null===t?"unknown":t}}},Sn=Vn,Tn=Object(u["a"])(Sn,wn,jn,!1,null,"71cc8090",null),$n=Tn.exports;m()(Tn,{VCard:g["a"],VCardTitle:y["c"],VChip:$t["a"],VContainer:x["a"],VSimpleTable:ut["a"]});var Dn={name:"ConformityDetail",props:["minion_id"],components:{ConformityCard:$n,ConformityDetailCard:Cn},data(){return{conformity:"",succeeded:{},unchanged:{},failed:{},custom_conformity:[]}},mounted(){this.loadConformity()},methods:{loadConformity(){this.$http.get("api/minions/"+this.minion_id+"/conformity_detail/").then(t=>{this.conformity=t.data.conformity,this.custom_conformity=t.data.custom_conformity,this.succeeded=t.data.succeeded,this.unchanged=t.data.unchanged,this.failed=t.data.failed})}}},On=Dn,En=Object(u["a"])(On,hn,mn,!1,null,"bc290f46",null),Rn=En.exports;m()(En,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var An=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("UserCard")],1)},In=[],Fn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("v-card",[a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"username",headers:t.headers,items:t.users},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",{staticClass:"headline"},[t._v("Users")]),a("div",{staticClass:"flex-grow-1"}),a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-btn",t._g({staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:function(e){t.user={}}}},s),[t._v("Create")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",[t._v(t._s(!0===t.editing?"Update User":"Create User"))]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"Username",rules:t.userRules,required:""},model:{value:t.user.username,callback:function(e){t.$set(t.user,"username",e)},expression:"user.username"}})],1),a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"Email",rules:t.emailRules,required:""},model:{value:t.user.email,callback:function(e){t.$set(t.user,"email",e)},expression:"user.email"}})],1)],1),a("v-row",[a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"First Name"},model:{value:t.user.first_name,callback:function(e){t.$set(t.user,"first_name",e)},expression:"user.first_name"}})],1),a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"Last Name"},model:{value:t.user.last_name,callback:function(e){t.$set(t.user,"last_name",e)},expression:"user.last_name"}})],1)],1),a("v-row",[a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{"append-icon":t.show?"visibility":"visibility_off",type:t.show?"text":"password",name:"input-10-1",label:"Password",counter:""},on:{"click:append":function(e){t.show=!t.show}},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}})],1),a("v-col",{attrs:{lg:"6"}},[a("v-checkbox",{attrs:{label:"Staff User"},model:{value:t.user.is_staff,callback:function(e){t.$set(t.user,"is_staff",e)},expression:"user.is_staff"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),t.editing?a("v-btn",{attrs:{color:"primary"},on:{click:t.resetUser}},[t._v("Discard")]):t._e(),t.editing?a("v-btn",{attrs:{color:"warning"},on:{click:t.updateUser}},[t._v("Update")]):t._e(),t.editing?t._e():a("v-btn",{attrs:{color:"warning",disabled:null==t.user.username||""==t.user.email},on:{click:t.createUser}},[t._v("Create\n                    ")])],1)],1)],1)],1)]},proxy:!0},{key:"item.is_staff",fn:function(e){var s=e.item;return[s.is_staff?a("v-chip",{attrs:{color:"primary",dark:""}},[t._v(t._s(s.is_staff))]):t._e()]}},{key:"item.token",fn:function(e){var s=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"primary",tile:"",dark:""},on:{click:function(e){return t.showToken(s)}}},[t._v("\n                view\n              ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"orange",tile:"",dark:""},on:{click:function(e){return t.manageToken("renew",s)}}},[t._v("\n                renew\n              ")]),a("v-btn",{attrs:{small:"",color:"red",tile:"",dark:"",disabled:String(s.id)===t.currentUserId},on:{click:function(e){return t.manageToken("revoke",s)}}},[t._v("\n                revoke\n              ")])],1)]}},{key:"item.date_joined",fn:function(e){var a=e.item;return[t._v("\n            "+t._s(new Date(a.date_joined).toLocaleString("en-GB"))+"\n          ")]}},{key:"item.action",fn:function(e){var s=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"orange",tile:"",dark:""},on:{click:function(e){return t.editUser(s)}}},[t._v("\n                update\n              ")]),a("v-btn",{attrs:{small:"",color:"red",tile:"",dark:"",disabled:String(s.id)===t.currentUserId},on:{click:function(e){return t.confirmDelete(s)}}},[t._v("\n                delete\n              ")])],1)]}}])})],1)],1)],1),a("div",{staticClass:"text-center"},[a("v-dialog",{attrs:{width:"500"},model:{value:t.dialogDelete,callback:function(e){t.dialogDelete=e},expression:"dialogDelete"}},[a("v-card",[a("v-card-title",{staticClass:"headline red",attrs:{"primary-title":""}},[t._v("\n          Delete "+t._s(t.user.username)+" ?\n        ")]),a("v-card-text",[a("br"),t._v("\n          this action is irreversible.\n        ")]),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialogDelete=!1}}},[t._v("\n            close\n          ")]),a("v-btn",{attrs:{color:"red",text:""},on:{click:function(e){return t.deleteUser(t.user.id)}}},[t._v("\n            delete\n          ")])],1)],1)],1)],1),a("div",{staticClass:"text-center"},[a("v-dialog",{attrs:{width:"500"},model:{value:t.dialogToken,callback:function(e){t.dialogToken=e},expression:"dialogToken"}},[a("v-card",[a("v-card-title",{staticClass:"headline primary",attrs:{"primary-title":""}},[t._v("\n          "+t._s(t.user.username)+" Token\n        ")]),t.user.user_settings?a("v-card-text",[a("br"),t._v("\n          "+t._s(t.user.user_settings.token)+"\n        ")]):t._e(),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialogToken=!1}}},[t._v("\n            close\n          ")])],1)],1)],1)],1)],1)},Pn=[],Mn={name:"UserCard",data(){return{search:"",headers:[{text:"Username",value:"username"},{text:"First Name",value:"first_name"},{text:"Last Name",value:"last_name"},{text:"Email",value:"email"},{text:"Staff",value:"is_staff"},{text:"Token",value:"token",sortable:!1},{text:"Date Joined",value:"date_joined"},{text:"Actions",value:"action",sortable:!1}],userRules:[t=>!!t||"Username is required"],emailRules:[t=>!!t||"E-mail is required",t=>/.+@.+/.test(t)||"E-mail must be valid"],users:[],user:{},editing:!1,show:!1,dialog:!1,dialogDelete:!1,dialogToken:!1}},mounted(){this.getUsers()},computed:{currentUserId(){return this.$store.state.id}},methods:{getUsers(){this.$http.get("api/users/").then(t=>{this.users=t.data})},createUser(){let t=new FormData;Object.keys(this.user).forEach(e=>t.append(e,this.user[e])),this.$http.post("api/users/",t).then(()=>{this.$toast("User created"),this.dialog=!1}).then(()=>{this.user={},this.getUsers()})},updateUser(){this.editing=!1;let t=new FormData;t.set("username",this.user.username),t.set("email",this.user.email),t.set("first_name",this.user.first_name),t.set("last_name",this.user.last_name),t.set("password",this.user.password),t.set("is_staff",this.user.is_staff),this.$http.patch("api/users/"+this.user.id+"/",t).then(()=>{this.$toast("User updated"),this.dialog=!1,this.user={}}).then(()=>{this.getUsers()})},showToken(t){this.dialogToken=!0,this.user=t},manageToken(t,e){let a=new FormData;a.set("action",t),this.$http.post("api/users/"+e.id+"/manage_token/",a).then(t=>{this.$toast(t.data.result)}).then(()=>{this.getUsers()})},confirmDelete(t){this.dialogDelete=!0,this.user=t},deleteUser(t){this.$http.delete("api/users/"+t).then(()=>{this.dialogDelete=!1,this.$toast("User deleted")}).then(()=>this.getUsers())},editUser(t){this.dialog=!0,this.editing=!0,this.user=t},resetUser(){this.dialog=!1,this.editing=!1,this.user={}}}},Ln=Mn,Nn=Object(u["a"])(Ln,Fn,Pn,!1,null,"7dccc9a6",null),Un=Nn.exports;m()(Nn,{VBtn:_["a"],VCard:g["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VCheckbox:Cs["a"],VChip:$t["a"],VCol:Pt["a"],VContainer:x["a"],VDataTable:Ht["a"],VDialog:Le["a"],VDivider:C["a"],VRow:Mt["a"],VSpacer:R["a"],VTextField:A["a"],VToolbar:ie["a"],VToolbarTitle:I["a"]});var zn={name:"Users",components:{UserCard:Un}},Bn=zn,Jn=Object(u["a"])(Bn,An,In,!1,null,"68ff4932",null),qn=Jn.exports;m()(Jn,{VContainer:x["a"]});var Hn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("ScheduleTable",{key:t.refreshKey}),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)],1)],1)},Kn=[],Gn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("\n      Schedules\n      "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion",headers:t.headers,items:t.schedules,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.enabled",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(s.enabled),dark:""}},[t._v(t._s(s.enabled))])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:s.enabled?"orange":"green",tile:"",dark:""},on:{click:function(e){return t.manageSchedule(s.enabled?"disable_job":"enable_job",s.name,s.minion)}}},[t._v("\n            "+t._s(s.enabled?"disable":"enable")+"\n          ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"red",tile:"",dark:""},on:{click:function(e){return t.manageSchedule("delete",s.name,s.minion)}}},[t._v("\n            delete\n          ")])],1)]}}])})],1)],1)},Wn=[],Yn={name:"ScheduleTable",data(){return{search:"",headers:[],schedules:[],loading:!0}},methods:{loadData(){this.loading=!1,this.$http.get("api/schedules/").then(t=>{if(this.schedules=t.data,this.schedules.length>0){let t=new Set(["minion","name","function"]);this.schedules.forEach(e=>{Object.keys(e).forEach(e=>{t.add(e)})}),t.delete("id"),t.forEach(t=>{this.headers.push({text:t,value:t})}),this.headers.push({text:"action",value:"action"})}})},manageSchedule(t,e,a){this.$toast(`${t} on ${a} for job ${e}`);let s=new FormData;s.set("action",t),s.set("name",e),s.set("minion",a),this.$http.post("api/schedules/manage/",s).then(()=>{this.$toast(`${t} on ${a} for job ${e}: done`)}).then(()=>{this.headers=[],this.schedules=[],this.loadData()})},boolRepr(t){return!0===t?"green":!1===t?"red":"primary"}},mounted(){this.loadData()}},Qn=Yn,Xn=Object(u["a"])(Qn,Gn,Wn,!1,null,"16fe8902",null),Zn=Xn.exports;m()(Xn,{VBtn:_["a"],VCard:g["a"],VCardTitle:y["c"],VChip:$t["a"],VContainer:x["a"],VDataTable:Ht["a"],VSpacer:R["a"],VTextField:A["a"]});var ti={name:"Schedules",components:{Fab:Te,ScheduleTable:Zn},data:()=>({fabs:[{color:"pink",action:"refreshSchedules",icon:"refresh",tooltip:"Refresh schedules"}],refreshKey:0}),methods:{fabAction(t){this[t]()},refreshSchedules(){this.$toast("refreshing schedules"),this.$http.post("/api/schedules/refresh/").then(()=>{this.refreshKey+=1,this.$toast("schedules refreshed")}).catch(function(t){alert(t)})}}},ei=ti,ai=Object(u["a"])(ei,Hn,Kn,!1,null,"56af01f4",null),si=ai.exports;m()(ai,{VCol:Pt["a"],VContainer:x["a"],VRow:Mt["a"]});var ni=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"4",offset:"4"}},[a("v-card",[a("v-card-title",{staticClass:"black white--text subheading",attrs:{"primary-title":""}},[a("span",{staticClass:"title"},[t._v("Oops")])]),a("v-card-text",{staticClass:"display-1 ma-7 text-center"},[t._v("\n          404. There is no page here.\n        ")]),a("v-card-actions",[a("v-btn",{staticClass:"primary darken-3 white--text",attrs:{text:"",to:"/"}},[a("v-icon",{attrs:{left:""},domProps:{textContent:t._s("mdi-arrow-left")}}),t._v("\n            Back\n          ")],1)],1)],1)],1)],1)],1)},ii=[],ri={name:"NotFound"},oi=ri,li=Object(u["a"])(oi,ni,ii,!1,null,"06e44549",null),ci=li.exports;m()(li,{VBtn:_["a"],VCard:g["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VCol:Pt["a"],VContainer:x["a"],VIcon:j["a"],VRow:Mt["a"]});var di=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[0===t.jobs.length&&0===t.minions.length?a("v-col",{attrs:{sm:"12"}},[a("v-container",[a("p",{staticClass:"display-2 text-center"},[t._v("Sorry, no results...")])])],1):t._e(),t.jobs.length>0?a("v-col",{attrs:{sm:"12"}},[a("v-container",[a("v-card",[a("v-card-title",[t._v("\n            Jobs\n            "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.job_search,callback:function(e){t.job_search=e},expression:"job_search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"jid","sort-desc":"",headers:t.jobs_headers,items:t.jobs,search:t.search,"items-per-page":5},scopedSlots:t._u([{key:"item.jid",fn:function(e){var s=e.item;return[a("v-btn",{staticClass:"text-none",class:s.jid.includes(t.query)?"red":"",attrs:{text:"",small:"",to:"/jobs/"+s.jid+"/"+s.id}},[t._v(t._s(s.jid)+"\n              ")])]}},{key:"item.fun",fn:function(e){var s=e.item;return[a("span",{class:s.fun.includes(t.query)?"red":""},[t._v(t._s(s.fun))])]}},{key:"item.arguments",fn:function(e){var a=e.item;return[t._v("\n              "+t._s(a.arguments.length>20?a.arguments.slice(0,20)+"...":a.arguments)+"\n            ")]}},{key:"item.success",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(s.success),dark:""}},[t._v(t._s(t.boolText(s.success)))])]}},{key:"item.alter_time",fn:function(e){var a=e.item;return[t._v("\n              "+t._s(new Date(a.alter_time).toLocaleString("en-GB"))+"\n            ")]}}],null,!1,1135029737)})],1)],1)],1):t._e(),t.minions.length>0?a("v-col",{attrs:{sm:"12"}},[a("v-container",[a("v-card",[a("v-card-title",[t._v("\n            Minions\n            "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.minions_headers,items:t.minions,"items-per-page":5},scopedSlots:t._u([{key:"item.minion_id",fn:function(e){var s=e.item;return[a("v-btn",{staticClass:"text-none",class:s.minion_id.includes(t.query)?"red":"",attrs:{text:"",small:"",to:"/minions/"+s.minion_id}},[t._v(t._s(s.minion_id)+"\n              ")])]}},{key:"item.conformity",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(s.conformity),dark:""}},[t._v(t._s(null==s.conformity?"unknown":s.conformity)+"\n              ")])]}},{key:"item.last_job",fn:function(e){var a=e.item;return[t._v("\n              "+t._s(null===a.last_job?"":new Date(a.last_job).toLocaleString("en-GB"))+"\n            ")]}},{key:"item.last_highstate",fn:function(e){var a=e.item;return[t._v("\n              "+t._s(null===a.last_highstate?"":new Date(a.last_highstate).toLocaleString("en-GB"))+"\n            ")]}}],null,!1,771680795)})],1)],1)],1):t._e()],1)],1)},ui=[],hi={name:"Search",data(){return{query:null,jobs:[],jobs_headers:[{text:"Jid",value:"jid"},{text:"Target",value:"id"},{text:"Function",value:"fun"},{text:"Arguments",value:"arguments"},{text:"User",value:"user"},{text:"Status",value:"success"},{text:"Date",value:"alter_time"}],job_search:"",minions:[],minions_headers:[{text:"Minion Id",value:"minion_id"},{text:"Highstate Conformity",value:"conformity"},{text:"F.Q.D.N",value:"fqdn"},{text:"O.S",value:"os"},{text:"O.S Version",value:"oscodename"},{text:"Kernel",value:"kernelrelease"},{text:"Last Job",value:"last_job"},{text:"Last Highstate",value:"last_highstate"}]}},created(){this.query=this.$route.query.q},mounted(){this.searchBar()},methods:{searchBar(){this.$http.get("api/search/?q="+this.query).then(t=>{function e(t){return t.forEach(t=>{let e=JSON.parse(t.grain);for(let a in e)t[a]=e[a]}),t}this.jobs=t.data.jobs,this.minions=e(t.data.minions)})},boolRepr(t){return!0===t?"green":"red"},boolText(t){return!0===t?"success":"failed"}}},mi=hi,vi=Object(u["a"])(mi,di,ui,!1,null,"f2f59722",null),pi=vi.exports;m()(vi,{VBtn:_["a"],VCard:g["a"],VCardTitle:y["c"],VChip:$t["a"],VCol:Pt["a"],VContainer:x["a"],VDataTable:Ht["a"],VRow:Mt["a"],VSpacer:R["a"],VTextField:A["a"]}),s["a"].use(tt["a"]);const fi=new tt["a"]({routes:[{path:"/",name:"home",component:Zt},{path:"/minions",name:"minions",component:qe},{path:"/minions/:minion_id",name:"minion_detail",component:Va,props:!0},{path:"/jobs",name:"jobs",component:me},{path:"/jobs/:jid/:minion_id",name:"job_detail",component:Ea,props:!0},{path:"/run",name:"run",component:As},{path:"/keys",name:"keys",component:Ee},{path:"/events",name:"events",component:qa},{path:"/conformity",name:"conformity",component:un},{path:"/conformity/:minion_id",name:"conformity_detail",component:Rn,props:!0},{path:"/schedules",name:"schedules",component:si},{path:"/users",name:"users",component:qn},{path:"/settings",name:"settings",component:Xs},{path:"/search",name:"search",component:pi},{path:"/login",name:"Login",component:oe,meta:{plainLayout:!0}},{path:"*",component:ci}]});fi.beforeEach((t,e,a)=>{nt.getters.isLoggedIn||"/login"===t.path?"/login"===t.path&&nt.getters.isLoggedIn?a("/"):a():a("/login")});var bi=fi,_i=a("04e1"),gi=a.n(_i);s["a"].config.productionTip=!1,s["a"].prototype.$http=st.a,s["a"].prototype.$http.defaults.xsrfCookieName="csrftoken",s["a"].prototype.$http.defaults.xsrfHeaderName="X-CSRFToken",s["a"].prototype.$http.defaults.headers.common["Content-Type"]="application/json";const yi=localStorage.getItem("token");yi&&(s["a"].prototype.$http.defaults.headers.common.Authorization=`Bearer ${yi}`,s["a"].prototype.$http.defaults.withCredentials=!0);let xi=!1,ki=[];const Ci=(t,e=null)=>{ki.forEach(a=>{t?a.reject(t):a.resolve(e)}),ki=[]};s["a"].prototype.$http.interceptors.request.use(t=>{const e=t,a=window.localStorage.getItem("refresh");return a&&gi()(a).exp-Math.floor(Date.now()/1e3)<60?nt.dispatch("logout").then(()=>{return bi.push({path:"/login",name:"Login"})}):e},t=>{return Promise.reject(t)}),s["a"].prototype.$http.interceptors.response.use(function(t){return t},function(t){const e=t.config;if(401===t.response.status&&!e._retry){if(xi)return new Promise(function(t,e){ki.push({resolve:t,reject:e})}).then(t=>{return e.headers["Authorization"]="Bearer "+t,s["a"].prototype.$http(e)}).catch(t=>{return t});e._retry=!0,xi=!0;const t=window.localStorage.getItem("refresh");return new Promise(function(a,n){s["a"].prototype.$http.post("/api/token/refresh/",{refresh:t}).then(({data:t})=>{window.localStorage.setItem("access",t.access),s["a"].prototype.$http.defaults.headers.common["Authorization"]="Bearer "+t.access,e.headers["Authorization"]="Bearer "+t.access,Ci(null,t.access),a(s["a"].prototype.$http(e))}).catch(t=>{Ci(t,null),n(t)}).then(()=>{xi=!1})})}return Promise.reject(t)}),new s["a"]({vuetify:Z,router:bi,store:nt,render:t=>t(G)}).$mount("#app")},"5eba":function(t,e,a){},a655:function(t,e,a){},c2a5:function(t,e,a){},cced:function(t,e,a){"use strict";var s=a("1775"),n=a.n(s);n.a},ce2f:function(t,e,a){"use strict";var s=a("a655"),n=a.n(s);n.a},e100:function(t,e,a){},efe9:function(t,e,a){}});
//# sourceMappingURL=app.ff12c412.js.map