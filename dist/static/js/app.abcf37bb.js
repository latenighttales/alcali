(function(t){function e(e){for(var n,i,o=e[0],l=e[1],c=e[2],d=0,h=[];d<o.length;d++)i=o[d],s[i]&&h.push(s[i][0]),s[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(n=!1)}n&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},s={app:0},r=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0122":function(t,e,a){"use strict";var n=a("55c6"),s=a.n(n);s.a},"034f":function(t,e,a){"use strict";var n=a("8a23"),s=a.n(n);s.a},"15fa":function(t,e,a){"use strict";var n=a("dd96"),s=a.n(n);s.a},"1c0b9":function(t,e,a){"use strict";var n=a("2287"),s=a.n(n);s.a},2287:function(t,e,a){},3244:function(t,e,a){"use strict";var n=a("d8e8"),s=a.n(n);s.a},"355a":function(t,e,a){"use strict";var n=a("9cda"),s=a.n(n);s.a},4678:function(t,e,a){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc10","./be.js":"1fc10","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=r(t);return a(e)}function r(t){var e=n[t];if(!(e+1)){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}return e}s.keys=function(){return Object.keys(n)},s.resolve=r,t.exports=s,s.id="4678"},"4ffd":function(t,e,a){t.exports=a.p+"static/img/logo.567c9b3a.png"},"55c6":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("4160"),a("caad"),a("0d03"),a("d3b7"),a("2532"),a("159b"),a("e623"),a("e379"),a("5dc8"),a("37e1");var n=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[t.layout?a("simple-layout"):a("app-layout")],1)},r=[],i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-navigation-drawer",{attrs:{"mini-variant":t.mini,app:"",clipped:""},scopedSlots:t._u([{key:"append",fn:function(){return[a("v-list-item",{staticClass:"elevation-24",on:{click:function(e){e.stopPropagation(),t.mini=!t.mini}}},[a("v-list-item-action",[t.mini?a("v-icon",[t._v("arrow_forward")]):a("v-icon",[t._v("arrow_back")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("COLLAPSE")])],1)],1)]},proxy:!0}]),model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{staticClass:"py-0",attrs:{dense:"",nav:"",dark:"",color:"#212121"}},[a("v-list-item",{attrs:{"two-line":""}},[a("v-list-item-avatar",[a("v-icon",{attrs:{large:""}},[t._v("person")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(t.username))]),a("v-list-item-subtitle",[t._v(t._s(t.email))])],1)],1)],1),a("v-divider"),a("v-list",{attrs:{dense:""}},t._l(t.routes,(function(e){return a("v-list-item",{key:e.name,attrs:{to:""+e.path}},[t.mini?a("v-list-item-action",[a("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on;return[a("v-icon",t._g({},s),[t._v(t._s(e.icon))])]}}],null,!0)},[a("span",[t._v(t._s(e.name))])])],1):a("v-list-item-action",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.name))])],1)],1)})),1),a("v-divider"),a("v-list",{attrs:{dense:""}},[a("v-list-item",{attrs:{to:"/users"}},[t.mini?a("v-list-item-action",[a("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-icon",t._g({},n),[t._v("group")])]}}],null,!1,3527340433)},[a("span",[t._v("Users")])])],1):a("v-list-item-action",[a("v-icon",[t._v("group")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Users")])],1)],1),a("v-list-item",{attrs:{to:"/settings"}},[t.mini?a("v-list-item-action",[a("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-icon",t._g({},n),[t._v("settings")])]}}],null,!1,1926182315)},[a("span",[t._v("Settings")])])],1):a("v-list-item-action",[a("v-icon",[t._v("settings")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Settings")])],1)],1)],1)],1),a("v-app-bar",{attrs:{color:"black",dark:"",app:"","clipped-left":""}},[a("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),a("v-toolbar-title",{staticClass:"font-weight-bold"},[t._v("ALCALI")]),a("v-spacer"),a("v-expand-transition",[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:t.expand_search,expression:"expand_search"}],staticClass:"mx-auto search",attrs:{flat:"","hide-details":"",label:"Search jids, minions, states...","solo-inverted":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchBar(e)}},model:{value:t.searchInput,callback:function(e){t.searchInput=e},expression:"searchInput"}})],1),a("v-btn",{staticClass:"mr-2",attrs:{icon:""},on:{click:function(e){t.expand_search=!t.expand_search}}},[a("v-icon",[t._v("search")])],1),a("v-menu",{attrs:{bottom:"",left:"","offset-y":"","offset-x":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-badge",{attrs:{color:"primary",overlap:""},scopedSlots:t._u([{key:"badge",fn:function(){return[t.notif_nb>0?a("span",[t._v(t._s(t.notif_nb))]):t._e()]},proxy:!0}],null,!0)},[a("v-icon",t._g({on:{click:function(e){t.notif_nb=0}}},n),[t._v("notifications")])],1)]}}]),model:{value:t.notif_menu,callback:function(e){t.notif_menu=e},expression:"notif_menu"}},[a("v-card",{attrs:{"min-width":"500px","max-width":"500px"}},[a("v-list",{attrs:{"max-height":"700px"}},[0===t.messages.length?a("v-list-item",[a("v-list-item-content",[a("v-list-item-subtitle",[t._v("No new notifications")])],1)],1):t._e(),t._l(t.messages,(function(e,n){return a("v-list-item",{key:n,attrs:{to:e.link}},[a("v-list-item-avatar",[a("v-icon",{attrs:{dark:"",color:e.color,size:"62"}},[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.text))]),a("v-list-item-subtitle",[t._v(t._s(e.tag))])],1)],1)}))],2),a("v-card-actions",{directives:[{name:"show",rawName:"v-show",value:t.messages.length>0,expression:"messages.length > 0"}]},[a("v-spacer"),a("v-btn",{attrs:{text:""},on:{click:function(e){t.messages=[]}}},[t._v("Clear")])],1)],1)],1),a("v-menu",{attrs:{bottom:"",left:"","offset-y":"","offset-x":"","close-on-click":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-btn",t._g({attrs:{icon:""}},n),[a("v-icon",[t._v("more_vert")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:t.toggleTheme}},[a("v-list-item-title",[t._v("Toggle Theme")])],1),a("v-divider"),a("v-list-item",{on:{click:t.logout}},[a("v-list-item-title",[t._v("Logout")])],1)],1)],1)],1),a("v-content",[a("v-fade-transition",{attrs:{mode:"out-in"}},[a("router-view",{key:t.$route.fullPath})],1)],1)],1)},o=[],l=(a("b64b"),a("9911"),a("91a3")),c=(a("c975"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),{methods:{fnmatch:function(t){if(-1===t.indexOf("*"))return function(e){return t===e};var e=/[\\^$.*+?()[\]{}|]/g,a=t.replace(e,"\\$&"),n=new RegExp("^"+a.replace(/\\\*/g,".*")+"$");return function(t){return n.test(t)}},sleep:function(t){return new Promise((function(e){return setTimeout(e,t)}))}}}),u={name:"Layout",props:{source:String},data:function(){return{expand_search:!1,notif_menu:!1,searchInput:"",drawer:!0,mini:!0,messages:[],settings:null,notif_nb:0,notifs:{created:!1,published:!1,returned:!1,event:!1},routes:[{name:"Overview",path:"/",icon:"dashboard"},{name:"Minions",path:"/minions",icon:"device_hub"},{name:"Jobs",path:"/jobs",icon:"playlist_play"},{name:"Run",path:"/run",icon:"play_arrow"},{name:"Job Templates",path:"/job_templates",icon:"playlist_add_check"},{name:"Schedules",path:"/schedules",icon:"schedule"},{name:"Conformity",path:"/conformity",icon:"done_all"},{name:"Keys",path:"/keys",icon:"compare_arrows"},{name:"Events",path:"/events",icon:"playlist_add"}]}},methods:{logout:function(){var t=this;this.$store.dispatch("logout").then((function(){t.$router.push("/login")}))},searchBar:function(){""!==this.searchInput&&this.$router.push({name:"search",query:{q:this.searchInput}})},getPrefs:function(){var t=this;this.$http.get("api/userssettings/"+this.$store.getters.user_id+"/").then((function(e){t.settings=e.data,Object.keys(t.notifs).forEach((function(e){t.notifs[e]=t.settings["notifs_"+e]}))}))},toggleTheme:function(){var t=this;this.$store.dispatch("toggleTheme").then((function(){t.$vuetify.theme.dark=JSON.parse(t.$store.state.theme)}))},saltStatus:function(){var t=this,e=c.methods.fnmatch("salt/job/*"),a=c.methods.fnmatch("salt/job/*/new"),n=c.methods.fnmatch("salt/job/*/ret/*"),s=localStorage.getItem("access"),r=new l["EventSourcePolyfill"]("/api/event_stream/",{headers:{Authorization:"Bearer ".concat(s)}});r.addEventListener("open",(function(){t.$store.dispatch("updateWs")})),r.addEventListener("message",(function(s){var r=JSON.parse(s.data);if(a(r.tag)&&!0===t.notifs.published){r.type="new",r.color="green",r.icon="keyboard_tab",r.link="";var i="";i=r.data.hasOwnProperty("tgt")?r.data.tgt:r.data.minions.length+" minion(s)",r.text="Job "+r.data.fun+" published for "+i,t.messages.unshift(r),t.messages.length>t.settings.max_notifs&&t.messages.pop(),t.notif_nb+=1}else n(r.tag)&&!0===t.notifs.returned?(r.type="return",r.color="primary",r.icon="subdirectory_arrow_left",r.text="Job "+r.data.fun+" returned for "+r.data.id,r.link="/jobs/"+r.data.jid+"/"+r.data.id,t.messages.unshift(r),t.messages.length>t.settings.max_notifs&&t.messages.pop(),t.notif_nb+=1):e(r.tag)&&!0===t.notifs.event?(r.type="event",r.color="orange",r.icon="more_horiz",r.text="Job Event",r.link="",t.messages.unshift(r),t.messages.length>t.settings.max_notifs&&t.messages.pop(),t.notif_nb+=1):/^\w{20}$/.test(r.tag)&&!0===t.notifs.created&&(r.type="created",r.color="secondary",r.icon="add",r.text="New Job Created",r.link="",t.messages.unshift(r),t.messages.length>t.settings.max_notifs&&t.messages.pop(),t.notif_nb+=1)}),!1)}},mounted:function(){this.getPrefs(),this.saltStatus(),this.$vuetify.theme.dark=JSON.parse(this.$store.getters.theme)},computed:{username:function(){return this.$store.state.username},email:function(){return this.$store.state.email},theme:function(){return this.$store.state.theme}}},d=u,h=(a("355a"),a("2877")),m=a("6544"),f=a.n(m),v=a("7496"),p=a("40dc"),b=a("5bc1"),_=a("4ca6"),g=a("8336"),y=a("b0af"),k=a("99d9"),x=a("a75b"),C=a("ce7e"),w=a("0789"),j=a("132d"),V=a("8860"),S=a("da13"),T=a("1800"),$=a("8270"),D=a("5d23"),O=a("e449"),E=a("f774"),A=a("2fa4"),I=a("8654"),R=a("2a7f"),P=a("3a2f"),F=Object(h["a"])(d,i,o,!1,null,null,null),M=F.exports;f()(F,{VApp:v["a"],VAppBar:p["a"],VAppBarNavIcon:b["a"],VBadge:_["a"],VBtn:g["a"],VCard:y["a"],VCardActions:k["a"],VContent:x["a"],VDivider:C["a"],VExpandTransition:w["a"],VFadeTransition:w["d"],VIcon:j["a"],VList:V["a"],VListItem:S["a"],VListItemAction:T["a"],VListItemAvatar:$["a"],VListItemContent:D["a"],VListItemSubtitle:D["b"],VListItemTitle:D["c"],VMenu:O["a"],VNavigationDrawer:E["a"],VSpacer:A["a"],VTextField:I["a"],VToolbarTitle:R["a"],VTooltip:P["a"]});var L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("router-view")},N=[],J={name:"SimpleLayout"},U=J,z=Object(h["a"])(U,L,N,!1,null,"0f66a338",null),q=z.exports,B={computed:{layout:function(){return this.$route.meta.plainLayout}},components:{"app-layout":M,"simple-layout":q}},H=B,K=(a("034f"),Object(h["a"])(H,s,r,!1,null,null,null)),G=K.exports;f()(K,{VApp:v["a"]});var W=a("f309"),Y=a("2db4"),X=a("87f6"),Q=a.n(X);n["a"].use(W["a"],{components:{VSnackbar:Y["a"],VBtn:g["a"],VIcon:j["a"]}}),n["a"].use(Q.a,{x:"center",y:"bottom",color:"black",icon:"info",iconColor:"",classes:["body-2"],timeout:3e3,dismissable:!0,multiLine:!1,vertical:!1,queueable:!1,showClose:!0,closeText:"",closeColor:"",shorts:{custom:{color:"purple"}},property:"$toast"});var Z=new W["a"]({icons:{iconfont:"md"},theme:{themes:{light:{primary:"#6200EE",secondary:"#03DAC6"},dark:{secondary:"#BB86FC",primary:"#03DAC6"}}}}),tt=a("8c4f"),et=a("ade3"),at=a("2f62"),nt=a("bc3a"),st=a.n(nt);n["a"].use(at["a"]);var rt=new at["a"].Store({state:{username:localStorage.getItem("username")||"",email:localStorage.getItem("email")||"",id:localStorage.getItem("id")||"",access:localStorage.getItem("access")||"",refresh:localStorage.getItem("refresh")||"",is_staff:localStorage.getItem("is_staff")||"false",ws_status:!1,theme:localStorage.getItem("theme")||!1},mutations:{auth_success:function(t,e){Object.keys(e).forEach((function(a){t[a]=e[a]}))},logout:function(t){t.access=""},updateWs:function(t){t.ws_status=!0},toggleTheme:function(t){t.theme=!t.theme,localStorage.setItem("theme",JSON.stringify(t.theme))}},getters:{isLoggedIn:function(t){return!!t.access},theme:function(t){return t.theme},user_id:function(t){return t.id},isStaff:function(t){return t.is_staff}},actions:{updateWs:function(t){var e=t.commit;e("updateWs")},toggleTheme:function(t){var e=t.commit;e("toggleTheme")},login:function(t,e){var a=t.commit;return new Promise((function(t,n){st()({url:"/api/token/",data:e,method:"POST"}).then((function(e){Object.keys(e.data).forEach((function(t){localStorage.setItem(t,e.data[t])})),st.a.defaults.headers.common.Authorization="Bearer ".concat(e.data.access),a("auth_success",e.data),t(e)})).catch((function(t){localStorage.clear(),n(t)}))}))},oauthlogin:function(t,e){var a=t.commit;return new Promise((function(t,n){st()({url:"/api/social/login/",data:e,method:"POST"}).then((function(e){delete Object.assign(e.data,Object(et["a"])({},"access",e.data["token"]))["token"],Object.keys(e.data).forEach((function(t){localStorage.setItem(t,e.data[t])})),st.a.defaults.headers.common.Authorization="Bearer ".concat(e.data.access),a("auth_success",e.data),t(e)})).catch((function(t){localStorage.clear(),n(t)}))}))},logout:function(t){var e=t.commit;return new Promise((function(t){e("logout"),localStorage.clear(),delete st.a.defaults.headers.common["Authorization"],t()}))}}}),it=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"7"}},[a("ConformityChart")],1),a("v-col",{attrs:{sm:"6",lg:"2"}},[a("KeysStatusCard")],1),a("v-col",{attrs:{sm:"6",lg:"3"}},[a("AlcaliStatusCard")],1)],1),a("v-row",[a("v-col",{attrs:{lg:"12"}},[a("JobsChartCard")],1)],1),a("v-row",[a("v-col",{attrs:{lg:"12"}},[a("JobsTable",{attrs:{filter:{limit:10}}})],1)],1)],1)},ot=[],lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Keys")]),a("v-simple-table",[a("tbody",t._l(t.keys_status,(function(e,n){return a("tr",{key:n},[a("td",{staticClass:"pr-0"},[a("v-icon",[t._v(t._s(t.statusIcon(n)))])],1),a("td",{staticClass:"pl-0"},[t._v(t._s(n))]),a("td",{staticClass:"text-right"},[t._v(t._s(e)+" / "+t._s(t.keys_total))])])})),0)])],1)],1)},ct=[],ut=(a("13d5"),a("07ac"),{name:"KeysStatusCard",data:function(){return{keys_status:{},keys_total:0}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;this.$http.get("api/keys/keys_status/").then((function(e){t.keys_status=e.data,t.keys_total=Object.values(e.data).reduce((function(t,e){return t+e}))}))},statusIcon:function(t){switch(t){case"accepted":return"check";case"rejected":return"first_page";case"denied":return"close";case"unaccepted":return"refresh"}}}}),dt=ut,ht=a("a523"),mt=a("1f4f"),ft=Object(h["a"])(dt,lt,ct,!1,null,"b6756222",null),vt=ft.exports;f()(ft,{VCard:y["a"],VCardTitle:k["c"],VContainer:ht["a"],VIcon:j["a"],VSimpleTable:mt["a"]});var pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",{attrs:{elevation:null==t.minion?2:0}},[a("v-list-item",{attrs:{"three-line":"",dense:""}},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"headline mb-1"},[t._v("Jobs Stats")])],1),a("v-spacer"),a("v-list-item-content",{staticClass:"mr-6"},[a("v-select",{attrs:{items:t.filters,label:"Filter","return-object":""},on:{change:t.loadData},model:{value:t.selectedFilter,callback:function(e){t.selectedFilter=e},expression:"selectedFilter"}})],1),a("v-list-item-content",[a("v-select",{attrs:{items:t.periods,label:"Period","return-object":""},on:{change:t.loadData},model:{value:t.selectedPeriod,callback:function(e){t.selectedPeriod=e},expression:"selectedPeriod"}})],1)],1),a("canvas",{ref:"chart"})],1)],1)},bt=[],_t=a("30ef"),gt=a.n(_t),yt=(a("a9e3"),{afterLayout:function(t){if(t.options.linearGradientLine){var e=t.chart.ctx;t.data.datasets.forEach((function(a){for(var n=Number.MAX_VALUE,s=Number.MIN_VALUE,r=0;r<a.data.length;++r)n>a.data[r]&&(n=a.data[r]),s<a.data[r]&&(s=a.data[r]);var i=t.scales["y-axis-0"],o=i.getPixelForValue(n),l=i.getPixelForValue(s),c=e.createLinearGradient(0,o,0,l);c.addColorStop(0,a.colorStart),c.addColorStop(1,a.colorEnd),a.borderColor=c}))}else if(t.options.radialGradientDonut){var a=t.chart.ctx;t.data.datasets.forEach((function(e){var n=(t.chartArea.left+t.chartArea.right)/2,s=(t.chartArea.top+t.chartArea.bottom)/2,r=a.createRadialGradient(n,s,2*t.innerRadius*.2,n,s,2*t.innerRadius);r.addColorStop(0,e.colorStart),r.addColorStop(1,e.colorEnd),e.backgroundColor=r}))}}}),kt=yt,xt={name:"JobsChartCard",props:["minion"],data:function(){return{filters:[{text:"All",value:"all"},{text:"Highstate",value:"highstate"},{text:"Other",value:"other"}],periods:[{text:"Week",value:7},{text:"Two Weeks",value:14},{text:"Month",value:30},{text:"Year",value:365}],jobchart:null,selectedFilter:null,selectedPeriod:null,labels:null,chart_data:[]}},mounted:function(){this.createChart()},methods:{loadData:function(){var t=this,e=null==this.selectedFilter?"all":this.selectedFilter.value,a=null==this.selectedPeriod?7:this.selectedPeriod.value,n={params:{fun:e,period:a}};this.minion&&(n.params.id=this.minion),this.$http.get("api/jobs/graph",n).then((function(e){t.jobchart.data.labels=e.data.labels,t.jobchart.data.datasets[0].data=e.data.series[0],t.jobchart.data.datasets[1].data=e.data.series[1],t.jobchart.update()}))},createChart:function(){var t=this,e=null==this.selectedFilter?"all":this.selectedFilter.value,a=null==this.selectedPeriod?7:this.selectedPeriod.value,n={params:{fun:e,period:a}};this.minion&&(n.params.id=this.minion),null!=this.jobchart&&this.jobchart.destroy(),this.$http.get("api/jobs/graph",n).then((function(e){t.labels=e.data.labels,t.chart_data[0]=e.data.series[0],t.chart_data[1]=e.data.series[1],t.$refs.chart.height=60,t.jobchart=new gt.a(t.$refs.chart,{type:"line",data:{labels:t.labels,datasets:[{lineTension:.1,pointRadius:1,data:t.chart_data[0],fill:!1,colorStart:"rgba(0, 173, 238, 1.0)",colorEnd:"rgba(231, 18, 143, 1.0)"},{lineTension:.1,pointRadius:1,data:t.chart_data[1],fill:!1,colorStart:"rgba(255, 255, 255, 1.0)",colorEnd:"rgba(255, 0, 0, 1.0)"}]},options:{linearGradientLine:!0,legend:{display:!1},scales:{xAxes:[{gridLines:{display:!0}}],yAxes:[{gridLines:{display:!0},ticks:{autoSkip:!0,beginAtZero:!0,maxTicksLimit:6}}]},responsive:!0},plugins:[kt]})}))}}},Ct=xt,wt=a("b974"),jt=Object(h["a"])(Ct,pt,bt,!1,null,"e0df043e",null),Vt=jt.exports;f()(jt,{VCard:y["a"],VContainer:ht["a"],VListItem:S["a"],VListItemContent:D["a"],VListItemTitle:D["c"],VSelect:wt["a"],VSpacer:A["a"]});var St=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Status")]),a("v-simple-table",[a("tbody",[a("tr",[a("td",[t._v("Salt WebSocket")]),a("td",{staticClass:"text-right"},[a("v-chip",{attrs:{color:t.wsStatus?"green":"red","text-color":"white"}},[t._v(" "+t._s(t.wsStatus?"OK":"NOT OK")+" ")])],1)]),t._l(t.stats,(function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),a("td",{staticClass:"text-right"},[t._v(t._s(e))])])}))],2)])],1)],1)},Tt=[],$t={name:"AlcaliStatusCard",mixins:[c],data:function(){return{stats:{}}},mounted:function(){this.loadData()},computed:{wsStatus:function(){return this.$store.state.ws_status}},methods:{loadData:function(){var t=this;this.$http.get("api/stats/").then((function(e){return t.stats=e.data}))}}},Dt=$t,Ot=a("cc20"),Et=Object(h["a"])(Dt,St,Tt,!1,null,"1eb41eb0",null),At=Et.exports;f()(Et,{VCard:y["a"],VCardTitle:k["c"],VChip:Ot["a"],VContainer:ht["a"],VSimpleTable:mt["a"]});var It=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Conformity")]),a("v-card-text",[a("v-container",[t._l(t.conformitynames,(function(e){return[a("v-row",{key:e,attrs:{"no-gutters":"",align:"center",justify:"center"}},[a("v-col",{attrs:{sm:"2"}},[t._v(t._s(e))]),a("v-col",{attrs:{sm:"10"}},[a("v-menu",{attrs:{"open-on-hover":"","max-width":"250px"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on;return[a("canvas",t._g({ref:e,refInFor:!0,attrs:{height:"15"}},s))]}}],null,!0)},[a("v-simple-table",{attrs:{dense:""}},[a("thead",[a("tr",[a("th",[t._v(t._s(e))])])]),a("tbody",{domProps:{innerHTML:t._s(t.customTool)}})])],1)],1)],1)]}))],2)],1)],1)],1)},Rt=[],Pt=(a("d81d"),a("b0c0"),a("02d0"),a("fcf4")),Ft={name:"ConformityChart",data:function(){return{conformitynames:null,confchart:null,conformity:null,customTool:""}},created:function(){},mounted:function(){this.loadConformity()},methods:{loadConformity:function(){var t=this;this.$http.get("api/minions/conformity/").then((function(e){t.conformity=e.data.data,t.conformitynames=e.data.name})).then((function(){t.conformity.forEach((function(e,a){var n={labels:[t.conformitynames[a]],datasets:[]};Object.keys(e).forEach((function(a){var s="";if(["conflict","false"].indexOf(a)>=0)s="#F44336";else if(["conform","true"].indexOf(a)>=0)s="#41f40e";else if(["None","unknown","null"].indexOf(a)>=0)s=t.$vuetify.theme.themes.light.primary;else{var r=Object.keys(Pt["a"]);s=Pt["a"][r[r.length*Math.random()<<0]].darken2}n.datasets.push({label:a,data:[e[a]],backgroundColor:s})})),new gt.a(t.$refs[t.conformitynames[a]],{type:"horizontalBar",data:n,options:{animation:!1,plugins:{stacked100:{enable:!0}},tooltips:{enabled:!1,mode:"index",intersect:!1,custom:function(e){if(e&&e.body){var a=e.body.map((function(t){return t.lines})),n="";a.forEach((function(t,a){var s=e.labelColors[a],r="background:"+s.backgroundColor;r+="; border-color:"+s.borderColor,r+="; border-width: 2px";var i='<span class="chartjs-tooltip-key" style="'.concat(r,'">__</span>');n+="<tr><td>"+i+"  "+t+"</td></tr>"})),t.customTool=n}}},legend:{display:!1},scales:{xAxes:[{stacked:!0,display:!1,gridLines:{display:!1,drawTicks:!1,drawBorder:!1},ticks:{display:!1,padding:-20}}],yAxes:[{stacked:!0,display:!1,ticks:{display:!1,padding:-20},gridLines:{drawTicks:!1,display:!1,drawBorder:!1}}]}}})}))}))}}},Mt=Ft,Lt=(a("3244"),a("62ad")),Nt=a("0fd9b"),Jt=Object(h["a"])(Mt,It,Rt,!1,null,"bcf3f6c0",null),Ut=Jt.exports;f()(Jt,{VCard:y["a"],VCardText:k["b"],VCardTitle:k["c"],VCol:Lt["a"],VContainer:ht["a"],VMenu:O["a"],VRow:Nt["a"],VSimpleTable:mt["a"]});var zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[null==t.filter?a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{sm:"12"}},[a("v-card",{staticClass:"mb-8"},[a("v-row",[a("v-col",{attrs:{lg:"2"}},[a("v-card-title",[t._v("Search Jobs")])],1),a("v-divider"),a("v-col",{attrs:{lg:"2","align-self":"center"}},[a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":t.selectedDate,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":function(e){t.selectedDate=e},"update:return-value":function(e){t.selectedDate=e}},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-text-field",t._g({attrs:{label:"Select date(s)",readonly:""},model:{value:t.dateRangeText,callback:function(e){t.dateRangeText=e},expression:"dateRangeText"}},n))]}}],null,!1,4129137489),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-date-picker",{attrs:{max:(new Date).toISOString().split("T")[0],reactive:"","no-title":"",range:""},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}},[a("div",{staticClass:"flex-grow-1"}),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu=!1}}},[t._v("Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu.save(t.selectedDate)}}},[t._v("OK")])],1)],1)],1),a("v-col",{attrs:{lg:"2"}},[a("v-autocomplete",{attrs:{items:t.users,label:"User(s)",multiple:"","single-line":""},scopedSlots:t._u([{key:"selection",fn:function(e){var n=e.item,s=e.index;return[0===s?a("span",[t._v(t._s(n))]):t._e(),1===s?a("span",{staticClass:"grey--text caption"},[t._v(" (+"+t._s(t.selectedUsers.length-1)+" others)")]):t._e()]}}],null,!1,2591977476),model:{value:t.selectedUsers,callback:function(e){t.selectedUsers=e},expression:"selectedUsers"}})],1),a("v-col",{attrs:{lg:"2"}},[a("v-autocomplete",{attrs:{items:t.minions,label:"Target(s)",multiple:"","single-line":""},scopedSlots:t._u([{key:"selection",fn:function(e){var n=e.item,s=e.index;return[0===s?a("span",[t._v(t._s(n))]):t._e(),1===s?a("span",{staticClass:"grey--text caption"},[t._v(" (+"+t._s(t.selectedTarget.length-1)+" others)")]):t._e()]}}],null,!1,3190666039),model:{value:t.selectedTarget,callback:function(e){t.selectedTarget=e},expression:"selectedTarget"}})],1),a("v-col",{attrs:{lg:"1"}},[a("v-select",{attrs:{items:t.limit,label:"Limit","single-line":""},model:{value:t.selectedLimit,callback:function(e){t.selectedLimit=e},expression:"selectedLimit"}})],1),a("v-col",{attrs:{lg:"1","align-self":"center"}},[a("div",{staticClass:"text-center"},[a("v-btn",{attrs:{color:"primary"},on:{click:t.filterJobs}},[t._v("Search ")])],1)])],1)],1)],1)],1):t._e(),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{sm:"12"}},[a("v-card",{attrs:{elevation:null==t.filter?2:0}},[a("v-card-title",[t._v(" Jobs "),a("v-spacer"),a("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"jid","sort-desc":"","item-key":"uniqueid",headers:t.filteredHeaders,items:t.indexedItems,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.jid",fn:function(e){var n=e.item;return[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/jobs/"+n.jid+"/"+n.id}},[t._v(t._s(n.jid))])]}},{key:"item.id",fn:function(e){var n=e.item;return[a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!t.filter,expression:"!filter"}],staticClass:"text-none",attrs:{text:"",small:"",to:"/minions/"+n.id}},[t._v(t._s(n.id))])]}},{key:"item.arguments",fn:function(e){var a=e.item;return[t._v(" "+t._s(a.arguments.length>20?a.arguments.slice(0,20)+"...":a.arguments)+" ")]}},{key:"item.keyword_arguments",fn:function(e){var a=e.item;return[t._v(" "+t._s(a.keyword_arguments.length>20?a.keyword_arguments.slice(0,20)+"...":a.keyword_arguments)+" ")]}},{key:"item.success",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(n.success),dark:""}},[t._v(t._s(t.boolText(n.success)))])]}},{key:"item.alter_time",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Date(a.alter_time).toLocaleString("en-GB"))+" ")]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue",tile:"",dark:"",to:"/jobs/"+n.jid+"/"+n.id}},[t._v(" detail ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue-grey",tile:"",dark:"",to:"/run?tgt="+n.id+"&fun="+n.fun+"&arg="+n.arguments+"&kwarg="+n.keyword_arguments}},[t._v(" rerun ")])],1)]}}])})],1)],1)],1)],1)},qt=[];a("a4d3"),a("4de4"),a("a15b"),a("a434"),a("e439"),a("dbb4");function Bt(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function Ht(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Bt(Object(a),!0).forEach((function(e){Object(et["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Bt(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var Kt={name:"JobsTable",props:["filter","jid"],data:function(){return{menu:!1,limit:[50,100,200,500,1e3],selectedDate:[],selectedLimit:null,selectedUsers:null,selectedTarget:null,minions:[],users:[],search:"",headers:[{text:"Jid",value:"jid"},{text:"Target",value:"id"},{text:"Function",value:"fun"},{text:"Arguments",value:"arguments"},{text:"Keyword Arguments",value:"keyword_arguments"},{text:"User",value:"user"},{text:"Status",value:"success"},{text:"Date",value:"alter_time"},{text:"Actions",value:"action",sortable:!1}],jobs:[],loading:!0}},computed:{indexedItems:function(){return this.jobs.map((function(t,e){return Ht({uniqueid:e},t)}))},dateRangeText:function(){return this.selectedDate.join(" ~ ")},filteredHeaders:function(){return this.filter&&this.filter.hasOwnProperty("target[]")&&this.headers.splice(1,1),this.headers}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;this.$http.get("api/jobs/filters/").then((function(e){t.minions=e.data.minions,t.users=e.data.users})),this.jid?this.$http.get("api/jobs/".concat(this.jid)).then((function(e){t.jobs=e.data,t.loading=!1})):this.$http.get("api/jobs/",{params:this.filter}).then((function(e){t.jobs=e.data,t.loading=!1}))},filterJobs:function(){var t=this;this.loading=!0;var e={limit:this.selectedLimit,target:this.selectedTarget,users:this.selectedUsers};this.selectedDate.length>0&&(e.start=this.selectedDate[0],e.end=this.selectedDate[1]||this.selectedDate[0]),this.$http.get("api/jobs/",{params:e}).then((function(e){t.jobs=e.data,t.loading=!1,t.selectedUsers=t.selectedTarget=t.selectedLimit=t.selectedDate=null,t.selectedDate=[]}))},boolRepr:function(t){return!0===t?"green":"red"},boolText:function(t){return!0===t?"success":"failed"}}},Gt=Kt,Wt=a("c6a6"),Yt=a("8fea"),Xt=a("2e4b"),Qt=Object(h["a"])(Gt,zt,qt,!1,null,"a13fe544",null),Zt=Qt.exports;f()(Qt,{VAutocomplete:Wt["a"],VBtn:g["a"],VCard:y["a"],VCardTitle:k["c"],VChip:Ot["a"],VCol:Lt["a"],VContainer:ht["a"],VDataTable:Yt["a"],VDatePicker:Xt["a"],VDivider:C["a"],VMenu:O["a"],VRow:Nt["a"],VSelect:wt["a"],VSpacer:A["a"],VTextField:I["a"]});var te={name:"home",components:{JobsTable:Zt,ConformityChart:Ut,AlcaliStatusCard:At,KeysStatusCard:vt,JobsChartCard:Vt}},ee=te,ae=Object(h["a"])(ee,it,ot,!1,null,null,null),ne=ae.exports;f()(ae,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{id:"inspire"}},[n("v-content",[n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"8",lg:"4"}},[n("v-img",{staticClass:"elevation-0",staticStyle:{float:"right"},attrs:{src:a("4ffd"),width:"100","aspect-ratio":"1"}}),n("h2",{staticClass:"text-center font-weight-black display-4 mb-8"},[t._v("ALCALI")]),n("v-card",{staticClass:"elevation-12"},[n("v-toolbar",{attrs:{color:"black",dark:"",flat:""}},[n("v-toolbar-title",[t._v("Login")]),n("v-spacer")],1),n("v-form",{nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.authenticate(e)}}},[n("v-card-text",[n("v-text-field",{attrs:{label:"Login",name:"login","prepend-icon":"person",type:"text"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),n("v-text-field",{attrs:{label:"Password",name:"password","prepend-icon":"lock",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(e){return e.preventDefault(),t.authenticate(e)}}},[t._v("Login")])],1)],1)],1)],1),n("v-col",{attrs:{sm:"12",align:"center"}},[n("v-btn",{attrs:{disabled:!t.isInit},on:{click:t.handleClickGetAuth}},[t._v("sign in "),n("span",{staticClass:"ml-2"},[n("GoogleLogo")],1)])],1)],1)],1)],1)],1)},re=[],ie=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("svg",{attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"18px",height:"18px",viewBox:"0 0 48 48"}},[a("g",[a("path",{attrs:{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}}),a("path",{attrs:{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}}),a("path",{attrs:{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}}),a("path",{attrs:{fill:"#34A853",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"}}),a("path",{attrs:{fill:"none",d:"M0 0h48v48H0z"}})])])},oe=[],le={name:"GoogleLogo"},ce=le,ue=Object(h["a"])(ce,ie,oe,!1,null,null,null),de=ue.exports,he=a("c9bf"),me={name:"Login",components:{GoogleLogo:de},data:function(){return{username:null,password:null,isInit:!1,isSignIn:!1,provider:null,clientId:null,redirectUri:null}},methods:{authenticate:function(){var t=this,e=this.username,a=this.password;this.$store.dispatch("login",{username:e,password:a}).then((function(){return t.$router.push("/")})).catch((function(){t.$toast.error("Invalid Login / Password")}))},handleClickGetAuth:function(){var t=this;this.$gAuth.getAuthCode().then((function(e){var a=new FormData;a.set("provider",t.provider),a.set("code",e),a.set("redirect_uri",t.redirectUri),t.$store.dispatch("oauthlogin",a).then((function(){return t.$router.push("/")})).catch((function(){t.$toast.error("Unauthorized")}))})).catch((function(){t.$toast.error("Unauthorized")}))}},mounted:function(){var t=this;this.$http.get("api/social/").then((function(e){t.provider=e.data.provider,t.clientId=e.data.client_id,t.redirectUri=e.data.redirect_uri;var a={clientId:t.clientId,scope:"profile email",prompt:"select_account"};n["a"].use(he["a"],a);var s=setInterval((function(){t.isInit=t.$gAuth.isInit,t.isSignIn=t.$gAuth.isAuthorized,t.isInit&&clearInterval(s)}),1e3)}))}},fe=me,ve=(a("1c0b9"),a("4bd4")),pe=a("adda"),be=a("71d9"),_e=Object(h["a"])(fe,se,re,!1,null,"5b563f4a",null),ge=_e.exports;f()(_e,{VApp:v["a"],VBtn:g["a"],VCard:y["a"],VCardActions:k["a"],VCardText:k["b"],VCol:Lt["a"],VContainer:ht["a"],VContent:x["a"],VForm:ve["a"],VImg:pe["a"],VRow:Nt["a"],VSpacer:A["a"],VTextField:I["a"],VToolbar:be["a"],VToolbarTitle:R["a"]});var ye=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",cols:"12"}},[a("JobsTable",{attrs:{jid:t.jid}})],1)],1)],1)},ke=[],xe={name:"Jobs",props:["jid"],components:{JobsTable:Zt}},Ce=xe,we=Object(h["a"])(Ce,ye,ke,!1,null,"68dbc7b2",null),je=we.exports;f()(we,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var Ve=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("KeysTable",{key:t.refreshKey})],1)],1),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)},Se=[],Te=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v(" Keys "),a("v-spacer"),a("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion_id",headers:t.headers,items:t.keys,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.minion_id",fn:function(e){var n=e.item;return["accepted"===n.status?[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/minions/"+n.minion_id}},[t._v(t._s(n.minion_id))])]:[t._v(" "+t._s(n.minion_id)+" ")]]}},{key:"item.status",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.keysRepr(n.status),dark:""}},[t._v(t._s(n.status.toString()))])]}},{key:"item.action",fn:function(e){var n=e.item;return[t._l(t.keyAction(n.status),(function(e){return[a("v-btn",{key:e,staticClass:"ma-2",attrs:{small:"",dark:"",color:t.keysRepr(e)},on:{click:function(a){return t.manageKey(e,n.minion_id)}}},[t._v(" "+t._s(e)+" ")])]}))]}}])})],1)],1)},$e=[],De=(a("2ca0"),a("ddb0"),{name:"KeysTable",data:function(){return{search:"",headers:[{text:"Minion Id",value:"minion_id"},{text:"Status",value:"status"},{text:"Public Key",value:"pub"},{text:"Actions",value:"action",sortable:!1}],keys:[],loading:!0}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;this.$http.get("api/keys/").then((function(e){t.keys=e.data,t.loading=!1}))},sleep:function(t){return new Promise((function(e){return setTimeout(e,t)}))},keysRepr:function(t){return t.startsWith("accept")?"green":t.startsWith("reject")?"orange":t.startsWith("de")?"red":"grey"},keyAction:function(t){return"accepted"===t?["reject","delete"]:"rejected"===t?["accept","delete"]:"denied"===t?["accept"]:["accept","delete"]},manageKey:function(t,e){var a=this,n=new FormData;n.set("action",t),n.set("target",e),this.$http.post("api/keys/manage_keys/",n).then((function(t){a.$toast(t.data.result)})).catch((function(t){a.$toast.error(t.response.data)})),this.sleep(2e3).then((function(){a.loadData()}))}}}),Oe=De,Ee=Object(h["a"])(Oe,Te,$e,!1,null,"052e3b53",null),Ae=Ee.exports;f()(Ee,{VBtn:g["a"],VCard:y["a"],VCardTitle:k["c"],VChip:Ot["a"],VContainer:ht["a"],VDataTable:Yt["a"],VSpacer:A["a"],VTextField:I["a"]});var Ie=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-speed-dial",{attrs:{fixed:"",bottom:"",right:"",direction:"top",transition:"slide-y-reverse-transition"},scopedSlots:t._u([{key:"activator",fn:function(){return[a("v-btn",{attrs:{color:"primary",fab:""},model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[t.fab?a("v-icon",[t._v("close")]):a("v-icon",[t._v("menu")])],1)]},proxy:!0}]),model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[t._l(t.fabs,(function(e){return[a("v-tooltip",{key:e.tooltip,attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on;return[a("v-btn",t._g({attrs:{fab:"",dark:"",small:"",color:e.color},on:{click:function(a){return t.emit("fab_action",e.action)}}},s),[a("v-icon",[t._v(t._s(e.icon))])],1)]}}],null,!0)},[a("span",[t._v(t._s(e.tooltip))])])]}))],2)},Re=[],Pe={name:"Fab",props:["fabs"],methods:{emit:function(t,e){this.$emit(t,e)}},data:function(){return{fab:!1}}},Fe=Pe,Me=a("c73b"),Le=Object(h["a"])(Fe,Ie,Re,!1,null,"56c34fbd",null),Ne=Le.exports;f()(Le,{VBtn:g["a"],VIcon:j["a"],VSpeedDial:Me["a"],VTooltip:P["a"]});var Je={name:"Keys",components:{Fab:Ne,KeysTable:Ae},data:function(){return{fabs:[{color:"blue",action:"refreshKeys",icon:"compare_arrows",tooltip:"Refresh keys"},{color:"orange",action:"rejectAll",icon:"close",tooltip:"Reject all keys"},{color:"green",action:"acceptAll",icon:"done",tooltip:"Accept all keys"}],refreshKey:0}},methods:{fabAction:function(t){this[t]()},refreshKeys:function(){var t=this;this.$toast("refreshing keys"),this.$http.post("/api/keys/refresh/").then((function(e){t.$toast("keys refreshed")})).then((function(){t.refreshKey+=1})).catch((function(e){t.$toast.error(e.response.data)}))},acceptAll:function(){var t=this,e=new FormData;e.set("action","accept"),e.set("target","*"),this.$http.post("api/keys/manage_keys/",e).then((function(e){t.$toast(e.data.result)})).then((function(){t.refreshKey+=1})).catch((function(e){t.$toast.error(e.response.data)}))},rejectAll:function(){var t=this,e=new FormData;e.set("action","reject"),e.set("target","*"),this.$http.post("api/keys/manage_keys/",e).then((function(e){t.$toast(e.data.result)})).then((function(){t.refreshKey+=1})).catch((function(e){t.$toast.error(e.response.data)}))}}},Ue=Je,ze=Object(h["a"])(Ue,Ve,Se,!1,null,"0e91a6f5",null),qe=ze.exports;f()(ze,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var Be=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",cols:"12"}},[a("MinionsTable",{key:t.refreshKey}),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)],1)],1)},He=[],Ke=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v(" Minions "),a("v-spacer"),a("v-menu",{attrs:{"close-on-content-click":!1,"offset-y":"","offset-x":"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-btn",t._g({staticClass:"mr-5",attrs:{color:"primary",dark:""}},n),[t._v(" Columns ")])]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-card",{attrs:{flat:"","max-width":"700"}},[a("v-card-text",[a("v-container",{attrs:{fluid:""}},[a("v-row",{attrs:{"no-gutters":""}},[t._l(t.available_headers,(function(e,n){return[a("v-col",{key:n,attrs:{cols:"4"}},[a("v-checkbox",{attrs:{label:e,value:e,"hide-details":""},model:{value:t.default_headers,callback:function(e){t.default_headers=e},expression:"default_headers"}})],1)]}))],2)],1)],1)],1)],1),a("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion_id",headers:t.customHeaders,items:t.minions,search:t.search,loading:t.loading,"loading-text":"Loading... Please wait"},scopedSlots:t._u([{key:"item.minion_id",fn:function(e){var n=e.item;return[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/minions/"+n.minion_id}},[t._v(t._s(n.minion_id))])]}},{key:"item.conformity",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(n.conformity),dark:""}},[t._v(t._s(n.conformity)+" ")])]}},{key:"item.last_job",fn:function(e){var a=e.item;return[t._v(" "+t._s(null===a.last_job?"":new Date(a.last_job).toLocaleString("en-GB"))+" ")]}},{key:"item.last_highstate",fn:function(e){var a=e.item;return[t._v(" "+t._s(null===a.last_highstate?"":new Date(a.last_highstate).toLocaleString("en-GB"))+" ")]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue",tile:"",dark:""},on:{click:function(e){return t.refreshMinion(n.minion_id)}}},[t._v(" refresh ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue-grey",tile:"",dark:"",to:"/run?tgt="+n.minion_id}},[t._v(" run job ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"red",tile:"",dark:""},on:{click:function(e){return e.stopPropagation(),t.showDialog(n.minion_id)}}},[t._v(" delete ")])],1)]}}])})],1),a("div",{staticClass:"text-center"},[a("v-dialog",{attrs:{width:"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline red",attrs:{"primary-title":""}},[t._v(" Delete "+t._s(t.target)+" ? ")]),a("v-card-text",[a("br"),t._v(" If you delete "+t._s(t.target)+" from the database, you will need to refresh all minions. ")]),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialog=!1}}},[t._v(" close ")]),a("v-btn",{attrs:{color:"red",text:""},on:{click:function(e){return t.deleteMinion(t.target)}}},[t._v(" delete ")])],1)],1)],1)],1)],1)},Ge=[],We=(a("99af"),a("1276"),{name:"MinionsTable",data:function(){return{search:"",dialog:!1,default_headers:["minion_id","conformity","fqdn","os","oscodename","kernelrelease","last_job","last_highstate"],unwanted_headers:["pillar","grain","id"],available_headers:[],minions:[],menu:!1,target:null,loading:!0}},computed:{customHeaders:function(){var t=[];return this.default_headers.forEach((function(e){var a=e.split("_").map((function(t){return t.replace(/^\w/,(function(t){return t.toUpperCase()}))})).join(" ");t.push({text:a,value:e})})),t.push({text:"Actions",value:"action",sortable:!1}),t}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;this.$http.get("api/minions/").then((function(e){function a(t){return t.forEach((function(t){var e=JSON.parse(t.grain);for(var a in e)t[a]=e[a]})),t}t.minions=a(e.data),t.loading=!1,t.available_headers=t.available_headers.concat(t.default_headers),t.minions.length>0&&Object.keys(t.minions[0]).forEach((function(e){"string"!==typeof t.minions[0][e]||t.default_headers.includes(e)||t.unwanted_headers.includes(e)||e.startsWith("lsb")||t.available_headers.push(e)}))}))},boolRepr:function(t){return"True"===t?"green":"False"===t?"red":"primary"},refreshMinion:function(t){var e=this;this.$toast("refreshing "+t);var a=new FormData;a.set("minion_id",t),this.$http.post("/api/minions/refresh_minions/",a).then((function(t){e.$toast(t.data.result)})).catch((function(t){e.$toast.error(t.response.data)}))},deleteMinion:function(t){var e=this;this.dialog=!1,this.$http.delete("/api/minions/"+t).then((function(){e.minions.splice(e.minions.indexOf(t),1),e.$toast(t+" deleted")})).catch((function(t){e.$toast.error(t.response.data)}))},showDialog:function(t){this.target=t,this.dialog=!0}}}),Ye=We,Xe=a("ac7c"),Qe=a("169a"),Ze=Object(h["a"])(Ye,Ke,Ge,!1,null,"6ed076fc",null),ta=Ze.exports;f()(Ze,{VBtn:g["a"],VCard:y["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:k["c"],VCheckbox:Xe["a"],VChip:Ot["a"],VCol:Lt["a"],VContainer:ht["a"],VDataTable:Yt["a"],VDialog:Qe["a"],VDivider:C["a"],VMenu:O["a"],VRow:Nt["a"],VSpacer:A["a"],VTextField:I["a"]});var ea={name:"Minions",components:{Fab:Ne,MinionsTable:ta},data:function(){return{refreshKey:0,fabs:[{color:"pink",action:"refreshMinions",icon:"refresh",tooltip:"Refresh all minions"},{color:"orange",action:"runAll",icon:"playlist_play",tooltip:"Run job on all minions"}]}},methods:{fabAction:function(t){this[t]()},refreshMinions:function(){var t=this;this.$toast("refreshing minions"),this.$http.post("/api/minions/refresh_minions/").then((function(){t.$toast("minions refreshed")})).then((function(){t.refreshKey+=1})).catch((function(e){t.$toast.error(e.response.data)}))},runAll:function(){this.$router.push("/run?tgt=*")}}},aa=ea,na=Object(h["a"])(aa,Be,He,!1,null,"baf91110",null),sa=na.exports;f()(na,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var ra=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"3"}},[null!==t.minion?a("InfosCard",{attrs:{minion:t.minion}}):t._e(),null!==t.minion?a("NetworkCard",{attrs:{minion:t.minion}}):t._e()],1),a("v-col",{attrs:{sm:"12",lg:"9"}},[null!==t.minion?a("MinionDetailCard",{attrs:{minion:t.minion}}):t._e()],1),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)],1)},ia=[],oa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v(t._s(t.minion.id))]),a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#common"}},[t._v(" Common ")]),a("v-tab",{attrs:{href:"#salt"}},[t._v(" Salt ")]),a("v-tab",{attrs:{href:"#hardware"}},[t._v(" Hardware ")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"common"}},[a("v-simple-table",[a("tbody",t._l(t.common,(function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),"last_job"===e.grain||"last_highstate"===e.grain&&null!==t.minion[e.grain]?a("td",{staticClass:"text-right"},[t._v(t._s(new Date(t.minion[e.grain]).toLocaleString("en-GB"))+" ")]):"conformity"===e.grain?a("td",{staticClass:"text-right"},[a("v-chip",{attrs:{color:t.boolRepr(t.minion[e.grain]),dark:""}},[t._v(t._s(null==t.minion[e.grain]?"unknown":t.minion[e.grain]))])],1):a("td",{staticClass:"text-right"},[t._v(t._s(t.minion[e.grain]))])])})),0)])],1),a("v-tab-item",{attrs:{id:"salt"}},[a("v-simple-table",[a("tbody",t._l(t.salt,(function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion[e.grain]))])])})),0)])],1),a("v-tab-item",{attrs:{id:"hardware"}},[a("v-simple-table",[a("tbody",t._l(t.hardware,(function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion[e.grain]))])])})),0)])],1)],1)],1)],1)},la=[],ca={name:"InfosCard",data:function(){return{tab:null,common:[{name:"F.Q.D.N",grain:"fqdn"},{name:"O.S",grain:"os"},{name:"O.S Version",grain:"oscodename"},{name:"Kernel",grain:"kernelrelease"},{name:"Last Job",grain:"last_job"},{name:"Last Highstate",grain:"last_highstate"},{name:"Highstate Conformity",grain:"conformity"}],salt:[{name:"ID",grain:"id"},{name:"Master",grain:"master"},{name:"Salt Version",grain:"saltversion"},{name:"Salt Path",grain:"saltpath"},{name:"Python Version",grain:"pythonversion"}],hardware:[{name:"C.P.U Model",grain:"cpu_model"},{name:"Number of C.P.U",grain:"num_cpus"},{name:"Total Memory",grain:"mem_total"},{name:"Total Swap",grain:"swap_total"},{name:"Virtual",grain:"virtual"}]}},props:["minion"],methods:{boolRepr:function(t){return"True"===t?"green":"False"===t?"red":"primary"}}},ua=ca,da=a("71a3"),ha=a("c671"),ma=a("fe57"),fa=a("aac8"),va=a("9a96"),pa=Object(h["a"])(ua,oa,la,!1,null,"4fe954ae",null),ba=pa.exports;f()(pa,{VCard:y["a"],VCardTitle:k["c"],VChip:Ot["a"],VContainer:ht["a"],VSimpleTable:mt["a"],VTab:da["a"],VTabItem:ha["a"],VTabs:ma["a"],VTabsItems:fa["a"],VTabsSlider:va["a"]});var _a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Network")]),a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#interface"}},[t._v(" Interfaces ")]),a("v-tab",{attrs:{href:"#mac"}},[t._v(" Mac ")]),a("v-tab",{attrs:{href:"#dns"}},[t._v(" Dns ")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"interface"}},[a("v-simple-table",[a("tbody",[t._l(t.minion.ip_interfaces,(function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),t._l(e,(function(e){return a("td",{staticClass:"text-right"},[t._v(t._s(e))])}))],2)})),a("tr",[a("td",[t._v("IPv4 GATEWAY")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion.ip4_gw))])]),a("tr",[a("td",[t._v("IPv6 GATEWAY")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion.ip6_gw))])])],2)])],1),a("v-tab-item",{attrs:{id:"mac"}},[a("v-simple-table",[a("tbody",t._l(t.minion.hwaddr_interfaces,(function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),a("td",{staticClass:"text-right"},[t._v(t._s(e))])])})),0)])],1),a("v-tab-item",{attrs:{id:"dns"}},[a("v-simple-table",[a("tbody",t._l(t.minion.dns,(function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),a("td",{staticClass:"text-right"},[t._v(t._s(e.length>=1?e:""))])])})),0)])],1)],1)],1)],1)},ga=[],ya={name:"NetworkCard",data:function(){return{tab:null,tabs:3}},props:["minion"]},ka=ya,xa=Object(h["a"])(ka,_a,ga,!1,null,"4e9c41e8",null),Ca=xa.exports;f()(xa,{VCard:y["a"],VCardTitle:k["c"],VContainer:ht["a"],VSimpleTable:mt["a"],VTab:da["a"],VTabItem:ha["a"],VTabs:ma["a"],VTabsItems:fa["a"],VTabsSlider:va["a"]});var wa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#grain"}},[t._v(" Grains ")]),a("v-tab",{attrs:{href:"#pillar"}},[t._v(" Pillar ")]),a("v-tab",{attrs:{href:"#history"}},[t._v(" History ")]),a("v-tab",{attrs:{href:"#graph"}},[t._v(" Graph ")]),t._l(t.minion.custom_fields,(function(e){return a("v-tab",{key:e.name},[t._v(" "+t._s(e.name)+" ")])}))],2),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"grain"}},[a("div",{staticClass:"text-right"},[a("v-btn",{staticClass:"overlayedBtn",on:{click:function(e){return t.fold("grainCm")}}},[t._v(t._s(t.grainCmFolded?"unfold":"fold"))])],1),a("codemirror",{ref:"grainCm",attrs:{options:t.cmOptions},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),a("v-tab-item",{attrs:{id:"pillar"}},[a("div",{staticClass:"text-right"},[a("v-btn",{staticClass:"overlayedBtn",on:{click:function(e){return t.fold("pillarCm")}}},[t._v(t._s(t.pillarCmFolded?"unfold":"fold"))])],1),a("codemirror",{ref:"pillarCm",attrs:{options:t.cmOptions},model:{value:t.codepillar,callback:function(e){t.codepillar=e},expression:"codepillar"}})],1),a("v-tab-item",{attrs:{id:"history"}},[a("JobsTable",{attrs:{filter:{"target[]":t.minion.minion_id}}})],1),a("v-tab-item",{attrs:{id:"graph",eager:""}},[t.minion?a("JobsChartCard",{attrs:{minion:t.minion.minion_id}}):t._e()],1),t._l(t.minion.custom_fields,(function(e){return a("v-tab-item",{key:e.name},[a("codemirror",{attrs:{options:t.cmOptions,value:t.yamlRepr(e.value)}})],1)}))],2)],1)],1)},ja=[],Va=a("56b3"),Sa=a.n(Va),Ta=a("8f94"),$a=(a("f4ba"),a("4895"),a("aedd"),a("cbc8"),a("8d70"),a("f9d4"),a("a7be"),a("ced0"),a("efe9"),a("651e")),Da=a.n($a),Oa={name:"MinionDetailCard",components:{JobsTable:Zt,JobsChartCard:Vt,codemirror:Ta["codemirror"]},data:function(){return{tab:null,code:Da.a.safeDump(JSON.parse(this.minion.grain)),codepillar:Da.a.safeDump(JSON.parse(this.minion.pillar)),grainCmFolded:!1,pillarCmFolded:!1,cmOptions:{tabSize:4,mode:"yaml",theme:"made-of-code",line:!0,autoRefresh:!0,lineNumbers:!1,readOnly:!0,cursorBlinkRate:0,foldGutter:!0,gutters:["CodeMirror-foldgutter"]}}},methods:{yamlRepr:function(t){return Da.a.safeDump(JSON.parse(t))},fold:function(t){!0===this[t+"Folded"]?(Sa.a.commands.unfoldAll(this.$refs[t].codemirror),this[t+"Folded"]=!1):(Sa.a.commands.foldAll(this.$refs[t].codemirror),this[t+"Folded"]=!0)}},props:["minion"]},Ea=Oa,Aa=(a("15fa"),Object(h["a"])(Ea,wa,ja,!1,null,"107b300f",null)),Ia=Aa.exports;function Ra(t){var e=JSON.parse(t.grain);for(var a in e)t[a]=e[a];return t}f()(Aa,{VBtn:g["a"],VCard:y["a"],VContainer:ht["a"],VTab:da["a"],VTabItem:ha["a"],VTabs:ma["a"],VTabsItems:fa["a"],VTabsSlider:va["a"]});var Pa={name:"MinionDetail",components:{Fab:Ne,MinionDetailCard:Ia,InfosCard:ba,NetworkCard:Ca},data:function(){return{minion:null,fabs:[{color:"blue",action:"refreshMinion",icon:"refresh",tooltip:"Refresh "+this.minion_id},{color:"purple",action:"runMinion",icon:"play_arrow",tooltip:"Run job on "+this.minion_id},{color:"orange",action:"highstateMinion",icon:"all_inclusive",tooltip:"Run highstate on "+this.minion_id}]}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;this.$http.get("api/minions/"+this.minion_id+"/").then((function(e){return t.minion=Ra(e.data)}))},fabAction:function(t){this[t]()},refreshMinion:function(){var t=this;this.$toast("refreshing "+this.minion_id);var e=new FormData;e.set("minion_id",this.minion_id),this.$http.post("/api/minions/refresh_minions/",e).then((function(){t.$toast("minion refreshed")})).catch((function(e){t.$toast.error(e.response.data)}))},runMinion:function(){this.$router.push("/run?tgt="+this.minion_id)},highstateMinion:function(){this.$router.push("/run?tgt="+this.minion_id+"&fun=state.apply")}},props:["minion_id"]},Fa=Pa,Ma=Object(h["a"])(Fa,ra,ia,!1,null,"02429c3a",null),La=Ma.exports;f()(Ma,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var Na=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"4"}},[a("v-container",[a("v-card",[a("v-list-item",{attrs:{"two-line":""}},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"headline"},[t._v(t._s(t.job.fun))]),a("v-list-item-subtitle",[t._v("Run on "+t._s(t.formatDate(t.job.alter_time)))])],1)],1),a("v-divider"),a("v-simple-table",[a("tbody",[a("tr",[a("td",[t._v("MINION ID:")]),a("td",{staticClass:"text-right"},[a("v-btn",{staticClass:"pr-0 text-none",attrs:{text:"",small:"",to:"/minions/"+t.job.id}},[t._v(t._s(t.job.id))])],1)]),a("tr",[a("td",[t._v("JOB ID:")]),a("td",{staticClass:"text-right"},[a("v-btn",{staticClass:"pr-0",attrs:{text:"",small:"",to:"/jobs/"+t.job.jid}},[t._v(t._s(t.job.jid))])],1)]),a("tr",[a("td",[t._v("FUNCTION:")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.job.fun))])]),t.job.arguments?a("tr",[a("td",[t._v("ARGUMENTS:")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.job.arguments))])]):t._e(),t.job.keyword_arguments?a("tr",[a("td",[t._v("KEYWORD ARGUMENTS:")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.job.keyword_arguments))])]):t._e(),a("tr",[a("td",[t._v("STATUS:")]),a("td",{staticClass:"text-right"},[a("v-chip",{attrs:{color:t.boolRepr(t.job.success),dark:""}},[t._v(t._s(t.boolText(t.job.success)))])],1)]),a("tr",[a("td",[t._v("START TIME:")]),a("td",{staticClass:"text-right"},[t._v(t._s(new Date(t.job.alter_time).toLocaleString("en-GB")))])])])])],1)],1)],1),a("v-col",{attrs:{sm:"12",lg:"8"}},[a("v-container",[a("v-card",[a("v-card-title",[t._v("Results")]),a("v-divider"),a("div",{staticClass:"ansiStyle",domProps:{innerHTML:t._s(t.ansiResult)}})],1)],1)],1)],1)],1)},Ja=[],Ua={name:"JobDetail",props:["jid","minion_id"],data:function(){return{job:{},ansiResult:null}},mounted:function(){this.loadData(),this.loadRenderedJob()},methods:{loadData:function(){var t=this;this.$http.get("api/jobs/".concat(this.jid,"/").concat(this.minion_id,"/")).then((function(e){return t.job=e.data}))},loadRenderedJob:function(){var t=this;this.$http.get("api/jobs/".concat(this.jid,"/").concat(this.minion_id,"/rendered_state/")).then((function(e){return t.ansiResult=e.data}))},boolRepr:function(t){return!0===t?"green":"red"},boolText:function(t){return!0===t?"success":"failed"},formatDate:function(t){return new Date(t).toLocaleString("en-GB")}}},za=Ua,qa=(a("0122"),Object(h["a"])(za,Na,Ja,!1,null,"57350906",null)),Ba=qa.exports;f()(qa,{VBtn:g["a"],VCard:y["a"],VCardTitle:k["c"],VChip:Ot["a"],VCol:Lt["a"],VContainer:ht["a"],VDivider:C["a"],VListItem:S["a"],VListItemContent:D["a"],VListItemSubtitle:D["b"],VListItemTitle:D["c"],VRow:Nt["a"],VSimpleTable:mt["a"]});var Ha=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("EventsTable")],1)],1)],1)},Ka=[],Ga=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v(" Events "),a("v-spacer"),a("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"alter_time","sort-desc":"",headers:t.headers,items:t.events,search:t.search,"show-expand":"",loading:t.loading},scopedSlots:t._u([{key:"item.alter_time",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Date(a.alter_time).toLocaleString("en-GB"))+" ")]}},{key:"expanded-item",fn:function(e){var n=e.headers,s=e.item;return[a("td",{attrs:{colspan:n.length}},[a("pre",[t._v(t._s(JSON.stringify(t.safeParse(s.data),null,2)))])])]}}])})],1)],1)},Wa=[];function Ya(t){return t.forEach((function(t){var e=JSON.parse(t.data);for(var a in e)"id"===a?t["minion_id"]=e[a]:t[a]=e[a]})),t}var Xa={name:"EventsTable",data:function(){return{search:"",headers:[{text:"Tag",value:"tag"},{text:"Jid",value:"jid"},{text:"Target",value:"minion_id"},{text:"Function",value:"fun"},{text:"Arguments",value:"fun_args"},{text:"Date",value:"alter_time"}],events:[],loading:!0}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;this.$http.get("api/events/").then((function(e){t.events=Ya(e.data),t.loading=!1}))},safeParse:function(t){var e;try{e=JSON.parse(t)}catch(a){return{}}return e}}},Qa=Xa,Za=Object(h["a"])(Qa,Ga,Wa,!1,null,"0929ee45",null),tn=Za.exports;f()(Za,{VCard:y["a"],VCardTitle:k["c"],VContainer:ht["a"],VDataTable:Yt["a"],VSpacer:A["a"],VTextField:I["a"]});var en={name:"Events",components:{EventsTable:tn}},an=en,nn=Object(h["a"])(an,Ha,Ka,!1,null,"7408d9dd",null),sn=nn.exports;f()(nn,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var rn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("RunCard")],1)],1)],1)},on=[],ln=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{sm:"12"}},[a("v-card",{staticClass:"mb-8"},[a("v-card-title",[t._v("Run")]),a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#formatted"}},[t._v(" Formatted ")]),a("v-tab",{attrs:{href:"#cli"}},[t._v(" Cli ")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"formatted",eager:""}},[a("v-card",[a("v-spacer"),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{staticClass:"text-right",attrs:{sm:"3",lg:"1","align-self":"center"}},[a("span",[t._v("Client Type:")])]),a("v-col",{attrs:{sm:"3",lg:"1"}},[a("v-select",{attrs:{items:t.client},model:{value:t.selected_client,callback:function(e){t.selected_client=e},expression:"selected_client"}})],1),t.client_batch||t.scheduleSwitch?t._e():a("v-col",{attrs:{sm:"3",lg:"1","offset-lg":"1"}},[a("v-checkbox",{attrs:{label:"Async",color:"primary"},model:{value:t.client_async,callback:function(e){t.client_async=e},expression:"client_async"}})],1),"local"!==t.selected_client||t.scheduleSwitch?t._e():a("v-col",{attrs:{sm:"3",lg:"1","offset-lg":t.client_batch?3:1}},[a("v-checkbox",{attrs:{label:"Batch",color:"primary"},model:{value:t.client_batch,callback:function(e){t.client_batch=e},expression:"client_batch"}})],1),"local"===t.selected_client&&t.client_batch&&!t.scheduleSwitch?a("v-col",{attrs:{sm:"3",lg:"1"}},[a("v-text-field",{attrs:{label:"Batch"},model:{value:t.batch,callback:function(e){t.batch=e},expression:"batch"}})],1):t._e(),"local"!==t.selected_client||t.scheduleSwitch?t._e():a("v-col",{attrs:{sm:"3",lg:"1","offset-lg":t.client_batch?0:1}},[a("v-text-field",{attrs:{label:"Timeout",type:"number"},model:{value:t.timeout,callback:function(e){t.timeout=e},expression:"timeout"}})],1)],1),a("v-row",[a("v-col",{attrs:{lg:"1"}},["local"===t.selected_client?a("v-select",{attrs:{items:t.target_type,label:"Target Type"},on:{change:function(e){t.target=null}},model:{value:t.selected_target_type,callback:function(e){t.selected_target_type=e},expression:"selected_target_type"}}):t._e()],1),a("v-col",{attrs:{lg:"2"}},["local"===t.selected_client?a("v-text-field",{attrs:{label:"Target"},model:{value:t.target,callback:function(e){t.target=e},expression:"target"}}):t._e()],1),a("v-col",{attrs:{lg:"2"}},[a("v-combobox",{attrs:{"item-value":"name","item-text":"name",items:t.filteredFunction,label:"Function","return-object":""},scopedSlots:t._u([t.selectedFunction?{key:"append-outer",fn:function(){return[a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-icon",t._g({attrs:{color:"black"}},n),[t._v("info ")])]}}],null,!1,3591029852)},[a("div",{staticClass:"desc"},[a("pre",[t._v(t._s(t.selectedFunction.description))])])])]},proxy:!0}:null],null,!0),model:{value:t.selectedFunction,callback:function(e){t.selectedFunction=e},expression:"selectedFunction"}})],1),a("v-col",{attrs:{lg:"3"}},[a("v-text-field",{attrs:{label:"Arguments"},model:{value:t.arg,callback:function(e){t.arg=e},expression:"arg"}})],1),a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Keyword Arguments"},model:{value:t.kwarg,callback:function(e){t.kwarg=e},expression:"kwarg"}})],1)],1),a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{sm:"12",lg:"3"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{sm:"12"}},[a("v-switch",{directives:[{name:"show",rawName:"v-show",value:"local"===t.selected_client,expression:"selected_client === 'local'"}],attrs:{label:"Schedule",color:"primary"},model:{value:t.scheduleSwitch,callback:function(e){t.scheduleSwitch=e},expression:"scheduleSwitch"}})],1),a("v-col",{directives:[{name:"show",rawName:"v-show",value:t.scheduleSwitch,expression:"scheduleSwitch"}],attrs:{sm:"12"}},[a("v-text-field",{staticStyle:{width:"350px"},attrs:{label:"Schedule Name"},model:{value:t.scheduleName,callback:function(e){t.scheduleName=e},expression:"scheduleName"}}),a("v-radio-group",{staticClass:"mt-0",model:{value:t.scheduleType,callback:function(e){t.scheduleType=e},expression:"scheduleType"}},[a("v-radio",{attrs:{value:"once",color:"primary"},scopedSlots:t._u([{key:"label",fn:function(){return[a("span",[a("strong",[t._v("Once: ")])]),a("v-row",[a("v-col",{staticClass:"ml-2",attrs:{sm:"4"}},[a("v-menu",{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-text-field",t._g({attrs:{readonly:""},model:{value:t.scheduleDate,callback:function(e){t.scheduleDate=e},expression:"scheduleDate"}},n))]}}]),model:{value:t.dateMenu,callback:function(e){t.dateMenu=e},expression:"dateMenu"}},[a("v-date-picker",{attrs:{min:t.scheduleDate},on:{input:function(e){t.dateMenu=!1}},model:{value:t.scheduleDate,callback:function(e){t.scheduleDate=e},expression:"scheduleDate"}})],1)],1),a("v-col",{attrs:{sm:"4"}},[a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-text-field",t._g({attrs:{readonly:""},model:{value:t.scheduleTime,callback:function(e){t.scheduleTime=e},expression:"scheduleTime"}},n))]}}]),model:{value:t.timeMenu,callback:function(e){t.timeMenu=e},expression:"timeMenu"}},[t.timeMenu?a("v-time-picker",{attrs:{"full-width":""},model:{value:t.scheduleTime,callback:function(e){t.scheduleTime=e},expression:"scheduleTime"}}):t._e()],1)],1)],1)]},proxy:!0}])}),a("v-radio",{attrs:{value:"recurring",color:"primary"},scopedSlots:t._u([{key:"label",fn:function(){return[a("div",[a("strong",[t._v("Recurring: ")]),t._v(" Every "),a("span",{attrs:{id:"cron"}})])]},proxy:!0}])})],1)],1)],1)],1),a("v-col",{attrs:{sm:"12",lg:"6"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{sm:"12"}},[a("v-switch",{directives:[{name:"show",rawName:"v-show",value:"local"===t.selected_client,expression:"selected_client === 'local'"}],attrs:{label:"Pillar",color:"primary"},model:{value:t.pillarSwitch,callback:function(e){t.pillarSwitch=e},expression:"pillarSwitch"}})],1),a("v-col",{directives:[{name:"show",rawName:"v-show",value:t.pillarSwitch,expression:"pillarSwitch"}],attrs:{sm:"12"}},[a("codemirror",{attrs:{options:t.cmOptions},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),a("v-col",{directives:[{name:"show",rawName:"v-show",value:t.pillarSwitch,expression:"pillarSwitch"}],attrs:{sm:"12"}},[a("span",{domProps:{innerHTML:t._s(t.pillarRendered)}})])],1)],1),a("v-col",{attrs:{sm:"12",lg:"3"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{sm:"12"}},[a("v-switch",{attrs:{label:"Save as template",color:"primary"},model:{value:t.saveJobSwitch,callback:function(e){t.saveJobSwitch=e},expression:"saveJobSwitch"}})],1),a("v-col",{directives:[{name:"show",rawName:"v-show",value:t.saveJobSwitch,expression:"saveJobSwitch"}],attrs:{sm:"12"}},[a("v-text-field",{staticStyle:{width:"350px"},attrs:{label:"Job Template Name"},model:{value:t.jobTemplateName,callback:function(e){t.jobTemplateName=e},expression:"jobTemplateName"}})],1)],1)],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!t.saveJobSwitch,expression:"!saveJobSwitch"}],attrs:{color:"orange",large:"",dark:""},on:{click:function(e){return t.runJob(t.test=!0)}}},[t._v("Test")]),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!t.saveJobSwitch,expression:"!saveJobSwitch"}],attrs:{color:"info",large:"",dark:""},on:{click:t.runJob}},[t._v("Run")]),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.saveJobSwitch,expression:"saveJobSwitch"}],attrs:{color:"green",large:"",dark:""},on:{click:t.saveJob}},[t._v("Save")])],1)],1)],1),a("v-tab-item",{attrs:{id:"cli"}},[null!==t.functions?a("TerminalCard",{attrs:{minions:t.minions,functions:t.functions}}):t._e()],1)],1)],1)],1)],1),a("v-row",[a("v-col",{attrs:{sm:"12"}},[t.results?a("v-card",[a("v-card-title",[t._v("Results")]),a("v-card-text",{staticClass:"ansiStyle",domProps:{innerHTML:t._s(t.results)}})],1):t._e()],1)],1)],1)},cn=[],un=(a("fb6a"),a("accc"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-row",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}]},[a("v-col",{attrs:{sm:"12"}},[a("div",{staticClass:"console",attrs:{id:"terminal"}})])],1)}),dn=[],hn=a("fcf3"),mn=a("47d0"),fn=(a("abb2"),a("c740"),a("a630"),a("4e827"),a("3ca3"),a("38cf"),a("d4ec")),vn=a("bee2"),pn=(a("498a"),function(){function t(e){Object(fn["a"])(this,t),this.size=e,this.entries=[],this.cursor=0}return Object(vn["a"])(t,[{key:"push",value:function(t){if(""!==t.trim()){var e=this.entries[this.entries.length-1];t!=e&&(this.entries.push(t),this.entries.length>this.size&&this.entries.pop(0),this.cursor=this.entries.length)}}},{key:"rewind",value:function(){this.cursor=this.entries.length}},{key:"getPrevious",value:function(){var t=Math.max(0,this.cursor-1);return this.cursor=t,this.entries[t]}},{key:"getNext",value:function(){var t=Math.min(this.entries.length,this.cursor+1);return this.cursor=t,this.entries[t]}}]),t}()),bn=(a("7db0"),a("26e9"),a("8a79"),a("466d"),a("2909")),_n=a("8e33");function gn(t){var e,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],s=/\w+/g;while(e=s.exec(t))a?n.push(e.index):n.push(e.index+e[0].length);return n}function yn(t,e){var a=gn(t,!0).reverse().find((function(t){return t<e}));return null==a?0:a}function kn(t,e){var a=gn(t,!1).find((function(t){return t>e}));return null==a?t.length:a}function xn(t,e,a){for(var n=0,s=0,r=0;r<e;++r){var i=t.charAt(r);"\n"==i?(s=0,n+=1):(s+=1,s>a&&(s=0,n+=1))}return{row:n,col:s}}function Cn(t,e){return xn(t,t.length,e).row+1}function wn(t){return""!=t.trim()&&((t.match(/'/g)||[]).length%2!==0||((t.match(/"/g)||[]).length%2!==0||(""==t.split(/(\|\||\||&&)/g).pop().trim()||!(!t.endsWith("\\")||t.endsWith("\\\\")))))}function jn(t){return null!=t.match(/[^\\][ \t]$/m)}function Vn(t){if(""===t.trim())return"";if(jn(t))return"";var e=Object(_n["parse"])(t);return e.pop()||""}function Sn(t,e){var a=Object(_n["parse"])(e),n=a.length-1,s=a[n]||"";""===e.trim()?(n=0,s=""):jn(e)&&(n+=1,s="");var r=t.reduce((function(t,e){var s=e.fn,r=e.args;try{return t.concat(s.apply(void 0,[n,a].concat(Object(bn["a"])(r))))}catch(i){return console.error("Auto-complete error:",i),t}}),[]);return r.filter((function(t){return t.startsWith(s)}))}var Tn=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(fn["a"])(this,t),this.term=e,this._handleTermData=this.handleTermData.bind(this),this._handleTermResize=this.handleTermResize.bind(this),this.history=new pn(a.historySize||100),this.maxAutocompleteEntries=a.maxAutocompleteEntries||100,this._autocompleteHandlers=[],this._active=!1,this._input="",this._cursor=0,this._activePrompt=null,this._activeCharPrompt=null,this._termSize={cols:this.term.cols,rows:this.term.rows},this.attach()}return Object(vn["a"])(t,[{key:"detach",value:function(){this.term.off("data",this._handleTermData),this.term.off("resize",this._handleTermResize)}},{key:"attach",value:function(){this.term.onData(this._handleTermData),this.term.onResize(this._handleTermResize)}},{key:"addAutocompleteHandler",value:function(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),n=1;n<e;n++)a[n-1]=arguments[n];this._autocompleteHandlers.push({fn:t,args:a})}},{key:"removeAutocompleteHandler",value:function(t){var e=this._autocompleteHandlers.findIndex((function(e){return e.fn===t}));-1!==e&&this._autocompleteHandlers.splice(e,1)}},{key:"read",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"> ";return new Promise((function(n,s){e.term.write(t),e._activePrompt={prompt:t,continuationPrompt:a,resolve:n,reject:s},e._input="",e._cursor=0,e._active=!0}))}},{key:"readChar",value:function(t){var e=this;return new Promise((function(a,n){e.term.write(t),e._activeCharPrompt={prompt:t,resolve:a,reject:n}}))}},{key:"abortRead",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"aborted";null==this._activePrompt&&null==this._activeCharPrompt||this.term.write("\r\n"),null!=this._activePrompt&&(this._activePrompt.reject(t),this._activePrompt=null),null!=this._activeCharPrompt&&(this._activeCharPrompt.reject(t),this._activeCharPrompt=null),this._active=!1}},{key:"println",value:function(t){this.print(t+"\n")}},{key:"print",value:function(t){var e=t.replace(/[\r\n]+/g,"\n");this.term.write(e.replace(/\n/g,"\r\n"))}},{key:"printWide",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0==t.length)return println("");for(var a=t.reduce((function(t,e){return Math.max(t,e.length)}),0)+e,n=Math.floor(this._termSize.cols/a),s=Math.ceil(t.length/n),r=0,i=0;i<s;++i){for(var o="",l=0;l<n;++l)if(r<t.length){var c=t[r++];c+=" ".repeat(a-c.length),o+=c}this.println(o)}}},{key:"applyPrompts",value:function(t){var e=(this._activePrompt||{}).prompt||"",a=(this._activePrompt||{}).continuationPrompt||"";return e+t.replace(/\n/g,"\n"+a)}},{key:"applyPromptOffset",value:function(t,e){var a=this.applyPrompts(t.substr(0,e));return a.length}},{key:"clearInput",value:function(){for(var t=this.applyPrompts(this._input),e=Cn(t,this._termSize.cols),a=this.applyPromptOffset(this._input,this._cursor),n=xn(t,a,this._termSize.cols),s=(n.col,n.row),r=e-s-1,i=0;i<r;++i)this.term.write("[E");this.term.write("\r[K");for(i=1;i<e;++i)this.term.write("[F[K")}},{key:"setInput",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this.clearInput();var a=this.applyPrompts(t);this.print(a),this._cursor>t.length&&(this._cursor=t.length);var n=this.applyPromptOffset(t,this._cursor),s=Cn(a,this._termSize.cols),r=xn(a,n,this._termSize.cols),i=r.col,o=r.row,l=s-o-1;this.term.write("\r");for(var c=0;c<l;++c)this.term.write("[F");for(c=0;c<i;++c)this.term.write("[C");this._input=t}},{key:"printAndRestartPrompt",value:function(t){var e=this,a=this._cursor;this.setCursor(this._input.length),this.term.write("\r\n");var n=function(){e._cursor=a,e.setInput(e._input)},s=t();null==s?n():s.then(n)}},{key:"setCursor",value:function(t){t<0&&(t=0),t>this._input.length&&(t=this._input.length);var e=this.applyPrompts(this._input),a=(Cn(e,this._termSize.cols),this.applyPromptOffset(this._input,this._cursor)),n=xn(e,a,this._termSize.cols),s=n.col,r=n.row,i=this.applyPromptOffset(this._input,t),o=xn(e,i,this._termSize.cols),l=o.col,c=o.row;if(c>r)for(var u=r;u<c;++u)this.term.write("[B");else for(var d=c;d<r;++d)this.term.write("[A");if(l>s)for(var h=s;h<l;++h)this.term.write("[C");else for(var m=l;m<s;++m)this.term.write("[D");this._cursor=t}},{key:"handleCursorMove",value:function(t){if(t>0){var e=Math.min(t,this._input.length-this._cursor);this.setCursor(this._cursor+e)}else if(t<0){var a=Math.max(t,-this._cursor);this.setCursor(this._cursor+a)}}},{key:"handleCursorErase",value:function(t){var e=this._cursor,a=this._input;if(t){if(e<=0)return;var n=a.substr(0,e-1)+a.substr(e);this.clearInput(),this._cursor-=1,this.setInput(n,!1)}else{var s=a.substr(0,e)+a.substr(e+1);this.setInput(s)}}},{key:"handleCursorInsert",value:function(t){var e=this._cursor,a=this._input,n=a.substr(0,e)+t+a.substr(e);this._cursor+=t.length,this.setInput(n)}},{key:"handleReadComplete",value:function(){this.history&&this.history.push(this._input),this._activePrompt&&(this._activePrompt.resolve(this._input),this._activePrompt=null),this.term.write("\r\n"),this._active=!1}},{key:"handleTermResize",value:function(t){var e=t.rows,a=t.cols;this.clearInput(),this._termSize={cols:a,rows:e},this.setInput(this._input,!1)}},{key:"handleTermData",value:function(t){var e=this;if(this._active){if(null!=this._activeCharPrompt)return this._activeCharPrompt.resolve(t),this._activeCharPrompt=null,void this.term.write("\r\n");if(t.length>3&&27!==t.charCodeAt(0)){var a=t.replace(/[\r\n]+/g,"\r");Array.from(a).forEach((function(t){return e.handleData(t)}))}else this.handleData(t)}}},{key:"handleData",value:function(t){var e=this;if(this._active){var a,n=t.charCodeAt(0);if(27==n)switch(t.substr(1)){case"[A":if(this.history){var s=this.history.getPrevious();s&&(this.setInput(s),this.setCursor(s.length))}break;case"[B":if(this.history){var r=this.history.getNext();r||(r=""),this.setInput(r),this.setCursor(r.length)}break;case"[D":this.handleCursorMove(-1);break;case"[C":this.handleCursorMove(1);break;case"[3~":this.handleCursorErase(!1);break;case"[F":this.setCursor(this._input.length);break;case"[H":this.setCursor(0);break;case"b":a=yn(this._input,this._cursor),null!=a&&this.setCursor(a);break;case"f":a=kn(this._input,this._cursor),null!=a&&this.setCursor(a);break;case"":a=yn(this._input,this._cursor),null!=a&&(this.setInput(this._input.substr(0,a)+this._input.substr(this._cursor)),this.setCursor(a));break}else if(n<32||127===n)switch(t){case"\r":wn(this._input)?this.handleCursorInsert("\n"):this.handleReadComplete();break;case"":this.handleCursorErase(!0);break;case"\t":if(this._autocompleteHandlers.length>0){var i=this._input.substr(0,this._cursor),o=jn(i),l=Sn(this._autocompleteHandlers,i);if(l.sort(),0===l.length)o||this.handleCursorInsert(" ");else if(1===l.length){var c=Vn(i);this.handleCursorInsert(l[0].substr(c.length)+" ")}else l.length<=this.maxAutocompleteEntries?this.printAndRestartPrompt((function(){e.printWide(l)})):this.printAndRestartPrompt((function(){return e.readChar("Display all ".concat(l.length," possibilities? (y or n)")).then((function(t){"y"!=t&&"Y"!=t||e.printWide(l)}))}))}else this.handleCursorInsert("    ");break;case"":this.setCursor(this._input.length),this.term.write("^C\r\n"+((this._activePrompt||{}).prompt||"")),this._input="",this._cursor=0,this.history&&this.history.rewind();break}else this.handleCursorInsert(t)}}}]),t}(),$n={name:"TerminalCard",props:["minions","functions"],data:function(){return{term:null,fitter:null,functions_name:null}},methods:{initTerm:function(){var t=this,e=document.getElementById("terminal");this.term=new hn["Terminal"]({cursorBlink:!0,fontSize:20,fontFamily:"'Roboto Mono', monospace"});var a=new mn["FitAddon"];this.term.loadAddon(a),this.term.open(e),a.fit(),this.fitter=a;var n=new Tn(this.term);n.addAutocompleteHandler((function(t){return 0!==t?[]:["salt","clear"]})),n.addAutocompleteHandler((function(e){return 1!==e?[]:t.minions})),n.addAutocompleteHandler((function(e){return 2!==e?[]:t.functions.map((function(t){return t.name}))}));var s="Usage: salt [options] '<target>' <function> [arguments]",r=function e(){n.read(" ~$ ").then((function(a){var r=a.split(" ").filter((function(t){return""!==t}));if(0===r.length)e();else if(1===r.length&&"clear"===r[0])t.term.clear(),e();else if(r.length<=2)n.println(s),e();else if(a.split(" ").length>=3&&"salt"===r[0]){var i=new FormData;i.set("raw",!0),i.set("cli",!0),i.set("command",a),t.$toast("Running "+a),t.$http.post("api/run/",i).then((function(t){n.println(t.data.results)})).then((function(){return e()})).catch((function(e){t.$toast.error(e.response.data)})).then((function(){return e()}))}else n.println(s),e()}))};r()},onResize:function(){null!==this.term&&this.fitter.fit()}},mounted:function(){var t=this;setTimeout((function(){t.initTerm()}),100)},beforeDestroy:function(){null!==this.term&&this.term.dispose()}},Dn=$n,On=a("269a"),En=a.n(On),An=a("dc22"),In=Object(h["a"])(Dn,un,dn,!1,null,"2ed3c4a0",null),Rn=In.exports;f()(In,{VCol:Lt["a"],VRow:Nt["a"]}),En()(In,{Resize:An["a"]});a("e25e");function Pn(t,e){if(t instanceof HTMLElement)this.el=t;else{if("string"!==typeof t)throw"CronUI: container parameter in initialization must be an html element or a string selector.";this.el=document.querySelector(t)}this.options=e||{},this.render(),"string"!==typeof this.options.initial&&(this.options.initial="* * * * *"),this.setCronString(this.options.initial),this.currentValue=this.options.initial}Pn.prototype.render=function(){var t,e,a,n=this.el,s="";for(a=0;a<60;a++)e=a<10?"0":"",s+="<option value='"+a+"'>"+e+a+"</option>\n";var r="";for(a=0;a<24;a++)e=a<10?"0":"",r+="<option value='"+a+"'>"+e+a+"</option>\n";var i="";for(a=1;a<32;a++)t=1==a||21==a||31==a?"st":2==a||22==a?"nd":3==a||23==a?"rd":"th",i+="<option value='"+a+"'>"+a+t+"</option>\n";var o="",l=["January","February","March","April","May","June","July","August","September","October","November","December"];for(a=0;a<l.length;a++)o+="<option value='"+(a+1)+"'>"+l[a]+"</option>\n";var c="",u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(a=0;a<u.length;a++)c+="<option value='"+a+"'>"+u[a]+"</option>\n";var d="",h=["minute","hour","day","week","month","year"];for(a=0;a<h.length;a++)d+="<option value='"+h[a]+"'>"+h[a]+"</option>\n";var m={};n.insertAdjacentHTML("beforeend","<span class='cron-period'><select>"+d+"</select></span>");var f=n.querySelector(".cron-period select");for(var v in f.addEventListener("change",this.periodChanged.bind(this)),f.addEventListener("change",this.changeEvent.bind(this)),n.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-dom'> on the <select name='cron-dom'>"+i+"</select> </span>"),m["dom"]=n.querySelector(".cron-block-dom"),n.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-month'> of <select name='cron-month'>"+o+"</select> </span>"),m["month"]=n.querySelector(".cron-block-month"),n.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-mins'> at <select name='cron-mins'>"+s+"</select> minutes past the hour </span>"),m["mins"]=n.querySelector(".cron-block-mins"),n.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-dow'> on <select name='cron-dow'>"+c+"</select> </span>"),m["dow"]=n.querySelector(".cron-block-dow"),n.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-time'> at <select name='cron-time-hour' class='cron-time-hour'>"+r+"</select>:<select name='cron-time-min' class='cron-time-min'>"+s+" </span>"),m["time"]=n.querySelector(".cron-block-time"),m)[].forEach.call(m[v].querySelectorAll("select"),function(t){t.addEventListener("change",this.changeEvent.bind(this))}.bind(this));this.blocks=m},Pn.prototype.periodChanged=function(){var t=this.blocks,e=this.el.querySelector(".cron-period select"),a=e.options[e.selectedIndex].value;for(var n in t)t[n].style.display="none";if(Pn.displayMatrix.hasOwnProperty(a))for(var s=Pn.displayMatrix[a],r=0;r<s.length;r++)t[s[r]].style.display=""},Pn.prototype.changeEvent=function(){this.currentValue=this.getCronString(),"function"===typeof this.options.changeEvent&&this.options.changeEvent(this.currentValue)},Pn.prototype.getCronString=function(){var t,e,a,n,s;t=e=a=n=s="*";var r=this.blocks,i=function(t){return t.options[t.selectedIndex].value},o=i(this.el.querySelector(".cron-period select"));switch(o){case"minute":break;case"hour":t=i(r["mins"].querySelector("select"));break;case"day":t=i(r["time"].querySelector(".cron-time-min")),e=i(r["time"].querySelector(".cron-time-hour"));break;case"week":t=i(r["time"].querySelector(".cron-time-min")),e=i(r["time"].querySelector(".cron-time-hour")),s=i(r["dow"].querySelector("select"));break;case"month":t=i(r["time"].querySelector(".cron-time-min")),e=i(r["time"].querySelector(".cron-time-hour")),a=i(r["dom"].querySelector("select"));break;case"year":t=i(r["time"].querySelector(".cron-time-min")),e=i(r["time"].querySelector(".cron-time-hour")),a=i(r["dom"].querySelector("select")),n=i(r["month"].querySelector("select"));break;default:return o}return[t,e,a,n,s].join(" ")},Pn.prototype.setCronString=function(t){var e=this.blocks,a=Pn.getCronType(t);if(!a)return!1;for(var n=t.split(" "),s={mins:n[0],hour:n[1],dom:n[2],month:n[3],dow:n[4]},r=Pn.displayMatrix[a],i=0;i<r.length;i++){var o=r[i];"time"==o?(e[o].querySelector(".cron-time-hour").value=s["hour"],e[o].querySelector(".cron-time-min").value=s["mins"]):e[o].querySelector("select").value=s[o]}return this.el.querySelector(".cron-period select").value=a,this.periodChanged(),this},Pn.displayMatrix={minute:[],hour:["mins"],day:["time"],week:["dow","time"],month:["dom","time"],year:["dom","month","time"]},Pn.cronTypes={minute:/^(\*\s){4}\*$/,hour:/^\d{1,2}\s(\*\s){3}\*$/,day:/^(\d{1,2}\s){2}(\*\s){2}\*$/,week:/^(\d{1,2}\s){2}(\*\s){2}\d{1,2}$/,month:/^(\d{1,2}\s){3}\*\s\*$/,year:/^(\d{1,2}\s){4}\*$/},Pn.getCronType=function(t){t=t||this.getCronString();var e=/^((\d{1,2}|\*)\s){4}(\d{1,2}|\*)$/;if("string"==typeof t&&e.test(t)){for(var a=t.split(" "),n=[0,0,1,1,0],s=[59,23,31,12,6],r=0;r<a.length;r++)if("*"!=a[r]){var i=parseInt(a[r]);if(!(i<=s[r]&&i>=n[r]))return}for(var o in Pn.cronTypes)if(Pn.cronTypes[o].test(t))return o}};var Fn=Pn,Mn={name:"RunCard",components:{TerminalCard:Rn,codemirror:Ta["codemirror"]},data:function(){return{scheduleSwitch:!1,pillarSwitch:!1,saveJobSwitch:!1,jobTemplateName:"",code:"# Type valid yaml to override pillars\n\n\n",cmOptions:{tabSize:4,mode:"yaml",theme:"made-of-code",line:!0,autoRefresh:!0,lineNumbers:!1,foldGutter:!0,gutters:["CodeMirror-foldgutter"]},tab:null,client:[{text:"Local",value:"local"},{text:"Runner",value:"runner"},{text:"Wheel",value:"wheel"}],selected_client:"local",client_async:!1,client_batch:!1,minions:[],functions:null,selectedFunction:null,description:null,batch:null,timeout:null,target_type:[{text:"glob",value:"glob"},{text:"pcre",value:"--pcre"},{text:"list",value:"--list"},{text:"grain",value:"--grain"},{text:"grain_pcre",value:"--grain-pcre"},{text:"pillar",value:"--pillar"},{text:"pillar_pcre",value:"--pillar-pcre"},{text:"range",value:"--range"},{text:"compound",value:"--compound"},{text:"nodegroup",value:"--nodegroup"}],selected_target_type:"glob",target:"",arg:"",kwarg:"",results:"",termKey:0,cron:null,dateMenu:!1,timeMenu:!1,scheduleType:null,scheduleDate:(new Date).toISOString().substr(0,10),scheduleTime:(new Date).toISOString().substr(11,11).split(":").slice(0,-1).join(":"),scheduleName:null}},methods:{loadData:function(){var t=this;this.$http.get("api/functions/").then((function(e){t.functions=e.data})),this.$http.get("api/minions/").then((function(e){e.data.forEach((function(e){return t.minions.push(e.minion_id)}))}))},createCommand:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e="salt --client=".concat(this.client_batch?"local_batch":this.selected_client).concat(this.client_async&&!this.client_batch?"_async":"");return"local"===this.selected_client&&("glob"!==this.selected_target_type?e+=" "+this.selected_target_type+" "+this.target:e+=" "+this.target),this.selectedFunction&&this.selectedFunction.hasOwnProperty("name")?e+=" ".concat(this.selectedFunction.name):e+=" ".concat(this.selectedFunction),e+="".concat(this.arg?" ".concat(this.arg):"").concat(!0===t?" test=True":"").concat(this.kwarg?" ".concat(this.kwarg):""),e+="".concat(this.pillarSwitch?" pillar='".concat(this.pillarRendered,"'"):""),e+="".concat(this.client_batch&&this.batch?" -b ".concat(this.batch):"").concat(this.timeout?" -t ".concat(this.timeout):""),e},saveJob:function(){var t=this,e=new FormData,a=this.createCommand(!1);e.set("name",this.jobTemplateName),e.set("job",a),this.$http.post("api/job_templates/",e).then((function(e){t.$toast("Template "+t.jobTemplateName+" saved")}))},runJob:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a="Running",n=new FormData,s=this.createCommand(e);n.set("raw",!0),n.set("command",s),this.scheduleSwitch&&this.scheduleType&&(a="Scheduling",n.set("schedule_type",this.scheduleType),this.scheduleName&&n.set("schedule_name",this.scheduleName),"once"===this.scheduleType?n.set("schedule",this.scheduleDate+" "+this.scheduleTime+":00"):n.set("cron",this.cron.currentValue)),this.$toast(a+" "+s),this.$http.post("api/run/",n).then((function(e){var a=e.data;if(t.client_async&&"local"===t.selected_client){for(var n=new DOMParser,s=n.parseFromString(a,"text/html"),r=s.getElementsByClassName("ansi2html-content")[0].children,i=r[r.length-1].innerText,o=1;o<r.length-2;o++){var l=document.createElement("a"),c=document.createTextNode(r[o].innerText);l.appendChild(c),l.title="Async result to job for ".concat(r[o].innerText.replace("- ","")),l.href="/#/jobs/".concat(i,"/").concat(r[o].innerText.replace("- ","")),r[o].innerHTML="",r[o].appendChild(l)}a=(new XMLSerializer).serializeToString(s)}t.results=a+t.results})).catch((function(e){t.$toast.error(e.response.data)}))}},computed:{filteredFunction:function(){var t=this;if(null!==this.functions)return this.functions.filter((function(e){return e.type===t.selected_client}))},pillarRendered:function(){return"".concat(JSON.stringify(null===Da.a.safeLoad(this.code)?{}:Da.a.safeLoad(this.code)))}},mounted:function(){var t=this;if(this.cron=new Fn("#cron",{initial:"* * * * *"}),this.loadData(),this.$route.query.client&&(this.selected_client=this.$route.query.client.split("_")[0],this.$route.query.client.split("_").length>1&&(this["client_"+this.$route.query.client.split("_")[1]]=!0)),this.$route.query.tgt_type&&this.target_type.forEach((function(e){e.text===t.$route.query.tgt_type&&(t.selected_target_type=e.value)})),this.batch=this.$route.query.batch?this.$route.query.batch:null,this.target=this.$route.query.tgt,this.selectedFunction=!0===this.$route.query.hasOwnProperty("fun")?{name:this.$route.query.fun}:this.selectedFunction,this.arg=this.$route.query.arg,this.$route.query.kwarg){var e=this.$route.query.kwarg.split(" ").filter((function(t){return t.startsWith("pillar")})).join();e?(this.pillarSwitch=!0,this.code=Da.a.dump(JSON.parse(e.split("=")[1])),this.kwarg=this.$route.query.kwarg.split(" ").filter((function(t){return!t.startsWith("pillar")})).join(" ")):this.kwarg=this.$route.query.kwarg}this.$route.query.name&&(this.saveJobSwitch=!0,this.jobTemplateName=this.$route.query.name)}},Ln=Mn,Nn=(a("ad3d"),a("2b5d")),Jn=a("67b6"),Un=a("43a6"),zn=a("b73d"),qn=a("c964"),Bn=Object(h["a"])(Ln,ln,cn,!1,null,"1ddf48ef",null),Hn=Bn.exports;f()(Bn,{VBtn:g["a"],VCard:y["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:k["c"],VCheckbox:Xe["a"],VCol:Lt["a"],VCombobox:Nn["a"],VContainer:ht["a"],VDatePicker:Xt["a"],VIcon:j["a"],VMenu:O["a"],VRadio:Jn["a"],VRadioGroup:Un["a"],VRow:Nt["a"],VSelect:wt["a"],VSpacer:A["a"],VSwitch:zn["a"],VTab:da["a"],VTabItem:ha["a"],VTabs:ma["a"],VTabsItems:fa["a"],VTabsSlider:va["a"],VTextField:I["a"],VTimePicker:qn["b"]});var Kn={name:"Run",components:{RunCard:Hn}},Gn=Kn,Wn=Object(h["a"])(Gn,rn,on,!1,null,"74868f95",null),Yn=Wn.exports;f()(Wn,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var Xn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("CommonSettings")],1)],1),a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("UserSettings")],1)],1)],1)},Qn=[],Zn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Common Settings")]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"4",lg:"2","align-self":"center"}},[t._v(" Parse modules from: ")]),a("v-col",{attrs:{sm:"4",lg:"2"}},[a("v-select",{attrs:{items:t.minions,"item-text":"minion_id","item-value":"minion_id",label:"Target"},model:{value:t.target,callback:function(e){t.target=e},expression:"target"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:null==t.target,color:"primary"},on:{click:t.parseModules}},[t._v("Submit")])],1),a("v-col",{attrs:{sm:"4",lg:"1","align-self":"center"}},[t._v(" Alcali Version: ")]),a("v-col",{attrs:{sm:"4",lg:"2","align-self":"center"}},[a("span",[t._v(t._s(t.version))])])],1),a("v-row",[a("v-col",{attrs:{sm:"12",lg:"6"}},[a("v-row",[t._v("Minions Fields")]),t._l(t.uniqueMinionField,(function(e){return a("v-row",{key:e.name},[a("v-col",{attrs:{lg:"4"}},[a("b",[t._v(t._s(e.name))])]),a("v-col",{attrs:{lg:"4"}},[t._v(t._s(e["function"]))]),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{color:"red",dark:""},on:{click:function(a){return t.deleteMinionsFields(e.name)}}},[t._v("Delete")])],1)],1)})),a("v-row",[a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Name","single-line":""},model:{value:t.minionsfields_name,callback:function(e){t.minionsfields_name=e},expression:"minionsfields_name"}})],1),a("v-col",{attrs:{lg:"4"}},[a("v-combobox",{attrs:{items:t.functions,"item-value":"name","item-text":"name",label:"Functions"},model:{value:t.minionsfields_value,callback:function(e){t.minionsfields_value=e},expression:"minionsfields_value"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:null==t.minionsfields_name||null==t.minionsfields_value,color:"primary"},on:{click:t.createMinionsFields}},[t._v("Create ")])],1)],1)],2),a("v-col",{attrs:{sm:"12",lg:"6"}},[a("v-row",[t._v("Custom Conformity")]),t._l(t.conformity,(function(e){return a("v-row",{key:e.id},[a("v-col",{attrs:{lg:"4"}},[a("b",[t._v(t._s(e.name))])]),a("v-col",{attrs:{lg:"4"}},[t._v(t._s(e.function))]),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{color:"red",dark:""},on:{click:function(a){return t.deleteConformity(e.id)}}},[t._v("Delete")])],1)],1)})),a("v-row",[a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Name","single-line":""},model:{value:t.conformity_name,callback:function(e){t.conformity_name=e},expression:"conformity_name"}})],1),a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Function","single-line":""},model:{value:t.conformity_value,callback:function(e){t.conformity_value=e},expression:"conformity_value"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:null==t.conformity_name||null===t.conformity_value,color:"primary"},on:{click:t.createConformity}},[t._v("Create ")])],1)],1)],2)],1)],1)],1)],1)],1)},ts=[],es={name:"CommonSettings",data:function(){return{version:"unknown",minions:[],target:null,functions:null,minionsfields:[],minionsfields_name:null,minionsfields_value:null,conformity:null,conformity_name:null,conformity_value:null}},mounted:function(){this.loadData()},computed:{uniqueMinionField:function(){if(null!==this.minionsfields)return this.minionsfields.filter((function(t,e,a){return e===a.findIndex((function(e){return e["function"]===t["function"]&&e.name===t.name}))}))}},methods:{loadData:function(){var t=this;this.$http.get("api/keys/").then((function(e){t.minions=e.data.filter((function(t){return"accepted"===t.status}))})),this.$http.get("api/functions/").then((function(e){t.functions=e.data.filter((function(t){return"local"===t.type}))})),this.$http.get("api/conformity/").then((function(e){t.conformity=e.data})),this.$http.get("api/minionsfields/").then((function(e){t.minionsfields=e.data})),this.$http.get("api/version/").then((function(e){t.version=e.data.version}))},parseModules:function(){var t=this;this.$toast("Parse module started");var e=new FormData;e.set("target",this.target),this.$http.post("api/settings/initdb",e).then((function(e){t.$toast(e.data.result)})).then((function(){t.loadData()})).catch((function(e){t.$toast.error(e.response.data)}))},deleteConformity:function(t){var e=this,a=new FormData;a.set("id",t),this.$http.delete("/api/conformity/"+t).then((function(){e.$toast("conformity deleted"),e.conformity.splice(e.conformity.indexOf(t),1)}))},createConformity:function(){var t=this,e=new FormData;e.set("name",this.conformity_name),e.set("function",this.conformity_value),this.$http.post("/api/conformity/",e).then((function(){t.conformity.push({name:t.conformity_name,function:t.conformity_value,id:t.conformity.length+2}),t.$toast("conformity created"),t.conformity_name=null,t.conformity_value=null}))},createMinionsFields:function(){var t=this,e=new FormData;e.set("name",this.minionsfields_name),e.set("function",this.minionsfields_value.name),e.set("value","{}"),this.$http.post("/api/minionsfields/",e).then((function(){t.minionsfields.push({name:t.minionsfields_name,function:t.minionsfields_value.name}),t.$toast("minions fields created"),t.minionsfields_name=null,t.minionsfields_value=null}))},deleteMinionsFields:function(t){var e=this,a=new FormData;a.set("name",t),this.$http.post("/api/minionsfields/delete_field/",a).then((function(a){e.$toast(a.data.result),e.minionsfields=e.minionsfields.filter((function(e){return e.name!==t}))}))}}},as=es,ns=Object(h["a"])(as,Zn,ts,!1,null,"8144315a",null),ss=ns.exports;f()(ns,{VBtn:g["a"],VCard:y["a"],VCardText:k["b"],VCardTitle:k["c"],VCol:Lt["a"],VCombobox:Nn["a"],VContainer:ht["a"],VRow:Nt["a"],VSelect:wt["a"],VTextField:I["a"]});var rs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("User Settings")]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{lg:"2"}},[a("span",[t._v("Jobs Notifications")]),t._l(t.notifs,(function(e,n){return a("div",{key:n},[a("v-switch",{attrs:{label:n,color:"primary","hide-details":""},model:{value:t.notifs[n],callback:function(e){t.$set(t.notifs,n,e)},expression:"notifs[name]"}})],1)}))],2),a("v-col",{attrs:{lg:"2"}},[a("span",[t._v("Max Notifications")]),a("v-text-field",{attrs:{type:"number"},model:{value:t.max_notifs,callback:function(e){t.max_notifs=e},expression:"max_notifs"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:t.updateUserSettings}},[t._v("Submit")])],1)],1)],1)},is=[],os={name:"UserSettings",data:function(){return{switch1:!0,switch2:!1,notifs:{created:!1,published:!0,returned:!1,event:!1},settings:null,max_notifs:null}},methods:{loadData:function(){var t=this;this.$http.get("api/userssettings/"+this.$store.getters.user_id+"/").then((function(e){t.settings=e.data,t.max_notifs=e.data.max_notifs,Object.keys(t.notifs).forEach((function(e){t.notifs[e]=t.settings["notifs_"+e]}))}))},updateUserSettings:function(){var t=this,e={max_notifs:this.max_notifs};Object.keys(this.notifs).forEach((function(a){e["notifs_"+a]=t.notifs[a]})),this.$http.patch("api/userssettings/"+this.$store.getters.user_id+"/",e).then((function(e){t.$toast("user settings updated")}))}},mounted:function(){this.loadData()}},ls=os,cs=Object(h["a"])(ls,rs,is,!1,null,"d85a6514",null),us=cs.exports;f()(cs,{VBtn:g["a"],VCard:y["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:k["c"],VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"],VSpacer:A["a"],VSwitch:zn["a"],VTextField:I["a"]});var ds={name:"Settings",components:{UserSettings:us,CommonSettings:ss}},hs=ds,ms=Object(h["a"])(hs,Xn,Qn,!1,null,"ef54e078",null),fs=ms.exports;f()(ms,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var vs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("ConformityTable")],1)],1)],1)},ps=[],bs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v(" Conformity "),a("v-spacer"),a("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion_id","item-key":"minion_id",headers:t.headers,items:t.conformity,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.minion_id",fn:function(e){var n=e.item;return[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/conformity/"+n.minion_id}},[t._v(t._s(n.minion_id))])]}},{key:"item.last_highstate",fn:function(e){var a=e.item;return[t._v(" "+t._s(null===a.last_highstate?"":new Date(a.last_highstate).toLocaleString("en-GB"))+" ")]}},{key:"item.conformity",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(n.conformity),dark:""}},[t._v(t._s(n.conformity)+" ")])]}},{key:"item.succeeded",fn:function(e){var n=e.item;return[null!=n.succeeded?a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",color:"green","text-color":"base"}},[t._v(" "+t._s(n.succeeded)+" ")]):t._e()]}},{key:"item.unchanged",fn:function(e){var n=e.item;return[null!=n.unchanged?a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",color:"orange","text-color":"base"}},[t._v(" "+t._s(n.unchanged)+" ")]):t._e()]}},{key:"item.failed",fn:function(e){var n=e.item;return[null!=n.failed?a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",color:"red","text-color":"base"}},[t._v(" "+t._s(n.failed)+" ")]):t._e()]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue",tile:"",dark:"",to:"/conformity/"+n.minion_id}},[t._v(" detail ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"orange",tile:"",dark:"",to:"/run?tgt="+n.minion_id+"&fun=state.apply"}},[t._v(" highstate ")])],1)]}}])})],1)],1)},_s=[],gs={name:"ConformityTable",data:function(){return{search:"",headers:[],conformity:[],loading:!0}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;this.$http.get("api/conformity/render/").then((function(e){t.headers=e.data.name,t.headers.push({text:"Actions",value:"action",sortable:!1}),t.conformity=e.data.data,t.loading=!1}))},boolRepr:function(t){return"True"===t?"green":"False"===t?"red":"primary"}}},ys=gs,ks=Object(h["a"])(ys,bs,_s,!1,null,"3b2cd337",null),xs=ks.exports;f()(ks,{VBtn:g["a"],VCard:y["a"],VCardTitle:k["c"],VChip:Ot["a"],VContainer:ht["a"],VDataTable:Yt["a"],VSpacer:A["a"],VTextField:I["a"]});var Cs={name:"Conformity",components:{ConformityTable:xs}},ws=Cs,js=Object(h["a"])(ws,vs,ps,!1,null,"090bf60e",null),Vs=js.exports;f()(js,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var Ss=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"4"}},[a("ConformityCard",{attrs:{minion_id:t.minion_id,conformity:t.conformity,custom_conformity:t.custom_conformity}})],1),a("v-col",{attrs:{sm:"12",lg:"8"}},[a("ConformityDetailCard",{attrs:{succeeded:t.succeeded,unchanged:t.unchanged,failed:t.failed}})],1)],1)],1)},Ts=[],$s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v(" Highstate Conformity "),a("v-spacer"),a("v-checkbox",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.succeeded).length>0,expression:"Object.keys(succeeded).length>0"}],staticClass:"mb-0 mt-0",attrs:{color:"green",label:"Succeeded: "+Object.keys(t.succeeded).length},model:{value:t.succeeded_checkbox,callback:function(e){t.succeeded_checkbox=e},expression:"succeeded_checkbox"}}),a("v-checkbox",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.unchanged).length>0,expression:"Object.keys(unchanged).length>0"}],staticClass:"ml-3 mb-0 mt-0",attrs:{color:"orange",label:"Unchanged: "+Object.keys(t.unchanged).length},model:{value:t.unchanged_checkbox,callback:function(e){t.unchanged_checkbox=e},expression:"unchanged_checkbox"}}),a("v-checkbox",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.failed).length>0,expression:"Object.keys(failed).length>0"}],staticClass:"ml-3 mb-0 mt-0",attrs:{color:"red",label:"Failed: "+Object.keys(t.failed).length},model:{value:t.failed_checkbox,callback:function(e){t.failed_checkbox=e},expression:"failed_checkbox"}})],1),a("v-expansion-panels",t._l(t.succeeded,(function(e,n){return t.succeeded_checkbox?a("v-expansion-panel",{key:n,attrs:{dark:""}},[a("v-expansion-panel-header",{scopedSlots:t._u([{key:"actions",fn:function(){return[a("v-icon",{attrs:{color:"green"}},[t._v("$vuetify.icons.expand")])]},proxy:!0}],null,!0)},[t._v(t._s(n)+" ")]),a("v-expansion-panel-content",{domProps:{innerHTML:t._s(e)}})],1):t._e()})),1),a("v-expansion-panels",t._l(t.unchanged,(function(e,n){return t.unchanged_checkbox?a("v-expansion-panel",{key:n},[a("v-expansion-panel-header",{scopedSlots:t._u([{key:"actions",fn:function(){return[a("v-icon",{attrs:{color:"orange"}},[t._v("$vuetify.icons.expand")])]},proxy:!0}],null,!0)},[t._v(t._s(n)+" ")]),a("v-expansion-panel-content",{domProps:{innerHTML:t._s(e)}})],1):t._e()})),1),a("v-expansion-panels",t._l(t.failed,(function(e,n){return t.failed_checkbox?a("v-expansion-panel",{key:n},[a("v-expansion-panel-header",{scopedSlots:t._u([{key:"actions",fn:function(){return[a("v-icon",{attrs:{color:"red"}},[t._v("$vuetify.icons.expand")])]},proxy:!0}],null,!0)},[t._v(t._s(n)+" ")]),a("v-expansion-panel-content",{domProps:{innerHTML:t._s(e)}})],1):t._e()})),1)],1)],1)},Ds=[],Os={name:"ConformityDetailCard",props:["succeeded","unchanged","failed"],data:function(){return{expand_search:!1,succeeded_checkbox:!0,unchanged_checkbox:!0,failed_checkbox:!0}}},Es=Os,As=(a("cced"),a("cd55")),Is=a("49e2"),Rs=a("c865"),Ps=a("0393"),Fs=Object(h["a"])(Es,$s,Ds,!1,null,"69fc5fbb",null),Ms=Fs.exports;f()(Fs,{VCard:y["a"],VCardTitle:k["c"],VCheckbox:Xe["a"],VContainer:ht["a"],VExpansionPanel:As["a"],VExpansionPanelContent:Is["a"],VExpansionPanelHeader:Rs["a"],VExpansionPanels:Ps["a"],VIcon:j["a"],VSpacer:A["a"]});var Ls=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v(t._s(t.minion_id))]),a("v-simple-table",[a("tbody",[a("tr",[a("td",[t._v("Highstate")]),a("td",{staticClass:"text-right"},[a("v-chip",{attrs:{color:t.boolRepr(t.conformity),dark:""}},[t._v(t._s(t._f("capitalize")(t.valRepr(t.conformity))))])],1)])]),t._l(t.custom_conformity,(function(e){return a("tbody",{key:e.key},t._l(e,(function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),a("td",{staticClass:"text-right"},[t.isBool(e)?a("v-chip",{attrs:{color:t.boolRepr(t.conformity),dark:""}},[t._v(t._s(t._f("capitalize")(t.valRepr(t.conformity)))+" ")]):a("span",[t._v(t._s(t.valRepr(e)))])],1)])})),0)}))],2)],1)],1)},Ns=[],Js={name:"ConformityCard",props:["minion_id","conformity","custom_conformity"],data:function(){return{}},methods:{boolRepr:function(t){return!0===t?"green":!1===t?"red":"primary"},isBool:function(t){return"boolean"===typeof t},valRepr:function(t){return null===t?"unknown":t}},filters:{capitalize:function(t){return t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)}}},Us=Js,zs=Object(h["a"])(Us,Ls,Ns,!1,null,"63a40cde",null),qs=zs.exports;f()(zs,{VCard:y["a"],VCardTitle:k["c"],VChip:Ot["a"],VContainer:ht["a"],VSimpleTable:mt["a"]});var Bs={name:"ConformityDetail",props:["minion_id"],components:{ConformityCard:qs,ConformityDetailCard:Ms},data:function(){return{conformity:"",succeeded:{},unchanged:{},failed:{},custom_conformity:[]}},mounted:function(){this.loadConformity()},methods:{loadConformity:function(){var t=this;this.$http.get("api/minions/"+this.minion_id+"/conformity_detail/").then((function(e){t.conformity=e.data.conformity,t.custom_conformity=e.data.custom_conformity,t.succeeded=e.data.succeeded,t.unchanged=e.data.unchanged,t.failed=e.data.failed}))}}},Hs=Bs,Ks=Object(h["a"])(Hs,Ss,Ts,!1,null,"bc290f46",null),Gs=Ks.exports;f()(Ks,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var Ws=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("UserCard")],1)},Ys=[],Xs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("v-card",[a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"username",headers:t.headers,items:t.users},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",{staticClass:"headline"},[t._v("Users")]),a("div",{staticClass:"flex-grow-1"}),a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-btn",t._g({staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:function(e){t.user={}}}},n),[t._v("Create")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",[t._v(t._s(!0===t.editing?"Update User":"Create User"))]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"Username",rules:t.userRules,required:""},model:{value:t.user.username,callback:function(e){t.$set(t.user,"username",e)},expression:"user.username"}})],1),a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"Email",rules:t.emailRules,required:""},model:{value:t.user.email,callback:function(e){t.$set(t.user,"email",e)},expression:"user.email"}})],1)],1),a("v-row",[a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"First Name"},model:{value:t.user.first_name,callback:function(e){t.$set(t.user,"first_name",e)},expression:"user.first_name"}})],1),a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"Last Name"},model:{value:t.user.last_name,callback:function(e){t.$set(t.user,"last_name",e)},expression:"user.last_name"}})],1)],1),a("v-row",[a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{"append-icon":t.show?"visibility":"visibility_off",type:t.show?"text":"password",name:"input-10-1",label:"Password",counter:""},on:{"click:append":function(e){t.show=!t.show}},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}})],1),a("v-col",{attrs:{lg:"6"}},[a("v-checkbox",{attrs:{label:"Staff User"},model:{value:t.user.is_staff,callback:function(e){t.$set(t.user,"is_staff",e)},expression:"user.is_staff"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),t.editing?a("v-btn",{attrs:{color:"primary"},on:{click:t.resetUser}},[t._v("Discard")]):t._e(),t.editing?a("v-btn",{attrs:{color:"warning"},on:{click:t.updateUser}},[t._v("Update")]):t._e(),t.editing?t._e():a("v-btn",{attrs:{color:"warning",disabled:null==t.user.username||""==t.user.email},on:{click:t.createUser}},[t._v("Create ")])],1)],1)],1)],1)]},proxy:!0},{key:"item.is_staff",fn:function(e){var n=e.item;return[n.is_staff?a("v-chip",{attrs:{color:"primary",dark:""}},[t._v(t._s(n.is_staff))]):t._e()]}},{key:"item.token",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"primary",tile:"",dark:""},on:{click:function(e){return t.showToken(n)}}},[t._v(" view ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"orange",tile:"",dark:""},on:{click:function(e){return t.manageToken("renew",n)}}},[t._v(" renew ")]),a("v-btn",{attrs:{small:"",color:"red",tile:"",dark:"",disabled:String(n.id)===t.currentUserId},on:{click:function(e){return t.manageToken("revoke",n)}}},[t._v(" revoke ")])],1)]}},{key:"item.date_joined",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Date(a.date_joined).toLocaleString("en-GB"))+" ")]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"orange",tile:"",dark:""},on:{click:function(e){return t.editUser(n)}}},[t._v(" update ")]),a("v-btn",{attrs:{small:"",color:"red",tile:"",dark:"",disabled:String(n.id)===t.currentUserId},on:{click:function(e){return t.confirmDelete(n)}}},[t._v(" delete ")])],1)]}}])})],1)],1)],1),a("div",{staticClass:"text-center"},[a("v-dialog",{attrs:{width:"500"},model:{value:t.dialogDelete,callback:function(e){t.dialogDelete=e},expression:"dialogDelete"}},[a("v-card",[a("v-card-title",{staticClass:"headline red",attrs:{"primary-title":""}},[t._v(" Delete "+t._s(t.user.username)+" ? ")]),a("v-card-text",[a("br"),t._v(" this action is irreversible. ")]),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialogDelete=!1}}},[t._v(" close ")]),a("v-btn",{attrs:{color:"red",text:""},on:{click:function(e){return t.deleteUser(t.user.id)}}},[t._v(" delete ")])],1)],1)],1)],1),a("div",{staticClass:"text-center"},[a("v-dialog",{attrs:{width:"500"},model:{value:t.dialogToken,callback:function(e){t.dialogToken=e},expression:"dialogToken"}},[a("v-card",[a("v-card-title",{staticClass:"headline primary",attrs:{"primary-title":""}},[t._v(" "+t._s(t.user.username)+" Token ")]),t.user.user_settings?a("v-card-text",[a("br"),t._v(" "+t._s(t.user.user_settings.token)+" ")]):t._e(),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialogToken=!1}}},[t._v(" close ")])],1)],1)],1)],1)],1)},Qs=[],Zs={name:"UserCard",data:function(){return{search:"",headers:[{text:"Username",value:"username"},{text:"First Name",value:"first_name"},{text:"Last Name",value:"last_name"},{text:"Email",value:"email"},{text:"Staff",value:"is_staff"},{text:"Token",value:"token",sortable:!1},{text:"Date Joined",value:"date_joined"},{text:"Actions",value:"action",sortable:!1}],userRules:[function(t){return!!t||"Username is required"}],emailRules:[function(t){return!!t||"E-mail is required"},function(t){return/.+@.+/.test(t)||"E-mail must be valid"}],users:[],user:{},editing:!1,show:!1,dialog:!1,dialogDelete:!1,dialogToken:!1}},mounted:function(){this.getUsers()},computed:{currentUserId:function(){return this.$store.state.id}},methods:{getUsers:function(){var t=this;this.$http.get("api/users/").then((function(e){t.users=e.data}))},createUser:function(){var t=this,e=new FormData;Object.keys(this.user).forEach((function(a){return e.append(a,t.user[a])})),this.$http.post("api/users/",e).then((function(){t.$toast("User created"),t.dialog=!1})).then((function(){t.user={},t.getUsers()}))},updateUser:function(){var t=this;this.editing=!1;var e=new FormData;e.set("username",this.user.username),e.set("email",this.user.email),e.set("first_name",this.user.first_name),e.set("last_name",this.user.last_name),e.set("password",this.user.password),e.set("is_staff",this.user.is_staff),this.$http.patch("api/users/"+this.user.id+"/",e).then((function(){t.$toast("User updated"),t.dialog=!1,t.user={}})).then((function(){t.getUsers()}))},showToken:function(t){this.dialogToken=!0,this.user=t},manageToken:function(t,e){var a=this,n=new FormData;n.set("action",t),this.$http.post("api/users/"+e.id+"/manage_token/",n).then((function(t){a.$toast(t.data.result)})).then((function(){a.getUsers()}))},confirmDelete:function(t){this.dialogDelete=!0,this.user=t},deleteUser:function(t){var e=this;this.$http.delete("api/users/"+t).then((function(){e.dialogDelete=!1,e.$toast("User deleted")})).then((function(){return e.getUsers()}))},editUser:function(t){this.dialog=!0,this.editing=!0,this.user=t},resetUser:function(){this.dialog=!1,this.editing=!1,this.user={}}}},tr=Zs,er=Object(h["a"])(tr,Xs,Qs,!1,null,"7dccc9a6",null),ar=er.exports;f()(er,{VBtn:g["a"],VCard:y["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:k["c"],VCheckbox:Xe["a"],VChip:Ot["a"],VCol:Lt["a"],VContainer:ht["a"],VDataTable:Yt["a"],VDialog:Qe["a"],VDivider:C["a"],VRow:Nt["a"],VSpacer:A["a"],VTextField:I["a"],VToolbar:be["a"],VToolbarTitle:R["a"]});var nr={name:"Users",components:{UserCard:ar}},sr=nr,rr=Object(h["a"])(sr,Ws,Ys,!1,null,"68ff4932",null),ir=rr.exports;f()(rr,{VContainer:ht["a"]});var or=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("ScheduleTable",{key:t.refreshKey}),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)],1)],1)},lr=[],cr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v(" Schedules "),a("v-spacer"),a("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion",headers:t.headers,items:t.schedules,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.enabled",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(n.enabled),dark:""}},[t._v(t._s(n.enabled))])]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:n.enabled?"orange":"green",tile:"",dark:""},on:{click:function(e){return t.manageSchedule(n.enabled?"disable_job":"enable_job",n.name,n.minion)}}},[t._v(" "+t._s(n.enabled?"disable":"enable")+" ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"red",tile:"",dark:""},on:{click:function(e){return t.manageSchedule("delete",n.name,n.minion)}}},[t._v(" delete ")])],1)]}}])})],1)],1)},ur=[],dr=(a("6062"),{name:"ScheduleTable",data:function(){return{search:"",headers:[],schedules:[],loading:!0}},methods:{loadData:function(){var t=this;this.loading=!1,this.$http.get("api/schedules/").then((function(e){if(t.schedules=e.data,t.schedules.length>0){var a=new Set(["minion","name","function"]);t.schedules.forEach((function(t){Object.keys(t).forEach((function(t){a.add(t)}))})),a.delete("id"),a.forEach((function(e){t.headers.push({text:e,value:e})})),t.headers.push({text:"action",value:"action"})}}))},manageSchedule:function(t,e,a){var n=this;this.$toast("".concat(t," on ").concat(a," for job ").concat(e));var s=new FormData;s.set("action",t),s.set("name",e),s.set("minion",a),this.$http.post("api/schedules/manage/",s).then((function(){n.$toast("".concat(t," on ").concat(a," for job ").concat(e,": done"))})).then((function(){n.headers=[],n.schedules=[],n.loadData()})).catch((function(t){n.$toast.error(t.response.data)}))},boolRepr:function(t){return!0===t?"green":!1===t?"red":"primary"}},mounted:function(){this.loadData()}}),hr=dr,mr=Object(h["a"])(hr,cr,ur,!1,null,"93eb7e5e",null),fr=mr.exports;f()(mr,{VBtn:g["a"],VCard:y["a"],VCardTitle:k["c"],VChip:Ot["a"],VContainer:ht["a"],VDataTable:Yt["a"],VSpacer:A["a"],VTextField:I["a"]});var vr={name:"Schedules",components:{Fab:Ne,ScheduleTable:fr},data:function(){return{fabs:[{color:"pink",action:"refreshSchedules",icon:"refresh",tooltip:"Refresh schedules"}],refreshKey:0}},methods:{fabAction:function(t){this[t]()},refreshSchedules:function(){var t=this;this.$toast("refreshing schedules"),this.$http.post("/api/schedules/refresh/").then((function(){t.refreshKey+=1,t.$toast("schedules refreshed")})).catch((function(e){t.$toast.error(e.response.data)}))}}},pr=vr,br=Object(h["a"])(pr,or,lr,!1,null,"04b7f2cf",null),_r=br.exports;f()(br,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]});var gr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"4",offset:"4"}},[a("v-card",[a("v-card-title",{staticClass:"black white--text subheading",attrs:{"primary-title":""}},[a("span",{staticClass:"title"},[t._v("Oops")])]),a("v-card-text",{staticClass:"display-1 ma-7 text-center"},[t._v(" 404. There is no page here. ")]),a("v-card-actions",[a("v-btn",{staticClass:"primary darken-3 white--text",attrs:{text:"",to:"/"}},[a("v-icon",{attrs:{left:""}},[t._v("arrow_back")]),t._v(" Back ")],1)],1)],1)],1)],1)],1)},yr=[],kr={name:"NotFound"},xr=kr,Cr=Object(h["a"])(xr,gr,yr,!1,null,"28d4add2",null),wr=Cr.exports;f()(Cr,{VBtn:g["a"],VCard:y["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:k["c"],VCol:Lt["a"],VContainer:ht["a"],VIcon:j["a"],VRow:Nt["a"]});var jr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[0===t.jobs.length&&0===t.minions.length?a("v-col",{attrs:{sm:"12"}},[a("v-container",[a("p",{staticClass:"display-2 text-center"},[t._v("Sorry, no results...")])])],1):t._e(),t.jobs.length>0?a("v-col",{attrs:{sm:"12"}},[a("v-container",[a("v-card",[a("v-card-title",[t._v(" Jobs "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.job_search,callback:function(e){t.job_search=e},expression:"job_search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"jid","sort-desc":"",headers:t.jobs_headers,items:t.jobs,search:t.search,"items-per-page":5},scopedSlots:t._u([{key:"item.jid",fn:function(e){var n=e.item;return[a("v-btn",{staticClass:"text-none",class:n.jid.includes(t.query)?"red":"",attrs:{text:"",small:"",to:"/jobs/"+n.jid+"/"+n.id}},[t._v(t._s(n.jid)+" ")])]}},{key:"item.fun",fn:function(e){var n=e.item;return[a("span",{class:n.fun.includes(t.query)?"red":""},[t._v(t._s(n.fun))])]}},{key:"item.arguments",fn:function(e){var a=e.item;return[t._v(" "+t._s(a.arguments.length>20?a.arguments.slice(0,20)+"...":a.arguments)+" ")]}},{key:"item.success",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(n.success),dark:""}},[t._v(t._s(t.boolText(n.success)))])]}},{key:"item.alter_time",fn:function(e){var a=e.item;return[t._v(" "+t._s(new Date(a.alter_time).toLocaleString("en-GB"))+" ")]}}],null,!1,323593499)})],1)],1)],1):t._e(),t.minions.length>0?a("v-col",{attrs:{sm:"12"}},[a("v-container",[a("v-card",[a("v-card-title",[t._v(" Minions "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.minions_headers,items:t.minions,"items-per-page":5},scopedSlots:t._u([{key:"item.minion_id",fn:function(e){var n=e.item;return[a("v-btn",{staticClass:"text-none",class:n.minion_id.includes(t.query)?"red":"",attrs:{text:"",small:"",to:"/minions/"+n.minion_id}},[t._v(t._s(n.minion_id)+" ")])]}},{key:"item.conformity",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(n.conformity),dark:""}},[t._v(t._s(null==n.conformity?"unknown":n.conformity)+" ")])]}},{key:"item.last_job",fn:function(e){var a=e.item;return[t._v(" "+t._s(null===a.last_job?"":new Date(a.last_job).toLocaleString("en-GB"))+" ")]}},{key:"item.last_highstate",fn:function(e){var a=e.item;return[t._v(" "+t._s(null===a.last_highstate?"":new Date(a.last_highstate).toLocaleString("en-GB"))+" ")]}}],null,!1,2280969435)})],1)],1)],1):t._e()],1)],1)},Vr=[],Sr={name:"Search",data:function(){return{query:null,jobs:[],jobs_headers:[{text:"Jid",value:"jid"},{text:"Target",value:"id"},{text:"Function",value:"fun"},{text:"Arguments",value:"arguments"},{text:"User",value:"user"},{text:"Status",value:"success"},{text:"Date",value:"alter_time"}],job_search:"",minions:[],minions_headers:[{text:"Minion Id",value:"minion_id"},{text:"Highstate Conformity",value:"conformity"},{text:"F.Q.D.N",value:"fqdn"},{text:"O.S",value:"os"},{text:"O.S Version",value:"oscodename"},{text:"Kernel",value:"kernelrelease"},{text:"Last Job",value:"last_job"},{text:"Last Highstate",value:"last_highstate"}]}},created:function(){this.query=this.$route.query.q},mounted:function(){this.searchBar()},methods:{searchBar:function(){var t=this;this.$http.get("api/search/?q="+this.query).then((function(e){function a(t){return t.forEach((function(t){var e=JSON.parse(t.grain);for(var a in e)t[a]=e[a]})),t}t.jobs=e.data.jobs,t.minions=a(e.data.minions)}))},boolRepr:function(t){return!0===t?"green":"red"},boolText:function(t){return!0===t?"success":"failed"}}},Tr=Sr,$r=Object(h["a"])(Tr,jr,Vr,!1,null,"f2f59722",null),Dr=$r.exports;f()($r,{VBtn:g["a"],VCard:y["a"],VCardTitle:k["c"],VChip:Ot["a"],VCol:Lt["a"],VContainer:ht["a"],VDataTable:Yt["a"],VRow:Nt["a"],VSpacer:A["a"],VTextField:I["a"]});var Or=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",cols:"12"}},[a("JobTemplatesTable")],1)],1)],1)},Er=[],Ar=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{sm:"12"}},[a("v-card",[a("v-card-title",[t._v(" Job Templates "),a("v-spacer"),a("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"jid","sort-desc":"",headers:t.headers,items:t.job_templates,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.name",fn:function(e){var n=e.item;return[a("b",[t._v(t._s(n.name))])]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue-grey",tile:"",dark:"",to:t.computeUrl(n,!1)}},[t._v(" run ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"orange",tile:"",dark:"",to:t.computeUrl(n,!0)}},[t._v(" edit ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"red",tile:"",dark:""},on:{click:function(e){return t.deleteTemplate(n.id)}}},[t._v(" delete ")])],1)]}}])})],1)],1)],1)],1)},Ir=[],Rr=(a("2b3d"),{name:"JobTemplatesTable",data:function(){return{search:"",headers:[{text:"Name",value:"name"},{text:"Client",value:"client"},{text:"Target Type",value:"tgt_type"},{text:"Target",value:"tgt"},{text:"Function",value:"fun"},{text:"Arguments",value:"arg"},{text:"Keyword Arguments",value:"kwarg"},{text:"Batch",value:"batch"},{text:"Actions",value:"action",sortable:!1}],loading:!0,job_templates:[]}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;this.$http.get("api/job_templates/").then((function(e){var a=e.data;a.forEach((function(t){var e=JSON.parse(t.job);Object.keys(e).forEach((function(a){if("arg"===a){var n=e[a],s=n.filter((function(t){return t.includes("=")}));n=n.filter((function(t){return!t.includes("=")})),t[a]=n.join(" "),t["kwarg"]=s.join(" ")}else t[a]=e[a]})),delete t.job})),t.job_templates=a,t.loading=!1}))},deleteTemplate:function(t){var e=this;this.$http.delete("api/job_templates/"+t).then((function(t){e.$toast("Template deleted")})).then((function(){e.loadData()}))},computeUrl:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=new URLSearchParams(t);return a.delete("id"),e||a.delete("name"),"/run?"+a.toString()}}}),Pr=Rr,Fr=Object(h["a"])(Pr,Ar,Ir,!1,null,"fc993278",null),Mr=Fr.exports;f()(Fr,{VBtn:g["a"],VCard:y["a"],VCardTitle:k["c"],VCol:Lt["a"],VContainer:ht["a"],VDataTable:Yt["a"],VRow:Nt["a"],VSpacer:A["a"],VTextField:I["a"]});var Lr={name:"JobTemplates",components:{JobTemplatesTable:Mr}},Nr=Lr,Jr=Object(h["a"])(Nr,Or,Er,!1,null,"cb15827a",null),Ur=Jr.exports;f()(Jr,{VCol:Lt["a"],VContainer:ht["a"],VRow:Nt["a"]}),n["a"].use(tt["a"]);var zr=new tt["a"]({routes:[{path:"/",name:"home",component:ne},{path:"/minions",name:"minions",component:sa},{path:"/minions/:minion_id",name:"minion_detail",component:La,props:!0},{path:"/jobs",name:"jobs",component:je},{path:"/jobs/:jid",name:"job_jid",component:je,props:!0},{path:"/jobs/:jid/:minion_id",name:"job_detail",component:Ba,props:!0},{path:"/run",name:"run",component:Yn},{path:"/job_templates",name:"job_templates",component:Ur},{path:"/keys",name:"keys",component:qe},{path:"/events",name:"events",component:sn},{path:"/conformity",name:"conformity",component:Vs},{path:"/conformity/:minion_id",name:"conformity_detail",component:Gs,props:!0},{path:"/schedules",name:"schedules",component:_r},{path:"/users",name:"users",component:ir},{path:"/settings",name:"settings",component:fs},{path:"/search",name:"search",component:Dr},{path:"/login",name:"Login",component:ge,meta:{plainLayout:!0}},{path:"*",component:wr}]});zr.beforeEach((function(t,e,a){rt.getters.isLoggedIn||"/login"===t.path?"/login"===t.path&&rt.getters.isLoggedIn?a("/"):a():a("/login")}));var qr=zr,Br=a("04e1"),Hr=a.n(Br);n["a"].config.productionTip=!1,n["a"].prototype.$http=st.a,n["a"].prototype.$http.defaults.xsrfCookieName="csrftoken",n["a"].prototype.$http.defaults.xsrfHeaderName="X-CSRFToken",n["a"].prototype.$http.defaults.headers.common["Content-Type"]="application/json";var Kr=localStorage.getItem("access");Kr&&(n["a"].prototype.$http.defaults.headers.common.Authorization="Bearer ".concat(Kr),n["a"].prototype.$http.defaults.withCredentials=!0);var Gr=!1,Wr=[],Yr=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Wr.forEach((function(a){t?a.reject(t):a.resolve(e)})),Wr=[]};n["a"].prototype.$http.interceptors.request.use((function(t){var e=t,a=window.localStorage.getItem("refresh");return a&&Hr()(a).exp-Math.floor(Date.now()/1e3)<60?rt.dispatch("logout").then((function(){return qr.push({path:"/login",name:"Login"})})):e}),(function(t){return Promise.reject(t)})),n["a"].prototype.$http.interceptors.request.use((function(t){var e=t,a=window.localStorage.getItem("access");if(a&&Hr()(a).exp>Math.floor(Date.now()/1e3))return e;if(t.url.includes("login")||t.url.includes("token")||t.url.includes("social"))return e;if(Gr)return new Promise((function(t,e){Wr.push({resolve:t,reject:e})})).then((function(t){return e.headers["Authorization"]="Bearer "+t,e})).catch((function(t){return t}));Gr=!0;var s=window.localStorage.getItem("refresh");return new Promise((function(t,a){n["a"].prototype.$http.post("/api/token/refresh/",{refresh:s}).then((function(a){var s=a.data;window.localStorage.setItem("access",s.access),n["a"].prototype.$http.defaults.headers.common["Authorization"]="Bearer "+s.access,e.headers["Authorization"]="Bearer "+s.access,Yr(null,s.access),t(e)})).catch((function(t){Yr(t,null),a(t)})).then((function(){Gr=!1}))}))}),(function(t){return Promise.reject(t)})),new n["a"]({vuetify:Z,router:qr,store:rt,render:function(t){return t(G)}}).$mount("#app")},"76a3":function(t,e,a){},"7cd6":function(t,e,a){},"8a23":function(t,e,a){},"9cda":function(t,e,a){},ad3d:function(t,e,a){"use strict";var n=a("76a3"),s=a.n(n);s.a},cced:function(t,e,a){"use strict";var n=a("7cd6"),s=a.n(n);s.a},d8e8:function(t,e,a){},dd96:function(t,e,a){},efe9:function(t,e,a){}});
//# sourceMappingURL=app.abcf37bb.js.map