(function(t){function e(e){for(var n,r,o=e[0],l=e[1],c=e[2],u=0,m=[];u<o.length;u++)r=o[u],s[r]&&m.push(s[r][0]),s[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);d&&d(e);while(m.length)m.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(n=!1)}n&&(i.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},s={app:0},i=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var n=a("1356"),s=a.n(n);s.a},"0e47":function(t,e,a){},1356:function(t,e,a){},"2c0b":function(t,e,a){},"2ffc":function(t,e,a){"use strict";var n=a("e6f2"),s=a.n(n);s.a},"31c4":function(t,e,a){"use strict";var n=a("91a6"),s=a.n(n);s.a},"355a":function(t,e,a){"use strict";var n=a("2c0b"),s=a.n(n);s.a},"3ba7":function(t,e,a){"use strict";var n=a("ab34"),s=a.n(n);s.a},4678:function(t,e,a){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=i(t);return a(e)}function i(t){var e=n[t];if(!(e+1)){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}return e}s.keys=function(){return Object.keys(n)},s.resolve=i,t.exports=s,s.id="4678"},"56d7":function(t,e,a){"use strict";a.r(e);var n=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[t.layout?a("simple-layout"):a("app-layout")],1)},i=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-navigation-drawer",{attrs:{"mini-variant":t.mini,app:"",clipped:""},scopedSlots:t._u([{key:"append",fn:function(){return[a("v-list-item",{staticClass:"elevation-24",on:{click:function(e){e.stopPropagation(),t.mini=!t.mini}}},[a("v-list-item-action",[t.mini?a("v-icon",[t._v("arrow_forward")]):a("v-icon",[t._v("arrow_back")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("COLLAPSE")])],1)],1)]},proxy:!0}]),model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{staticClass:"py-0",attrs:{dense:"",nav:"",dark:"",color:"#212121"}},[a("v-list-item",{attrs:{"two-line":""}},[a("v-list-item-avatar",[a("v-icon",{attrs:{large:""}},[t._v("person")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(t.username))]),a("v-list-item-subtitle",[t._v(t._s(t.email))])],1)],1)],1),a("v-divider"),t._l(t.routes,function(e){return a("v-list",{key:e.name,attrs:{dense:""}},[a("v-list-item",{attrs:{to:""+e.path}},[t.mini?a("v-list-item-action",[a("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on;return[a("v-icon",t._g({},s),[t._v(t._s(e.icon))])]}}],null,!0)},[a("span",[t._v(t._s(e.name))])])],1):a("v-list-item-action",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.name))])],1)],1)],1)}),a("v-divider"),a("v-list",{attrs:{dense:""}},[a("v-list-item",{attrs:{to:"/users"}},[t.mini?a("v-list-item-action",[a("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-icon",t._g({},n),[t._v("group")])]}}],null,!1,3527340433)},[a("span",[t._v("Users")])])],1):a("v-list-item-action",[a("v-icon",[t._v("group")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Users")])],1)],1),a("v-list-item",{attrs:{to:"/settings"}},[t.mini?a("v-list-item-action",[a("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-icon",t._g({},n),[t._v("settings")])]}}],null,!1,1926182315)},[a("span",[t._v("Settings")])])],1):a("v-list-item-action",[a("v-icon",[t._v("settings")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Settings")])],1)],1)],1)],2),a("v-app-bar",{attrs:{color:"black",dark:"",app:"","clipped-left":""}},[a("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),a("v-toolbar-title",{staticClass:"font-weight-bold"},[t._v("ALCALI")]),a("v-spacer"),a("v-expand-transition",[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:t.expand_search,expression:"expand_search"}],staticClass:"mx-auto",attrs:{flat:"","hide-details":"",label:"Search","solo-inverted":""}})],1),a("v-btn",{staticClass:"mr-2",attrs:{icon:""},on:{click:function(e){t.expand_search=!t.expand_search}}},[a("v-icon",[t._v("mdi-magnify")])],1),a("v-menu",{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-badge",{attrs:{color:"primary",overlap:""},scopedSlots:t._u([{key:"badge",fn:function(){return[t.notif_nb>0?a("span",[t._v(t._s(t.notif_nb))]):t._e()]},proxy:!0}],null,!0)},[t.messages.length>0?a("v-icon",t._g({on:{click:function(e){t.notif_nb=0}}},n),[t._v("notifications")]):a("v-icon",[t._v("notifications")])],1)]}}])},[a("v-list",{attrs:{"max-width":"500px"}},t._l(t.messages,function(e,n){return a("v-list-item",{key:n,attrs:{to:e.link}},[a("v-list-item-avatar",[a("v-icon",{attrs:{dark:"",color:e.color,size:"62"}},[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.text))]),a("v-list-item-subtitle",[t._v(t._s(e.tag))])],1)],1)}),1)],1),a("v-menu",{attrs:{bottom:"",left:"","offset-y":"","offset-x":"","close-on-click":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-btn",t._g({attrs:{icon:""}},n),[a("v-icon",[t._v("mdi-dots-vertical")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:t.toggleTheme}},[a("v-list-item-title",[t._v("Toggle Theme")])],1),a("v-divider"),a("v-list-item",{on:{click:t.logout}},[a("v-list-item-title",[t._v("Logout")])],1)],1)],1)],1),a("v-content",[a("v-container",[a("router-view")],1)],1)],1)},o=[],l={methods:{fnmatch(t){if(-1===t.indexOf("*"))return e=>t===e;{let e=/[\\^$.*+?()[\]{}|]/g,a=t.replace(e,"\\$&"),n=new RegExp("^"+a.replace(/\\\*/g,".*")+"$");return t=>n.test(t)}},sleep(t){return new Promise(e=>setTimeout(e,t))}}},c={name:"Layout",props:{source:String},data:()=>({expand_search:!1,drawer:!0,mini:!0,messages:[],settings:null,notif_nb:0,notifs:{created:!1,published:!1,returned:!1,event:!1},routes:[{name:"Overview",path:"/",icon:"dashboard"},{name:"Minions",path:"/minions",icon:"device_hub"},{name:"Jobs",path:"/jobs",icon:"playlist_play"},{name:"Run",path:"/run",icon:"play_arrow"},{name:"Schedules",path:"/schedules",icon:"schedule"},{name:"Conformity",path:"/conformity",icon:"done_all"},{name:"Keys",path:"/keys",icon:"compare_arrows"},{name:"Events",path:"/events",icon:"playlist_add"}]}),methods:{logout:function(){this.$store.dispatch("logout").then(()=>{this.$router.push("/login")})},getPrefs(){this.$http.get("api/userssettings/"+this.$store.getters.user_id+"/").then(t=>{this.settings=t.data,Object.keys(this.notifs).forEach(t=>{this.notifs[t]=this.settings["notifs_"+t]})})},toggleTheme(){this.$store.dispatch("toggleTheme").then(()=>{this.$vuetify.theme.dark=this.$store.getters.theme})},saltStatus(){let t=l.methods.fnmatch("salt/job/*"),e=l.methods.fnmatch("salt/job/*/new"),a=l.methods.fnmatch("salt/job/*/ret/*"),n=new EventSource("/api/event_stream/");n.addEventListener("open",()=>{this.$store.dispatch("updateWs")}),n.addEventListener("message",n=>{let s=JSON.parse(n.data);if(e(s.tag)&&!0===this.notifs.published){s.type="new",s.color="green",s.icon="keyboard_tab",s.link="";let t="";t=s.data.hasOwnProperty("tgt")?s.data.tgt:s.data.minions.length+" minion(s)",s.text="Job "+s.data.fun+" published for "+t,this.messages.unshift(s),this.messages.length>this.settings.max_notifs&&this.messages.pop(),this.notif_nb+=1}else a(s.tag)&&!0===this.notifs.returned?(s.type="return",s.color="primary",s.icon="subdirectory_arrow_left",s.text="Job "+s.data.fun+" returned for "+s.data.id,s.link="/jobs/"+s.data.jid+"/"+s.data.id,this.messages.unshift(s),this.messages.length>this.settings.max_notifs&&this.messages.pop(),this.notif_nb+=1):t(s.tag)&&!0===this.notifs.event?(s.type="event",s.color="orange",s.icon="more_horiz",s.text="Job Event",s.link="",this.messages.unshift(s),this.messages.length>this.settings.max_notifs&&this.messages.pop(),this.notif_nb+=1):/^\w{20}$/.test(s.tag)&&!0===this.notifs.created&&(s.type="created",s.color="secondary",s.icon="add",s.text="New Job Created",s.link="",this.messages.unshift(s),this.messages.length>this.settings.max_notifs&&this.messages.pop(),this.notif_nb+=1)},!1)}},mounted(){this.getPrefs(),this.saltStatus(),this.$vuetify.theme.dark=this.$store.getters.theme},computed:{username(){return this.$store.state.username},email(){return this.$store.state.email}}},d=c,u=(a("355a"),a("2877")),m=a("6544"),h=a.n(m),v=a("7496"),f=a("40dc"),p=a("5bc1"),b=a("4ca6"),_=a("8336"),g=a("a523"),y=a("a75b"),x=a("ce7e"),k=a("0789"),C=a("132d"),V=a("8860"),j=a("da13"),w=a("1800"),S=a("8270"),T=a("5d23"),$=a("e449"),D=a("f774"),E=a("2fa4"),O=a("8654"),L=a("2a7f"),F=a("3a2f"),A=Object(u["a"])(d,r,o,!1,null,null,null),R=A.exports;h()(A,{VApp:v["a"],VAppBar:f["a"],VAppBarNavIcon:p["a"],VBadge:b["a"],VBtn:_["a"],VContainer:g["a"],VContent:y["a"],VDivider:x["a"],VExpandTransition:k["a"],VIcon:C["a"],VList:V["a"],VListItem:j["a"],VListItemAction:w["a"],VListItemAvatar:S["a"],VListItemContent:T["a"],VListItemSubtitle:T["b"],VListItemTitle:T["c"],VMenu:$["a"],VNavigationDrawer:D["a"],VSpacer:E["a"],VTextField:O["a"],VToolbarTitle:L["a"],VTooltip:F["a"]});var I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("router-view")},M=[],P={name:"SimpleLayout"},U=P,J=Object(u["a"])(U,I,M,!1,null,"0f66a338",null),N=J.exports,q={computed:{layout(){return this.$route.meta.plainLayout}},components:{"app-layout":R,"simple-layout":N}},z=q,B=(a("034f"),Object(u["a"])(z,s,i,!1,null,null,null)),K=B.exports;h()(B,{VApp:v["a"]});a("5363");var H=a("f309"),G=a("2db4"),W=a("87f6"),Y=a.n(W),Q=a("5887"),X=a.n(Q);n["a"].use(H["a"],{components:{VSnackbar:G["a"],VBtn:_["a"],VIcon:C["a"]}}),n["a"].use(X.a,{componentPrefix:"vc"}),n["a"].use(Y.a,{x:"center",y:"bottom",color:"black",icon:"info",iconColor:"",classes:["body-2"],timeout:3e3,dismissable:!0,multiLine:!1,vertical:!1,queueable:!1,showClose:!0,closeText:"",closeColor:"",shorts:{custom:{color:"purple"}},property:"$toast"});var Z=new H["a"]({icons:{iconfont:"md"},theme:{themes:{light:{primary:"#6200EE",secondary:"#03DAC6"},dark:{secondary:"#BB86FC",primary:"#03DAC6"}}}}),tt=a("8c4f"),et=a("2f62"),at=a("bc3a"),nt=a.n(at);n["a"].use(et["a"]);var st=new et["a"].Store({state:{username:localStorage.getItem("username")||"",email:localStorage.getItem("email")||"",id:localStorage.getItem("id")||"",access:localStorage.getItem("access")||"",refresh:localStorage.getItem("refresh")||"",ws_status:!1,theme:localStorage.getItem("theme")||!1},mutations:{auth_success(t,e){Object.keys(e).forEach(a=>{t[a]=e[a]})},logout(t){t.access=""},updateWs(t){t.ws_status=!0},toggleTheme(t){t.theme=!t.theme}},getters:{isLoggedIn:t=>!!t.access,theme:t=>t.theme,user_id:t=>t.id},actions:{updateWs({commit:t}){t("updateWs")},toggleTheme({commit:t}){t("toggleTheme")},login({commit:t},e){return new Promise((a,n)=>{nt()({url:"/api/token/",data:e,method:"POST"}).then(e=>{Object.keys(e.data).forEach(t=>{localStorage.setItem(t,e.data[t])}),nt.a.defaults.headers.common.Authorization=`Bearer ${e.data.access}`,t("auth_success",e.data),a(e)}).catch(t=>{localStorage.clear(),n(t)})})},logout({commit:t}){return new Promise(e=>{t("logout"),localStorage.clear(),delete nt.a.defaults.headers.common["Authorization"],e()})}}}),it=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"7"}},[a("ConformityChart")],1),a("v-col",{attrs:{sm:"6",lg:"2"}},[a("KeysStatusCard")],1),a("v-col",{attrs:{sm:"6",lg:"3"}},[a("AlcaliStatusCard")],1)],1),a("v-row",[a("v-col",{attrs:{lg:"12"}},[a("JobsChartCard")],1)],1),a("v-row",[a("v-col",{attrs:{lg:"12"}},[a("JobsTable",{attrs:{filter:{limit:10}}})],1)],1)],1)},rt=[],ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Keys")]),a("v-simple-table",[a("tbody",t._l(t.keys_status,function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),a("td",{staticClass:"text-right"},[t._v(t._s(e))])])}),0)])],1)],1)},lt=[],ct={name:"KeysStatusCard",data(){return{keys_status:{}}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/keys/keys_status/").then(t=>this.keys_status=t.data)}}},dt=ct,ut=a("b0af"),mt=a("99d9"),ht=a("1f4f"),vt=Object(u["a"])(dt,ot,lt,!1,null,"84b12790",null),ft=vt.exports;h()(vt,{VCard:ut["a"],VCardTitle:mt["c"],VContainer:g["a"],VSimpleTable:ht["a"]});var pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-list-item",{attrs:{"three-line":"",dense:""}},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"headline mb-1"},[t._v("Jobs Stats")])],1),a("v-spacer"),a("v-list-item-content",{staticClass:"mr-6"},[a("v-select",{attrs:{items:t.filters,label:"Filter","return-object":""},on:{change:t.loadData},model:{value:t.selectedFilter,callback:function(e){t.selectedFilter=e},expression:"selectedFilter"}})],1),a("v-list-item-content",[a("v-select",{attrs:{items:t.periods,label:"Period","return-object":""},on:{change:t.loadData},model:{value:t.selectedPeriod,callback:function(e){t.selectedPeriod=e},expression:"selectedPeriod"}})],1)],1),a("canvas",{ref:"chart"})],1)],1)},bt=[],_t=a("30ef"),gt=a.n(_t);let yt={afterLayout:function(t){if(t.options.linearGradientLine){let e=t.chart.ctx;t.data.datasets.forEach(a=>{let n=Number.MAX_VALUE,s=Number.MIN_VALUE;for(let t=0;t<a.data.length;++t)n>a.data[t]&&(n=a.data[t]),s<a.data[t]&&(s=a.data[t]);let i=t.scales["y-axis-0"],r=i.getPixelForValue(n),o=i.getPixelForValue(s),l=e.createLinearGradient(0,r,0,o);l.addColorStop(0,a.colorStart),l.addColorStop(1,a.colorEnd),a.borderColor=l})}else if(t.options.radialGradientDonut){let e=t.chart.ctx;t.data.datasets.forEach(a=>{let n=(t.chartArea.left+t.chartArea.right)/2,s=(t.chartArea.top+t.chartArea.bottom)/2,i=e.createRadialGradient(n,s,2*t.innerRadius*.2,n,s,2*t.innerRadius);i.addColorStop(0,a.colorStart),i.addColorStop(1,a.colorEnd),a.backgroundColor=i})}}};var xt=yt,kt={name:"JobsChartCard",props:["minion"],data(){return{filters:[{text:"All",value:"all"},{text:"Highstate",value:"highstate"},{text:"Other",value:"other"}],periods:[{text:"Week",value:7},{text:"Two Weeks",value:14},{text:"Month",value:30},{text:"Year",value:365}],jobchart:null,selectedFilter:null,selectedPeriod:null,labels:null,chart_data:[]}},mounted(){this.createChart()},methods:{loadData(){let t=null==this.selectedFilter?"all":this.selectedFilter.value,e=null==this.selectedPeriod?7:this.selectedPeriod.value,a={params:{fun:t,period:e}};this.minion&&(a.params.id=this.minion),this.$http.get("api/jobs/graph",a).then(t=>{this.labels=t.data.labels,this.jobchart.data.datasets[0].data=t.data.series[0],this.jobchart.data.datasets[1].data=t.data.series[1]}).then(()=>{return this.jobchart.update()})},createChart(){let t=null==this.selectedFilter?"all":this.selectedFilter.value,e=null==this.selectedPeriod?7:this.selectedPeriod.value,a={params:{fun:t,period:e}};this.minion&&(a.params.id=this.minion),null!=this.jobchart&&this.jobchart.destroy(),this.$http.get("api/jobs/graph",a).then(t=>{this.labels=t.data.labels,this.chart_data[0]=t.data.series[0],this.chart_data[1]=t.data.series[1],this.$refs.chart.height=60,this.jobchart=new gt.a(this.$refs.chart,{type:"line",data:{labels:this.labels,datasets:[{lineTension:.1,pointRadius:1,data:this.chart_data[0],fill:!1,colorStart:"rgba(0, 173, 238, 1.0)",colorEnd:"rgba(231, 18, 143, 1.0)"},{lineTension:.1,pointRadius:1,data:this.chart_data[1],fill:!1,colorStart:"rgba(255, 255, 255, 1.0)",colorEnd:"rgba(255, 0, 0, 1.0)"}]},options:{linearGradientLine:!0,legend:{display:!1},scales:{xAxes:[{gridLines:{display:!0}}],yAxes:[{gridLines:{display:!0},ticks:{autoSkip:!0,beginAtZero:!0,maxTicksLimit:6}}]},responsive:!0},plugins:[xt]})})}}},Ct=kt,Vt=a("b974"),jt=Object(u["a"])(Ct,pt,bt,!1,null,"b747b5ca",null),wt=jt.exports;h()(jt,{VCard:ut["a"],VContainer:g["a"],VListItem:j["a"],VListItemContent:T["a"],VListItemTitle:T["c"],VSelect:Vt["a"],VSpacer:E["a"]});var St=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Status")]),a("v-simple-table",[a("tbody",[a("tr",[a("td",[t._v("Salt WebSocket")]),a("td",{staticClass:"text-right"},[a("v-chip",{staticClass:"ma-2",attrs:{color:t.wsStatus?"green":"red","text-color":"white"}},[t._v("\n            "+t._s(t.wsStatus?"OK":"NOT OK")+"\n          ")])],1)]),t._l(t.stats,function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),a("td",{staticClass:"text-right"},[t._v(t._s(e))])])}),a("tr",[a("td",[t._v("Jobs Running")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.currentjobs))])])],2)])],1)],1)},Tt=[],$t={name:"AlcaliStatusCard",mixins:[l],data(){return{stats:{},currentjobs:0}},mounted(){this.loadData()},computed:{wsStatus(){return this.$store.state.ws_status}},methods:{loadData(){this.$http.get("api/stats/").then(t=>this.stats=t.data)}}},Dt=$t,Et=a("cc20"),Ot=Object(u["a"])(Dt,St,Tt,!1,null,"4979597b",null),Lt=Ot.exports;h()(Ot,{VCard:ut["a"],VCardTitle:mt["c"],VChip:Et["a"],VContainer:g["a"],VSimpleTable:ht["a"]});var Ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("Conformity")]),a("v-card-text",[a("v-container",[t._l(t.conformitynames,function(e){return[a("v-row",{key:e,attrs:{"no-gutters":"",align:"center",justify:"center"}},[a("v-col",{attrs:{sm:"2"}},[t._v(t._s(e))]),a("v-col",{attrs:{sm:"10"}},[a("v-menu",{attrs:{"open-on-hover":"","max-width":"250px"},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on;return[a("canvas",t._g({ref:e,refInFor:!0,attrs:{height:"15"}},s))]}}],null,!0)},[a("v-simple-table",{attrs:{dense:""}},[a("thead",[a("tr",[a("th",[t._v(t._s(e))])])]),a("tbody",{domProps:{innerHTML:t._s(t.customTool)}})])],1)],1)],1)]})],2)],1)],1)],1)},At=[],Rt=(a("02d0"),a("fcf4")),It={name:"ConformityChart",data(){return{conformitynames:null,confchart:null,conformity:null,customTool:""}},created(){},mounted(){this.loadConformity()},methods:{loadConformity(){this.$http.get("api/minions/conformity/").then(t=>{this.conformity=t.data.data,this.conformitynames=t.data.name}).then(()=>{this.conformity.forEach((t,e)=>{let a={labels:[this.conformitynames[e]],datasets:[]};Object.keys(t).forEach(e=>{let n="";if(["conflict","false"].indexOf(e)>=0)n="#F44336";else if(["conform","true"].indexOf(e)>=0)n="#41f40e";else if(["None","unknown","null"].indexOf(e)>=0)n=this.$vuetify.theme.themes.light.primary;else{let t=Object.keys(Rt["a"]);n=Rt["a"][t[t.length*Math.random()<<0]].darken2}a.datasets.push({label:e,data:[t[e]],backgroundColor:n})}),new gt.a(this.$refs[this.conformitynames[e]],{type:"horizontalBar",data:a,options:{animation:!1,plugins:{stacked100:{enable:!0}},tooltips:{enabled:!1,mode:"index",intersect:!1,custom:t=>{if(t&&t.body){var e=t.body.map(t=>t.lines),a="";e.forEach(function(e,n){var s=t.labelColors[n],i="background:"+s.backgroundColor;i+="; border-color:"+s.borderColor,i+="; border-width: 2px";var r='<span class="chartjs-tooltip-key" style="'+i+'">__</span>';a+="<tr><td>"+r+"  "+e+"</td></tr>"}),this.customTool=a}}},legend:{display:!1},scales:{xAxes:[{stacked:!0,display:!1,gridLines:{display:!1,drawTicks:!1,drawBorder:!1},ticks:{display:!1,padding:-20}}],yAxes:[{stacked:!0,display:!1,ticks:{display:!1,padding:-20},gridLines:{drawTicks:!1,display:!1,drawBorder:!1}}]}}})})})}}},Mt=It,Pt=(a("2ffc"),a("62ad")),Ut=a("0fd9"),Jt=Object(u["a"])(Mt,Ft,At,!1,null,"6f45fbe6",null),Nt=Jt.exports;h()(Jt,{VCard:ut["a"],VCardText:mt["b"],VCardTitle:mt["c"],VCol:Pt["a"],VContainer:g["a"],VMenu:$["a"],VRow:Ut["a"],VSimpleTable:ht["a"]});var qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[null==t.filter?a("v-card",[a("v-row",[a("v-col",{attrs:{lg:"2"}},[a("v-card-title",[t._v("Search Jobs")])],1),a("v-divider"),a("v-col",{attrs:{lg:"2","align-self":"center"}},[a("vc-date-picker",{attrs:{"max-date":new Date,mode:"range","input-props":{class:"input",placeholder:"Select Date(s)"},formats:{input:["YYYY-MM-DD"]}},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}})],1),a("v-col",{attrs:{lg:"2"}},[a("v-select",{attrs:{items:t.users,placeholder:"User(s)",multiple:"","single-line":""},model:{value:t.selectedUsers,callback:function(e){t.selectedUsers=e},expression:"selectedUsers"}})],1),a("v-col",{attrs:{lg:"2"}},[a("v-autocomplete",{attrs:{items:t.minions,placeholder:"Target(s)",multiple:"","single-line":""},model:{value:t.selectedTarget,callback:function(e){t.selectedTarget=e},expression:"selectedTarget"}})],1),a("v-col",{attrs:{lg:"1"}},[a("v-select",{attrs:{items:t.limit,placeholder:"Limit","single-line":""},model:{value:t.selectedLimit,callback:function(e){t.selectedLimit=e},expression:"selectedLimit"}})],1),a("v-col",{attrs:{lg:"1","align-self":"center"}},[a("div",{staticClass:"text-center"},[a("v-btn",{attrs:{color:"primary"},on:{click:t.filterJobs}},[t._v("Search\n              ")])],1)])],1)],1):t._e()],1)],1),a("v-card",[a("v-card-title",[t._v("\n      Jobs\n      "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"jid","sort-desc":"","item-key":"uniqueid",headers:t.headers,items:t.indexedItems,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.jid",fn:function(e){var n=e.item;return[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/jobs/"+n.jid+"/"+n.id}},[t._v(t._s(n.jid))])]}},{key:"item.success",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(n.success),dark:""}},[t._v(t._s(t.boolText(n.success)))])]}},{key:"item.alter_time",fn:function(e){var a=e.item;return[t._v("\n        "+t._s(new Date(a.alter_time).toLocaleString("en-GB"))+"\n      ")]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue",tile:"",dark:"",to:"/jobs/"+n.jid+"/"+n.id}},[t._v("\n            detail\n          ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue-grey",tile:"",dark:"",to:"/run/?target="+n.id+"&function="+n.fun+"&args="+n.arguments}},[t._v("\n            rerun\n          ")])],1)]}}])})],1)],1)},zt=[],Bt={name:"JobsTable",props:["filter"],data(){return{limit:[50,100,200,500,1e3],selectedLimit:null,selectedDate:[new Date,new Date],minions:[],selectedTarget:null,users:[],selectedUsers:null,search:"",headers:[{text:"Jid",value:"jid"},{text:"Target",value:"id"},{text:"Function",value:"fun"},{text:"Arguments",value:"arguments"},{text:"User",value:"user"},{text:"Status",value:"success"},{text:"Date",value:"alter_time"},{text:"Actions",value:"action",sortable:!1}],jobs:[],loading:!0}},computed:{indexedItems(){return this.jobs.map((t,e)=>({uniqueid:e,...t}))},themeColor(){return this.$store.getters.theme}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/jobs/filters/").then(t=>{this.minions=t.data.minions,this.users=t.data.users}),this.$http.get("api/jobs/",{params:this.filter}).then(t=>{this.jobs=t.data,this.loading=!1})},filterJobs(){this.loading=!0;let t={limit:this.selectedLimit,target:this.selectedTarget,users:this.selectedUsers};this.selectedDate.start&&this.selectedDate.end&&(t.start=this.selectedDate.start.toISOString().slice(0,10),t.end=this.selectedDate.end.toISOString().slice(0,10)),this.$http.get("api/jobs/",{params:t}).then(t=>{this.jobs=t.data,this.loading=!1,this.selectedDate=this.selectedUsers=this.selectedTarget=this.selectedLimit=this.selectedDate=null})},boolRepr(t){return!0===t?"green":"red"},boolText(t){return!0===t?"success":"failed"}}},Kt=Bt,Ht=a("c6a6"),Gt=a("8fea"),Wt=Object(u["a"])(Kt,qt,zt,!1,null,"839e19bc",null),Yt=Wt.exports;h()(Wt,{VAutocomplete:Ht["a"],VBtn:_["a"],VCard:ut["a"],VCardTitle:mt["c"],VChip:Et["a"],VCol:Pt["a"],VContainer:g["a"],VDataTable:Gt["a"],VDivider:x["a"],VRow:Ut["a"],VSelect:Vt["a"],VSpacer:E["a"],VTextField:O["a"]});var Qt={name:"home",components:{JobsTable:Yt,ConformityChart:Nt,AlcaliStatusCard:Lt,KeysStatusCard:ft,JobsChartCard:wt}},Xt=Qt,Zt=Object(u["a"])(Xt,it,rt,!1,null,null,null),te=Zt.exports;h()(Zt,{VCol:Pt["a"],VContainer:g["a"],VRow:Ut["a"]});var ee=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{attrs:{id:"inspire"}},[a("v-content",[a("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"12",sm:"8",md:"4"}},[a("v-card",{staticClass:"elevation-12"},[a("v-toolbar",{attrs:{color:"black",dark:"",flat:""}},[a("v-toolbar-title",[t._v("ALCALI")]),a("v-spacer")],1),a("v-card-text",[a("v-form",[a("v-text-field",{attrs:{label:"Login",name:"login","prepend-icon":"person",type:"text"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),a("v-text-field",{attrs:{label:"Password",name:"password","prepend-icon":"lock",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"purple",dark:""},on:{click:function(e){return e.preventDefault(),t.authenticate(e)}}},[t._v("Login")])],1)],1)],1)],1)],1)],1)],1)},ae=[],ne={name:"Login",data:()=>({username:null,password:null}),methods:{authenticate(){let t=this.username,e=this.password;this.$store.dispatch("login",{username:t,password:e}).then(()=>this.$router.push("/")).catch(t=>console.log(t))}}},se=ne,ie=(a("84d3"),a("4bd4")),re=a("71d9"),oe=Object(u["a"])(se,ee,ae,!1,null,"f03e5ff6",null),le=oe.exports;h()(oe,{VApp:v["a"],VBtn:_["a"],VCard:ut["a"],VCardActions:mt["a"],VCardText:mt["b"],VCol:Pt["a"],VContainer:g["a"],VContent:y["a"],VForm:ie["a"],VRow:Ut["a"],VSpacer:E["a"],VTextField:O["a"],VToolbar:re["a"],VToolbarTitle:L["a"]});var ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("JobsTable")],1)],1)],1)},de=[],ue={name:"Jobs",components:{JobsTable:Yt}},me=ue,he=Object(u["a"])(me,ce,de,!1,null,"6cb6e902",null),ve=he.exports;h()(he,{VCol:Pt["a"],VContainer:g["a"],VRow:Ut["a"]});var fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("KeysTable",{key:t.refreshKey})],1)],1),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)},pe=[],be=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v("\n    Keys\n    "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion_id",headers:t.headers,items:t.keys,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.status",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.keysRepr(n.status),dark:""}},[t._v(t._s(n.status))])]}},{key:"item.action",fn:function(e){var n=e.item;return[t._l(t.keyAction(n.status),function(e){return[a("v-btn",{key:e,staticClass:"ma-2",attrs:{small:"",dark:"",color:t.keysRepr(e)},on:{click:function(a){return t.manageKey(e,n.minion_id)}}},[t._v("\n          "+t._s(e)+"\n        ")])]})]}}])})],1)},_e=[],ge={name:"KeysTable",data(){return{search:"",headers:[{text:"Minion Id",value:"minion_id"},{text:"Status",value:"status"},{text:"Public Key",value:"pub"},{text:"Actions",value:"action",sortable:!1}],keys:[],loading:!0}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/keys/").then(t=>{this.keys=t.data,this.loading=!1})},sleep(t){return new Promise(e=>setTimeout(e,t))},keysRepr(t){return t.startsWith("accept")?"green":t.startsWith("reject")?"orange":t.startsWith("den")?"red":"grey"},keyAction(t){return"accepted"===t?["reject","deny"]:"rejected"===t?["accept","deny"]:"denied"===t?["accept"]:["accept","deny"]},manageKey(t,e){let a=new FormData;a.set("action",t),a.set("target",e),this.$http.post("api/keys/manage_keys/",a).then(t=>{this.$toast(t.data.result)}),this.sleep(2e3).then(()=>{this.loadData()})}}},ye=ge,xe=Object(u["a"])(ye,be,_e,!1,null,"117cb766",null),ke=xe.exports;h()(xe,{VBtn:_["a"],VCard:ut["a"],VCardTitle:mt["c"],VChip:Et["a"],VDataTable:Gt["a"],VSpacer:E["a"],VTextField:O["a"]});var Ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-speed-dial",{attrs:{fixed:"",bottom:"",right:"",direction:"top",transition:"slide-y-reverse-transition"},scopedSlots:t._u([{key:"activator",fn:function(){return[a("v-btn",{attrs:{color:"primary",fab:""},model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[t.fab?a("v-icon",[t._v("close")]):a("v-icon",[t._v("menu")])],1)]},proxy:!0}]),model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[t._l(t.fabs,function(e){return[a("v-tooltip",{key:e.tooltip,attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(n){var s=n.on;return[a("v-btn",t._g({attrs:{fab:"",dark:"",small:"",color:e.color},on:{click:function(a){return t.emit("fab_action",e.action)}}},s),[a("v-icon",[t._v(t._s(e.icon))])],1)]}}],null,!0)},[a("span",[t._v(t._s(e.tooltip))])])]})],2)},Ve=[],je={name:"Fab",props:["fabs"],methods:{emit(t,e){this.$emit(t,e)}},data:()=>({fab:!1})},we=je,Se=a("c73b"),Te=Object(u["a"])(we,Ce,Ve,!1,null,"56c34fbd",null),$e=Te.exports;h()(Te,{VBtn:_["a"],VIcon:C["a"],VSpeedDial:Se["a"],VTooltip:F["a"]});var De={name:"Keys",components:{Fab:$e,KeysTable:ke},data:()=>({fabs:[{color:"pink",action:"refreshKeys",icon:"refresh",tooltip:"Refresh keys"},{color:"green",action:"acceptAll",icon:"playlist_play",tooltip:"Accept all keys"}],refreshKey:0}),methods:{fabAction(t){this[t]()},refreshKeys(){this.$toast("refreshing keys"),this.$http.post("/api/keys/refresh/").then(()=>{this.$toast("keys refreshed")}).then(()=>{this.refreshKey+=1}).catch(function(t){alert(t)})}}},Ee=De,Oe=Object(u["a"])(Ee,fe,pe,!1,null,"7496b064",null),Le=Oe.exports;h()(Oe,{VCol:Pt["a"],VContainer:g["a"],VRow:Ut["a"]});var Fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("MinionsTable",{key:t.refreshKey}),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)],1)],1)},Ae=[],Re=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("\n      Minions\n      "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion_id",headers:t.headers,items:t.minions,search:t.search,loading:t.loading,"loading-text":"Loading... Please wait"},scopedSlots:t._u([{key:"item.minion_id",fn:function(e){var n=e.item;return[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/minions/"+n.minion_id}},[t._v(t._s(n.minion_id))])]}},{key:"item.conformity",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(n.conformity),dark:""}},[t._v(t._s(null==n.conformity?"unknown":n.conformity)+"\n        ")])]}},{key:"item.last_job",fn:function(e){var a=e.item;return[t._v("\n        "+t._s(null===a.last_job?"":new Date(a.last_job).toLocaleString("en-GB"))+"\n      ")]}},{key:"item.last_highstate",fn:function(e){var a=e.item;return[t._v("\n        "+t._s(null===a.last_highstate?"":new Date(a.last_highstate).toLocaleString("en-GB"))+"\n      ")]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue",tile:"",dark:""},on:{click:function(e){return t.refreshMinion(n.minion_id)}}},[t._v("\n            refresh\n          ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue-grey",tile:"",dark:"",to:"/run?target="+n.minion_id}},[t._v("\n            run job\n          ")]),a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"red",tile:"",dark:""},on:{click:function(e){return e.stopPropagation(),t.showDialog(n.minion_id)}}},[t._v("\n            delete\n          ")])],1)]}}])})],1),a("div",{staticClass:"text-center"},[a("v-dialog",{attrs:{width:"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline red",attrs:{"primary-title":""}},[t._v("\n          Delete "+t._s(t.target)+" ?\n        ")]),a("v-card-text",[a("br"),t._v("\n          If you delete "+t._s(t.target)+" from the database, you will need to refresh all minions.\n        ")]),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.dialog=!1}}},[t._v("\n            close\n          ")]),a("v-btn",{attrs:{color:"red",text:""},on:{click:function(e){return t.deleteMinion(t.target)}}},[t._v("\n            delete\n          ")])],1)],1)],1)],1)],1)},Ie=[],Me={name:"MinionsTable",data(){return{search:"",dialog:!1,headers:[{text:"Minion Id",value:"minion_id"},{text:"Highstate Conformity",value:"conformity"},{text:"F.Q.D.N",value:"fqdn"},{text:"O.S",value:"os"},{text:"O.S Version",value:"oscodename"},{text:"Kernel",value:"kernelrelease"},{text:"Last Job",value:"last_job"},{text:"Last Highstate",value:"last_highstate"},{text:"Actions",value:"action",sortable:!1}],minions:[],target:null,loading:!0}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/minions/").then(t=>{function e(t){return t.forEach(t=>{let e=JSON.parse(t.grain);for(let a in e)t[a]=e[a]}),t}this.minions=e(t.data),this.loading=!1})},boolRepr(t){return!0===t?"green":!1===t?"red":"primary"},refreshMinion(t){this.$toast("refreshing "+t);let e=new FormData;e.set("minion_id",t),this.$http.post("/api/minions/refresh_minions/",e).then(t=>{this.$toast(t.data.result)})},deleteMinion(t){this.dialog=!1;let e=new FormData;e.set("minion_id",t),this.$http.delete("/api/minions/"+t).then(()=>{this.minions.splice(this.minions.indexOf(t),1),this.$toast(t+" deleted")})},showDialog(t){this.target=t,this.dialog=!0}}},Pe=Me,Ue=a("169a"),Je=Object(u["a"])(Pe,Re,Ie,!1,null,"8a9b3a64",null),Ne=Je.exports;h()(Je,{VBtn:_["a"],VCard:ut["a"],VCardActions:mt["a"],VCardText:mt["b"],VCardTitle:mt["c"],VChip:Et["a"],VContainer:g["a"],VDataTable:Gt["a"],VDialog:Ue["a"],VDivider:x["a"],VSpacer:E["a"],VTextField:O["a"]});var qe={name:"Minions",components:{Fab:$e,MinionsTable:Ne},data:()=>({refreshKey:0,fabs:[{color:"pink",action:"refreshMinions",icon:"refresh",tooltip:"Refresh all minions"},{color:"orange",action:"runAll",icon:"playlist_play",tooltip:"Run job on all minions"}]}),methods:{fabAction(t){this[t]()},refreshMinions(){this.$toast("refreshing minions"),this.$http.post("/api/minions/refresh_minions/").then(()=>{this.$toast("minions refreshed")}).then(()=>{this.refreshKey+=1}).catch(function(t){alert(t)})},runAll(){this.$router.push("/run/?target=*")}}},ze=qe,Be=Object(u["a"])(ze,Fe,Ae,!1,null,"b02a397c",null),Ke=Be.exports;h()(Be,{VCol:Pt["a"],VContainer:g["a"],VRow:Ut["a"]});var He=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"3"}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{lg:"12"}},[null!==t.minion?a("InfosCard",{attrs:{minion:t.minion}}):t._e()],1)],1),a("v-row",[a("v-col",{attrs:{lg:"12"}},[null!==t.minion?a("NetworkCard",{attrs:{minion:t.minion}}):t._e()],1)],1)],1),a("v-col",{attrs:{sm:"12",lg:"9"}},[null!==t.minion?a("MinionDetailCard",{attrs:{minion:t.minion}}):t._e()],1)],1)],1)},Ge=[],We=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v("Infos")]),a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#common"}},[t._v("\n      Common\n    ")]),a("v-tab",{attrs:{href:"#salt"}},[t._v("\n      Salt\n    ")]),a("v-tab",{attrs:{href:"#hardware"}},[t._v("\n      Hardware\n    ")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"common"}},[a("v-simple-table",[a("tbody",t._l(t.common,function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion[e.grain]))])])}),0)])],1),a("v-tab-item",{attrs:{id:"salt"}},[a("v-simple-table",[a("tbody",t._l(t.salt,function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion[e.grain]))])])}),0)])],1),a("v-tab-item",{attrs:{id:"hardware"}},[a("v-simple-table",[a("tbody",t._l(t.hardware,function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion[e.grain]))])])}),0)])],1)],1)],1)},Ye=[],Qe={name:"InfosCard",data(){return{tab:null,common:[{name:"F.Q.D.N",grain:"fqdn"},{name:"O.S",grain:"os"},{name:"O.S Version",grain:"oscodename"},{name:"Kernel",grain:"kernelrelease"},{name:"Last Job",grain:"last_job"},{name:"Last Highstate",grain:"last_highstate"},{name:"Conformity",grain:"conformity"}],salt:[{name:"ID",grain:"id"},{name:"Master",grain:"master"},{name:"Salt Version",grain:"saltversion"},{name:"Salt Path",grain:"saltpath"},{name:"Python Version",grain:"pythonversion"}],hardware:[{name:"C.P.U Model",grain:"cpu_model"},{name:"Number of C.P.U",grain:"num_cpus"},{name:"Total Memory",grain:"mem_total"},{name:"Total Swap",grain:"swap_total"},{name:"Virtual",grain:"virtual"}]}},props:["minion"]},Xe=Qe,Ze=a("71a3"),ta=a("c671"),ea=a("fe57"),aa=a("aac8"),na=a("9a96"),sa=Object(u["a"])(Xe,We,Ye,!1,null,"73ecf196",null),ia=sa.exports;h()(sa,{VCard:ut["a"],VCardTitle:mt["c"],VSimpleTable:ht["a"],VTab:Ze["a"],VTabItem:ta["a"],VTabs:ea["a"],VTabsItems:aa["a"],VTabsSlider:na["a"]});var ra=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v("Network")]),a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#interface"}},[t._v("\n      Interfaces\n    ")]),a("v-tab",{attrs:{href:"#mac"}},[t._v("\n      Mac\n    ")]),a("v-tab",{attrs:{href:"#dns"}},[t._v("\n      Dns\n    ")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"interface"}},[a("v-simple-table",[a("tbody",[t._l(t.minion.ip_interfaces,function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),t._l(e,function(e){return a("td",{staticClass:"text-right"},[t._v(t._s(e))])})],2)}),a("tr",[a("td",[t._v("IPv4 GATEWAY")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion.ip4_gw))])]),a("tr",[a("td",[t._v("IPv6 GATEWAY")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.minion.ip6_gw))])])],2)])],1),a("v-tab-item",{attrs:{id:"mac"}},[a("v-simple-table",[a("tbody",t._l(t.minion.hwaddr_interfaces,function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),a("td",{staticClass:"text-right"},[t._v(t._s(e))])])}),0)])],1),a("v-tab-item",{attrs:{id:"dns"}},[a("v-simple-table",[a("tbody",t._l(t.minion.dns,function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),a("td",{staticClass:"text-right"},[t._v(t._s(e.length>=1?e:""))])])}),0)])],1)],1)],1)},oa=[],la={name:"NetworkCard",data(){return{tab:null,tabs:3}},props:["minion"]},ca=la,da=Object(u["a"])(ca,ra,oa,!1,null,"60a108be",null),ua=da.exports;h()(da,{VCard:ut["a"],VCardTitle:mt["c"],VSimpleTable:ht["a"],VTab:Ze["a"],VTabItem:ta["a"],VTabs:ea["a"],VTabsItems:aa["a"],VTabsSlider:na["a"]});var ma=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#grain"}},[t._v("\n      Grains\n    ")]),a("v-tab",{attrs:{href:"#pillar"}},[t._v("\n      Pillar\n    ")]),a("v-tab",{attrs:{href:"#history"}},[t._v("\n      History\n    ")]),a("v-tab",{attrs:{href:"#graph"}},[t._v("\n      Graph\n    ")]),t._l(t.minion.custom_fields,function(e){return a("v-tab",{key:e.name},[t._v("\n      "+t._s(e.name)+"\n    ")])})],2),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"grain"}},[a("codemirror",{attrs:{options:t.cmOptions},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),a("v-tab-item",{attrs:{id:"pillar"}},[a("codemirror",{attrs:{options:t.cmOptions},model:{value:t.codepillar,callback:function(e){t.codepillar=e},expression:"codepillar"}})],1),a("v-tab-item",{attrs:{id:"history"}},[a("JobsTable",{attrs:{filter:{"target[]":t.minion.minion_id}}})],1),a("v-tab-item",{attrs:{id:"graph",eager:""}},[t.minion?a("JobsChartCard",{attrs:{minion:t.minion.minion_id}}):t._e()],1),t._l(t.minion.custom_fields,function(e){return a("v-tab-item",{key:e.name},[a("codemirror",{attrs:{options:t.cmOptions,value:t.yamlRepr(e.value)}})],1)})],2)],1)},ha=[],va=a("8f94"),fa=(a("f4ba"),a("4895"),a("aedd"),a("cbc8"),a("8d70"),a("f9d4"),a("a7be"),a("ced0"),a("efe9"),a("651e")),pa=a.n(fa),ba={name:"MinionDetailCard",components:{JobsTable:Yt,JobsChartCard:wt,codemirror:va["codemirror"]},data(){return{tab:null,code:pa.a.safeDump(JSON.parse(this.minion.grain)),codepillar:pa.a.safeDump(JSON.parse(this.minion.pillar)),cmOptions:{tabSize:4,mode:"yaml",theme:"made-of-code",line:!0,autoRefresh:!0,lineNumbers:!1,readOnly:!0,cursorBlinkRate:0,foldGutter:!0,gutters:["CodeMirror-foldgutter"]}}},methods:{yamlRepr(t){return pa.a.safeDump(JSON.parse(t))}},props:["minion"]},_a=ba,ga=Object(u["a"])(_a,ma,ha,!1,null,"0210d97e",null),ya=ga.exports;function xa(t){let e=JSON.parse(t.grain);for(let a in e)t[a]=e[a];return t}h()(ga,{VCard:ut["a"],VTab:Ze["a"],VTabItem:ta["a"],VTabs:ea["a"],VTabsItems:aa["a"],VTabsSlider:na["a"]});var ka={name:"MinionDetail",components:{MinionDetailCard:ya,InfosCard:ia,NetworkCard:ua},data(){return{minion:null}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/minions/"+this.minion_id+"/").then(t=>this.minion=xa(t.data))}},props:["minion_id"]},Ca=ka,Va=Object(u["a"])(Ca,He,Ge,!1,null,"63462b13",null),ja=Va.exports;h()(Va,{VCol:Pt["a"],VContainer:g["a"],VRow:Ut["a"]});var wa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"4"}},[a("v-card",[a("v-list-item",{attrs:{"two-line":""}},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"headline"},[t._v(t._s(t.job.fun))]),a("v-list-item-subtitle",[t._v("Run "+t._s(t.formatDate(t.job.alter_time)))])],1)],1),a("v-divider"),a("v-simple-table",[a("tbody",[a("tr",[a("td",[t._v("FUNCTION:")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.job.fun))])]),a("tr",[a("td",[t._v("JID:")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.job.jid))])]),t.job.arguments.length>0?a("tr",[a("td",[t._v("ARGUMENTS:")]),a("td",{staticClass:"text-right"},t._l(t.job.arguments,function(e){return a("span",[t._v(t._s(e))])}),0)]):t._e(),a("tr",[a("td",[t._v("MINION ID:")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.job.id))])]),a("tr",[a("td",[t._v("STATUS:")]),a("td",{staticClass:"text-right"},[a("v-chip",{attrs:{color:t.boolRepr(t.job.success),dark:""}},[t._v(t._s(t.boolText(t.job.success)))])],1)]),a("tr",[a("td",[t._v("START TIME:")]),a("td",{staticClass:"text-right"},[t._v(t._s(new Date(t.job.alter_time).toLocaleString("en-GB")))])])])])],1)],1),a("v-col",{attrs:{sm:"12",lg:"8"}},[a("v-card",[a("v-card-title",[t._v("Results")]),a("v-divider"),a("div",{staticClass:"ansiStyle",domProps:{innerHTML:t._s(t.ansiResult)}})],1)],1)],1)],1)},Sa=[],Ta={name:"JobDetail",props:["jid","minion_id"],data(){return{job:{},ansiResult:null}},mounted(){this.loadData(),this.loadRenderedJob()},methods:{loadData(){this.$http.get(`api/jobs/${this.jid}/${this.minion_id}/`).then(t=>this.job=t.data)},loadRenderedJob(){this.$http.get(`api/jobs/${this.jid}/${this.minion_id}/rendered_state/`).then(t=>this.ansiResult=t.data)},boolRepr(t){return!0===t?"green":"red"},boolText(t){return!0===t?"success":"failed"},formatDate(t){return new Date(t).toLocaleString("en-GB")}}},$a=Ta,Da=(a("6141"),Object(u["a"])($a,wa,Sa,!1,null,"69dabf93",null)),Ea=Da.exports;h()(Da,{VCard:ut["a"],VCardTitle:mt["c"],VChip:Et["a"],VCol:Pt["a"],VContainer:g["a"],VDivider:x["a"],VListItem:j["a"],VListItemContent:T["a"],VListItemSubtitle:T["b"],VListItemTitle:T["c"],VRow:Ut["a"],VSimpleTable:ht["a"]});var Oa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-lg":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{lg12:""}},[a("EventsTable")],1)],1)],1)},La=[],Fa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v("\n    Events\n    "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"alter_time","sort-desc":"",headers:t.headers,items:t.events,search:t.search,"show-expand":"",loading:t.loading},scopedSlots:t._u([{key:"item.alter_time",fn:function(e){var a=e.item;return[t._v("\n      "+t._s(new Date(a.alter_time).toLocaleString("en-GB"))+"\n    ")]}},{key:"expanded-item",fn:function(e){var n=e.headers,s=e.item;return[a("td",{attrs:{colspan:n.length}},[a("pre",[t._v(t._s(JSON.stringify(JSON.parse(s.data),null,2)))])])]}}])})],1)},Aa=[];function Ra(t){return t.forEach(t=>{let e=JSON.parse(t.data);for(let a in e)"id"===a?t["minion_id"]=e[a]:t[a]=e[a]}),t}var Ia={name:"EventsTable",data(){return{search:"",headers:[{text:"Tag",value:"tag"},{text:"Jid",value:"jid"},{text:"Target",value:"minion_id"},{text:"Function",value:"fun"},{text:"Arguments",value:"fun_args"},{text:"Date",value:"alter_time"}],events:[],loading:!0}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/events/").then(t=>{this.events=Ra(t.data),this.loading=!1})}}},Ma=Ia,Pa=Object(u["a"])(Ma,Fa,Aa,!1,null,"231b16fe",null),Ua=Pa.exports;h()(Pa,{VCard:ut["a"],VCardTitle:mt["c"],VDataTable:Gt["a"],VSpacer:E["a"],VTextField:O["a"]});var Ja={name:"Events",components:{EventsTable:Ua}},Na=Ja,qa=a("0e8f"),za=a("a722"),Ba=Object(u["a"])(Na,Oa,La,!1,null,"ef80b656",null),Ka=Ba.exports;h()(Ba,{VContainer:g["a"],VFlex:qa["a"],VLayout:za["a"]});var Ha=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("RunCard")],1)],1)],1)},Ga=[],Wa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("v-card",[a("v-card-title",[t._v("Run")]),a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#formatted"}},[t._v("\n            Formatted\n          ")]),a("v-tab",{attrs:{href:"#cli"}},[t._v("\n            Cli\n          ")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{attrs:{id:"formatted",eager:""}},[a("v-card",[a("v-spacer"),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{staticClass:"text-right",attrs:{cols:"12",sm:"6",lg:"1","align-self":"center"}},[a("span",[t._v("Client Type:")])]),a("v-col",{attrs:{cols:"12",sm:"6",lg:"2"}},[a("v-select",{attrs:{items:t.client},model:{value:t.selected_client,callback:function(e){t.selected_client=e},expression:"selected_client"}})],1)],1),a("v-row",[a("v-col",{attrs:{lg:"1"}},["local"===t.selected_client?a("v-select",{attrs:{items:t.target_type,label:"Target Type"},on:{change:function(e){t.target=null}},model:{value:t.selected_target_type,callback:function(e){t.selected_target_type=e},expression:"selected_target_type"}}):t._e()],1),a("v-col",{attrs:{lg:"2"}},["local"===t.selected_client&&"custom"===t.selected_target_type?a("v-text-field",{attrs:{label:"Target"},model:{value:t.target,callback:function(e){t.target=e},expression:"target"}}):t._e(),"local"===t.selected_client&&"single"===t.selected_target_type?a("v-select",{attrs:{items:t.minions},model:{value:t.target,callback:function(e){t.target=e},expression:"target"}}):t._e()],1),a("v-col",{attrs:{lg:"2"}},[a("v-combobox",{attrs:{"item-value":"name","item-text":"name",items:t.filteredFunction,label:"Function","return-object":""},scopedSlots:t._u([t.selectedFunction?{key:"append-outer",fn:function(){return[a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-icon",t._g({attrs:{color:"black"}},n),[t._v("info\n                              ")])]}}],null,!1,1349456046)},[a("div",{staticClass:"desc"},[a("pre",[t._v(t._s(t.selectedFunction.description))])])])]},proxy:!0}:null],null,!0),model:{value:t.selectedFunction,callback:function(e){t.selectedFunction=e},expression:"selectedFunction"}})],1),a("v-col",{attrs:{lg:"2"}},[a("v-text-field",{attrs:{label:"Arguments"},model:{value:t.args,callback:function(e){t.args=e},expression:"args"}})],1),a("v-col",{attrs:{lg:"2"}},[a("v-text-field",{attrs:{label:"Keyword"}})],1),a("v-col",{attrs:{lg:"2"}},[a("v-text-field",{attrs:{label:"Argument"}})],1)],1),a("v-row",[a("v-col",{attrs:{lg:"2"}},[a("v-switch",{attrs:{label:"Schedule",color:"primary"},model:{value:t.scheduleSwitch,callback:function(e){t.scheduleSwitch=e},expression:"scheduleSwitch"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.scheduleSwitch,expression:"scheduleSwitch"}]},[t._v("\n                          Every "),a("span",{attrs:{id:"cron"}})])],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"orange",large:"",dark:""},on:{click:function(e){t.dialog=!1}}},[t._v("Test")]),a("v-btn",{attrs:{color:"info",large:"",dark:""},on:{click:t.runJob}},[t._v("Run")])],1)],1)],1),a("v-tab-item",{attrs:{id:"cli"}},[null!==t.functions?a("TerminalCard",{attrs:{minions:t.minions,functions:t.functions}}):t._e()],1)],1)],1)],1)],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{sm:"12"}},[t.results?a("v-card",[a("v-card-title",[t._v("Results")]),a("v-card-text",{staticClass:"ansiStyle",domProps:{innerHTML:t._s(t.results)}})],1):t._e()],1)],1)],1)},Ya=[],Qa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-row",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}]},[a("v-col",{attrs:{sm:"12"}},[a("div",{staticClass:"console",attrs:{id:"terminal"}})])],1)},Xa=[],Za=a("59bf"),tn=a("1233"),en=(a("7449"),a("9368"),a("c554")),an={name:"TerminalCard",props:["minions","functions"],data(){return{term:null,functions_name:null}},methods:{initTerm(){let t=document.getElementById("terminal");Za["Terminal"].applyAddon(en),this.term=new Za["Terminal"]({cursorBlink:!0,fontSize:20,fontFamily:"'Roboto Mono', monospace"}),this.term.open(t);const e=new tn["a"](this.term);e.addAutocompleteHandler(t=>{return 0!==t?[]:["salt","clear"]}),e.addAutocompleteHandler(t=>{return 1!==t?[]:this.minions}),e.addAutocompleteHandler(t=>{return 2!==t?[]:this.functions.map(t=>t.name)});const a="Usage: salt [options] '<target>' <function> [arguments]",n=()=>{e.read(" ~$ ").then(t=>{if(t.split(" ").filter(t=>{return""!==t}).length<1)e.println(a),n();else if(1===t.split(" ").length)"clear"===t&&this.term.clear();else if(t.split(" ").length>=3){let a=new FormData;a.set("raw",!0),a.set("command",t),this.$toast("Running "+t),this.$http.post("api/run/",a).then(t=>{e.println(t.data.results)}).then(()=>n())}else e.println(a),n()})};n()},onResize(){null!==this.term&&this.term.fit()}},mounted(){setTimeout(()=>{this.initTerm()},100)},beforeDestroy(){null!==this.term&&this.term.destroy()}},nn=an,sn=a("269a"),rn=a.n(sn),on=a("dc22"),ln=Object(u["a"])(nn,Qa,Xa,!1,null,"55ceee2f",null),cn=ln.exports;function dn(t,e){if(t instanceof HTMLElement)this.el=t;else{if("string"!==typeof t)throw"CronUI: container parameter in initialization must be an html element or a string selector.";this.el=document.querySelector(t)}this.options=e||{},this.render(),"string"!==typeof this.options.initial&&(this.options.initial="* * * * *"),this.setCronString(this.options.initial),this.currentValue=this.options.initial}h()(ln,{VCol:Pt["a"],VRow:Ut["a"]}),rn()(ln,{Resize:on["a"]}),dn.prototype.render=function(){let t,e,a,n=this.el,s="";for(a=0;a<60;a++)e=a<10?"0":"",s+="<option value='"+a+"'>"+e+a+"</option>\n";let i="";for(a=0;a<24;a++)e=a<10?"0":"",i+="<option value='"+a+"'>"+e+a+"</option>\n";let r="";for(a=1;a<32;a++)t=1==a||21==a||31==a?"st":2==a||22==a?"nd":3==a||23==a?"rd":"th",r+="<option value='"+a+"'>"+a+t+"</option>\n";let o="";const l=["January","February","March","April","May","June","July","August","September","October","November","December"];for(a=0;a<l.length;a++)o+="<option value='"+(a+1)+"'>"+l[a]+"</option>\n";let c="";const d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(a=0;a<d.length;a++)c+="<option value='"+a+"'>"+d[a]+"</option>\n";let u="";const m=["minute","hour","day","week","month","year"];for(a=0;a<m.length;a++)u+="<option value='"+m[a]+"'>"+m[a]+"</option>\n";let h={};n.insertAdjacentHTML("beforeend","<span class='cron-period'><select>"+u+"</select></span>");let v=n.querySelector(".cron-period select");v.addEventListener("change",this.periodChanged.bind(this)),v.addEventListener("change",this.changeEvent.bind(this)),n.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-dom'> on the <select name='cron-dom'>"+r+"</select> </span>"),h["dom"]=n.querySelector(".cron-block-dom"),n.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-month'> of <select name='cron-month'>"+o+"</select> </span>"),h["month"]=n.querySelector(".cron-block-month"),n.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-mins'> at <select name='cron-mins'>"+s+"</select> minutes past the hour </span>"),h["mins"]=n.querySelector(".cron-block-mins"),n.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-dow'> on <select name='cron-dow'>"+c+"</select> </span>"),h["dow"]=n.querySelector(".cron-block-dow"),n.insertAdjacentHTML("beforeend","<span class='cron-block cron-block-time'> at <select name='cron-time-hour' class='cron-time-hour'>"+i+"</select>:<select name='cron-time-min' class='cron-time-min'>"+s+" </span>"),h["time"]=n.querySelector(".cron-block-time");for(let f in h)[].forEach.call(h[f].querySelectorAll("select"),function(t){t.addEventListener("change",this.changeEvent.bind(this))}.bind(this));this.blocks=h},dn.prototype.periodChanged=function(){let t=this.blocks,e=this.el.querySelector(".cron-period select"),a=e.options[e.selectedIndex].value;for(let n in t)t[n].style.display="none";if(dn.displayMatrix.hasOwnProperty(a)){let e=dn.displayMatrix[a];for(let a=0;a<e.length;a++)t[e[a]].style.display=""}},dn.prototype.changeEvent=function(){this.currentValue=this.getCronString(),"function"===typeof this.options.changeEvent&&this.options.changeEvent(this.currentValue)},dn.prototype.getCronString=function(){let t,e,a,n,s;t=e=a=n=s="*";let i=this.blocks,r=function(t){return t.options[t.selectedIndex].value},o=r(this.el.querySelector(".cron-period select"));switch(o){case"minute":break;case"hour":t=r(i["mins"].querySelector("select"));break;case"day":t=r(i["time"].querySelector(".cron-time-min")),e=r(i["time"].querySelector(".cron-time-hour"));break;case"week":t=r(i["time"].querySelector(".cron-time-min")),e=r(i["time"].querySelector(".cron-time-hour")),s=r(i["dow"].querySelector("select"));break;case"month":t=r(i["time"].querySelector(".cron-time-min")),e=r(i["time"].querySelector(".cron-time-hour")),a=r(i["dom"].querySelector("select"));break;case"year":t=r(i["time"].querySelector(".cron-time-min")),e=r(i["time"].querySelector(".cron-time-hour")),a=r(i["dom"].querySelector("select")),n=r(i["month"].querySelector("select"));break;default:return o}return[t,e,a,n,s].join(" ")},dn.prototype.setCronString=function(t){let e=this.blocks,a=dn.getCronType(t);if(!a)return!1;let n=t.split(" "),s={mins:n[0],hour:n[1],dom:n[2],month:n[3],dow:n[4]},i=dn.displayMatrix[a];for(let r=0;r<i.length;r++){let t=i[r];"time"==t?(e[t].querySelector(".cron-time-hour").value=s["hour"],e[t].querySelector(".cron-time-min").value=s["mins"]):e[t].querySelector("select").value=s[t]}return this.el.querySelector(".cron-period select").value=a,this.periodChanged(),this},dn.displayMatrix={minute:[],hour:["mins"],day:["time"],week:["dow","time"],month:["dom","time"],year:["dom","month","time"]},dn.cronTypes={minute:/^(\*\s){4}\*$/,hour:/^\d{1,2}\s(\*\s){3}\*$/,day:/^(\d{1,2}\s){2}(\*\s){2}\*$/,week:/^(\d{1,2}\s){2}(\*\s){2}\d{1,2}$/,month:/^(\d{1,2}\s){3}\*\s\*$/,year:/^(\d{1,2}\s){4}\*$/},dn.getCronType=function(t){t=t||this.getCronString();const e=/^((\d{1,2}|\*)\s){4}(\d{1,2}|\*)$/;if("string"!=typeof t||!e.test(t))return;let a=t.split(" "),n=[0,0,1,1,0],s=[59,23,31,12,6];for(var i=0;i<a.length;i++)if("*"!=a[i]){var r=parseInt(a[i]);if(!(r<=s[i]&&r>=n[i]))return}for(let o in dn.cronTypes)if(dn.cronTypes[o].test(t))return o};var un=dn,mn={name:"RunCard",components:{TerminalCard:cn},data(){return{scheduleSwitch:!1,tab:null,client:[{text:"Local",value:"local"},{text:"Local Runner",value:"runner"},{text:"Wheel",value:"wheel"}],selected_client:"local",minions:[],functions:null,selectedFunction:null,description:null,target_type:[{text:"Single",value:"single"},{text:"Group",value:"group"},{text:"Custom",value:"custom"}],selected_target_type:"custom",target:"",args:"",kwargs:{},results:"",termKey:0,cron:null}},methods:{loadData(){this.$http.get("api/functions/").then(t=>{this.functions=t.data}),this.$http.get("api/minions/").then(t=>{t.data.forEach(t=>this.minions.push(t.minion_id))})},runJob(){let t=new FormData,e="Running";t.set("client",this.selected_client),t.set("target",this.target),t.set("function",this.selectedFunction.name||this.selectedFunction),t.set("args",this.args),this.scheduleSwitch&&(e="Scheduling",t.set("schedule","true"),t.set("cron",this.cron.currentValue)),this.$toast(e+" "+this.selectedFunction.name+" on "+this.target),this.$http.post("api/run/",t).then(t=>{this.results=t.data+this.results})},fitTerminal(){}},computed:{filteredFunction:function(){if(null!==this.functions)return this.functions.filter(t=>{return t.type===this.selected_client})}},mounted(){this.cron=new un("#cron",{initial:"* * * * *"}),this.loadData(),this.target=this.$route.query.target,this.selectedFunction=!0===this.$route.query.hasOwnProperty("function")?{name:this.$route.query.function}:this.selectedFunction,this.args=this.$route.query.args}},hn=mn,vn=(a("3ba7"),a("2b5d")),fn=a("b73d"),pn=Object(u["a"])(hn,Wa,Ya,!1,null,"14abbd07",null),bn=pn.exports;h()(pn,{VBtn:_["a"],VCard:ut["a"],VCardActions:mt["a"],VCardText:mt["b"],VCardTitle:mt["c"],VCol:Pt["a"],VCombobox:vn["a"],VContainer:g["a"],VIcon:C["a"],VMenu:$["a"],VRow:Ut["a"],VSelect:Vt["a"],VSpacer:E["a"],VSwitch:fn["a"],VTab:Ze["a"],VTabItem:ta["a"],VTabs:ea["a"],VTabsItems:aa["a"],VTabsSlider:na["a"],VTextField:O["a"]});var _n={name:"Run",components:{RunCard:bn}},gn=_n,yn=Object(u["a"])(gn,Ha,Ga,!1,null,"678aae2e",null),xn=yn.exports;h()(yn,{VCol:Pt["a"],VContainer:g["a"],VRow:Ut["a"]});var kn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("CommonSettings")],1)],1),a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("UserSettings")],1)],1)],1)},Cn=[],Vn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("v-card",[a("v-card-title",[t._v("Common Settings")]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{lg:"2","align-self":"center"}},[t._v("\n              Parse modules from:\n            ")]),a("v-col",{attrs:{lg:"2"}},[a("v-select",{attrs:{items:t.minions,"item-text":"minion_id","item-value":"minion_id",label:"Target"},model:{value:t.target,callback:function(e){t.target=e},expression:"target"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:null==t.target,color:"primary"},on:{click:t.parseModules}},[t._v("Submit")])],1)],1),a("v-row",[a("v-col",{attrs:{sm:"12",lg:"6"}},[a("v-row",[t._v("Minions Fields")]),t._l(t.uniqueMinionField,function(e){return a("v-row",{key:e.name},[a("v-col",{attrs:{lg:"4"}},[a("b",[t._v(t._s(e.name))])]),a("v-col",{attrs:{lg:"4"}},[t._v(t._s(e["function"]))]),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{color:"red",dark:""},on:{click:function(a){return t.deleteMinionsFields(e.name)}}},[t._v("Delete")])],1)],1)}),a("v-row",[a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Name","single-line":""},model:{value:t.minionsfields_name,callback:function(e){t.minionsfields_name=e},expression:"minionsfields_name"}})],1),a("v-col",{attrs:{lg:"4"}},[a("v-combobox",{attrs:{items:t.functions,"item-value":"name","item-text":"name",label:"Functions"},model:{value:t.minionsfields_value,callback:function(e){t.minionsfields_value=e},expression:"minionsfields_value"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:null==t.minionsfields_name||null==t.minionsfields_value,color:"primary"},on:{click:t.createMinionsFields}},[t._v("Create\n                  ")])],1)],1)],2),a("v-col",{attrs:{sm:"12",lg:"6"}},[a("v-row",[t._v("Custom Conformity")]),t._l(t.conformity,function(e){return a("v-row",{key:e.id},[a("v-col",{attrs:{lg:"4"}},[a("b",[t._v(t._s(e.name))])]),a("v-col",{attrs:{lg:"4"}},[t._v(t._s(e.function))]),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{color:"red",dark:""},on:{click:function(a){return t.deleteConformity(e.id)}}},[t._v("Delete")])],1)],1)}),a("v-row",[a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Name","single-line":""},model:{value:t.conformity_name,callback:function(e){t.conformity_name=e},expression:"conformity_name"}})],1),a("v-col",{attrs:{lg:"4"}},[a("v-text-field",{attrs:{label:"Function","single-line":""},model:{value:t.conformity_value,callback:function(e){t.conformity_value=e},expression:"conformity_value"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:null==t.conformity_name||null===t.conformity_value,color:"primary"},on:{click:t.createConformity}},[t._v("Create\n                  ")])],1)],1)],2)],1)],1)],1)],1)],1)],1)},jn=[],wn={name:"CommonSettings",data(){return{minions:null,target:null,functions:null,minionsfields:[],minionsfields_name:null,minionsfields_value:null,conformity:null,conformity_name:null,conformity_value:null}},mounted(){this.loadData()},computed:{uniqueMinionField(){if(null!==this.minionsfields)return this.minionsfields.filter((t,e,a)=>e===a.findIndex(e=>e["function"]===t["function"]&&e.name===t.name))}},methods:{loadData(){this.$http.get("api/minions/").then(t=>{this.minions=t.data}),this.$http.get("api/functions/").then(t=>{this.functions=t.data.filter(t=>"local"===t.type)}),this.$http.get("api/conformity/").then(t=>{this.conformity=t.data}),this.$http.get("api/minionsfields/").then(t=>{this.minionsfields=t.data})},parseModules(){this.$toast("Parse module started");let t=new FormData;t.set("target",this.target),this.$http.post("api/settings/initdb",t).then(t=>{this.$toast(t.data.result)})},deleteConformity(t){let e=new FormData;e.set("id",t),this.$http.delete("/api/conformity/"+t).then(()=>{this.$toast("conformity deleted"),this.conformity.splice(this.conformity.indexOf(t),1)})},createConformity(){let t=new FormData;t.set("name",this.conformity_name),t.set("function",this.conformity_value),this.$http.post("/api/conformity/",t).then(()=>{this.conformity.push({name:this.conformity_name,function:this.conformity_value,id:this.conformity.length+2}),this.$toast("conformity created"),this.conformity_name=null,this.conformity_value=null})},createMinionsFields(){let t=new FormData;t.set("name",this.minionsfields_name),t.set("function",this.minionsfields_value.name),t.set("value","{}"),this.$http.post("/api/minionsfields/",t).then(()=>{this.minionsfields.push({name:this.minionsfields_name,function:this.minionsfields_value.name}),this.$toast("minions fields created"),this.minionsfields_name=null,this.minionsfields_value=null})},deleteMinionsFields(t){let e=new FormData;e.set("name",t),this.$http.post("/api/minionsfields/delete_field/",e).then(e=>{this.$toast(e.data.result),this.minionsfields=this.minionsfields.filter(e=>e.name!==t)})}}},Sn=wn,Tn=Object(u["a"])(Sn,Vn,jn,!1,null,"47ec1e25",null),$n=Tn.exports;h()(Tn,{VBtn:_["a"],VCard:ut["a"],VCardText:mt["b"],VCardTitle:mt["c"],VCol:Pt["a"],VCombobox:vn["a"],VContainer:g["a"],VRow:Ut["a"],VSelect:Vt["a"],VTextField:O["a"]});var Dn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("v-card",[a("v-card-title",[t._v("User Settings")]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"6"}},[a("span",[t._v("Jobs Notifications")]),t._l(t.notifs,function(e,n){return a("div",{key:n},[a("v-switch",{attrs:{label:n,"hide-details":""},model:{value:t.notifs[n],callback:function(e){t.$set(t.notifs,n,e)},expression:"notifs[name]"}})],1)})],2),a("v-col",{attrs:{sm:"6"}},[a("span",[t._v("Max Notifications")]),a("v-text-field",{model:{value:t.max_notifs,callback:function(e){t.max_notifs=e},expression:"max_notifs"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:t.updateUserSettings}},[t._v("Submit")])],1)],1)],1)],1)},En=[],On={name:"UserSettings",data(){return{switch1:!0,switch2:!1,notifs:{created:!1,published:!0,returned:!1,event:!1},settings:null,max_notifs:null}},methods:{loadData(){this.$http.get("api/userssettings/"+this.$store.getters.user_id+"/").then(t=>{this.settings=t.data,this.max_notifs=t.data.max_notifs,Object.keys(this.notifs).forEach(t=>{this.notifs[t]=this.settings["notifs_"+t]})})},updateUserSettings(){let t={max_notifs:this.max_notifs};Object.keys(this.notifs).forEach(e=>{t["notifs_"+e]=this.notifs[e]}),this.$http.patch("api/userssettings/"+this.$store.getters.user_id+"/",t).then(t=>{this.$toast("user settings updated")})}},mounted(){this.loadData()}},Ln=On,Fn=Object(u["a"])(Ln,Dn,En,!1,null,"0a25bd55",null),An=Fn.exports;h()(Fn,{VBtn:_["a"],VCard:ut["a"],VCardActions:mt["a"],VCardText:mt["b"],VCardTitle:mt["c"],VCol:Pt["a"],VContainer:g["a"],VRow:Ut["a"],VSpacer:E["a"],VSwitch:fn["a"],VTextField:O["a"]});var Rn={name:"Settings",components:{UserSettings:An,CommonSettings:$n}},In=Rn,Mn=Object(u["a"])(In,kn,Cn,!1,null,"7ed5729c",null),Pn=Mn.exports;h()(Mn,{VCol:Pt["a"],VContainer:g["a"],VRow:Ut["a"]});var Un=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("ConformityTable")],1)],1)],1)},Jn=[],Nn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v("\n    Conformity\n    "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion_id","item-key":"minion_id",headers:t.headers,items:t.conformity,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.minion_id",fn:function(e){var n=e.item;return[a("v-btn",{staticClass:"text-none",attrs:{text:"",small:"",to:"/conformity/"+n.minion_id}},[t._v(t._s(n.minion_id))])]}},{key:"item.last_highstate",fn:function(e){var a=e.item;return[t._v("\n      "+t._s(null===a.last_highstate?"":new Date(a.last_highstate).toLocaleString("en-GB"))+"\n    ")]}},{key:"item.conformity",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(n.conformity),dark:""}},[t._v(t._s(null==n.conformity?"unknown":n.conformity)+"\n      ")])]}},{key:"item.succeeded",fn:function(e){var n=e.item;return[null!=n.succeeded?a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",color:"green","text-color":"base"}},[t._v("\n        "+t._s(n.succeeded)+"\n      ")]):t._e()]}},{key:"item.unchanged",fn:function(e){var n=e.item;return[null!=n.unchanged?a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",color:"orange","text-color":"base"}},[t._v("\n        "+t._s(n.unchanged)+"\n      ")]):t._e()]}},{key:"item.failed",fn:function(e){var n=e.item;return[null!=n.failed?a("v-chip",{staticClass:"ma-2",attrs:{label:"",outlined:"",color:"red","text-color":"base"}},[t._v("\n        "+t._s(n.failed)+"\n      ")]):t._e()]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"blue",tile:"",dark:"",to:"/conformity/"+n.minion_id}},[t._v("\n          detail\n        ")])],1)]}}])})],1)},qn=[],zn={name:"ConformityTable",data(){return{search:"",headers:[],conformity:[],loading:!0}},mounted(){this.loadData()},methods:{loadData(){this.$http.get("api/conformity/render").then(t=>{this.headers=t.data.name,this.headers.push({text:"Actions",value:"action",sortable:!1}),this.conformity=t.data.data,this.loading=!1})},boolRepr(t){return!0===t?"green":!1===t?"red":"primary"}}},Bn=zn,Kn=Object(u["a"])(Bn,Nn,qn,!1,null,"17fff23f",null),Hn=Kn.exports;h()(Kn,{VBtn:_["a"],VCard:ut["a"],VCardTitle:mt["c"],VChip:Et["a"],VDataTable:Gt["a"],VSpacer:E["a"],VTextField:O["a"]});var Gn={name:"Conformity",components:{ConformityTable:Hn}},Wn=Gn,Yn=Object(u["a"])(Wn,Un,Jn,!1,null,"0d1875f3",null),Qn=Yn.exports;h()(Yn,{VCol:Pt["a"],VContainer:g["a"],VRow:Ut["a"]});var Xn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12",lg:"4"}},[a("ConformityCard",{attrs:{minion_id:t.minion_id,conformity:t.conformity,custom_conformity:t.custom_conformity}})],1),a("v-col",{attrs:{sm:"12",lg:"8"}},[a("ConformityDetailCard",{attrs:{succeeded:t.succeeded,unchanged:t.unchanged,failed:t.failed}})],1)],1)],1)},Zn=[],ts=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v("\n    Highstate Conformity\n    "),a("v-expand-transition",[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:t.expand_search,expression:"expand_search"}],staticClass:"mx-auto",attrs:{"hide-details":"",label:"Search","solo-inverted":""}})],1),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.expand_search=!t.expand_search}}},[a("v-icon",[t._v("mdi-magnify")])],1)],1),a("v-expansion-panels",t._l(t.succeeded,function(e,n){return a("v-expansion-panel",{key:n,attrs:{dark:""}},[a("v-expansion-panel-header",{scopedSlots:t._u([{key:"actions",fn:function(){return[a("v-icon",{attrs:{color:"green"}},[t._v("$vuetify.icons.expand")])]},proxy:!0}],null,!0)},[t._v(t._s(n)+"\n        ")]),a("v-expansion-panel-content",{domProps:{innerHTML:t._s(e)}})],1)}),1),a("v-expansion-panels",t._l(t.unchanged,function(e,n){return a("v-expansion-panel",{key:n},[a("v-expansion-panel-header",{scopedSlots:t._u([{key:"actions",fn:function(){return[a("v-icon",{attrs:{color:"orange"}},[t._v("$vuetify.icons.expand")])]},proxy:!0}],null,!0)},[t._v(t._s(n)+"\n        ")]),a("v-expansion-panel-content",{domProps:{innerHTML:t._s(e)}})],1)}),1),a("v-expansion-panels",t._l(t.failed,function(e,n){return a("v-expansion-panel",{key:n},[a("v-expansion-panel-header",{scopedSlots:t._u([{key:"actions",fn:function(){return[a("v-icon",{attrs:{color:"red"}},[t._v("$vuetify.icons.expand")])]},proxy:!0}],null,!0)},[t._v(t._s(n)+"\n        ")]),a("v-expansion-panel-content",{domProps:{innerHTML:t._s(e)}})],1)}),1)],1)},es=[],as={name:"ConformityDetailCard",props:["succeeded","unchanged","failed"],data(){return{expand_search:!1}}},ns=as,ss=(a("31c4"),a("cd55")),is=a("49e2"),rs=a("c865"),os=a("0393"),ls=Object(u["a"])(ns,ts,es,!1,null,"e539baac",null),cs=ls.exports;h()(ls,{VBtn:_["a"],VCard:ut["a"],VCardTitle:mt["c"],VExpandTransition:k["a"],VExpansionPanel:ss["a"],VExpansionPanelContent:is["a"],VExpansionPanelHeader:rs["a"],VExpansionPanels:os["a"],VIcon:C["a"],VTextField:O["a"]});var ds=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v(t._s(t.minion_id))]),a("v-simple-table",[a("tbody",[a("tr",[a("td",[t._v("Highstate")]),a("td",{staticClass:"text-right"},[a("v-chip",{attrs:{color:t.boolRepr(t.conformity),dark:""}},[t._v(t._s(t.valRepr(t.conformity)))])],1)])]),t._l(t.custom_conformity,function(e){return a("tbody",{key:e.key},t._l(e,function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.valRepr(e)))])])}),0)})],2)],1)},us=[],ms={name:"ConformityCard",props:["minion_id","conformity","custom_conformity"],data(){return{}},methods:{boolRepr(t){return!0===t?"green":!1===t?"red":"primary"},valRepr(t){return null===t?"unknown":t}}},hs=ms,vs=Object(u["a"])(hs,ds,us,!1,null,"ca0aac0c",null),fs=vs.exports;h()(vs,{VCard:ut["a"],VCardTitle:mt["c"],VChip:Et["a"],VSimpleTable:ht["a"]});var ps={name:"ConformityDetail",props:["minion_id"],components:{ConformityCard:fs,ConformityDetailCard:cs},data(){return{conformity:"",succeeded:{},unchanged:{},failed:{},custom_conformity:[]}},mounted(){this.loadConformity()},methods:{loadConformity(){this.$http.get("api/minions/"+this.minion_id+"/conformity_detail").then(t=>{this.conformity=t.data.conformity,this.custom_conformity=t.data.custom_conformity,this.succeeded=t.data.succeeded,this.unchanged=t.data.unchanged,this.failed=t.data.failed})}}},bs=ps,_s=Object(u["a"])(bs,Xn,Zn,!1,null,"5b1b3428",null),gs=_s.exports;h()(_s,{VCol:Pt["a"],VContainer:g["a"],VRow:Ut["a"]});var ys=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("UserCard")],1)},xs=[],ks=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("v-card",[a("v-card-title",[t._v(t._s(!0===t.editing?"Update User":"Create User"))]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"Username",rules:t.userRules,required:""},model:{value:t.user.username,callback:function(e){t.$set(t.user,"username",e)},expression:"user.username"}})],1),a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"Email",rules:t.emailRules,required:""},model:{value:t.user.email,callback:function(e){t.$set(t.user,"email",e)},expression:"user.email"}})],1)],1),a("v-row",[a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"First Name"},model:{value:t.user.first_name,callback:function(e){t.$set(t.user,"first_name",e)},expression:"user.first_name"}})],1),a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{label:"Last Name"},model:{value:t.user.last_name,callback:function(e){t.$set(t.user,"last_name",e)},expression:"user.last_name"}})],1)],1),a("v-row",[a("v-col",{attrs:{lg:"6"}},[a("v-text-field",{attrs:{"append-icon":t.show?"visibility":"visibility_off",type:t.show?"text":"password",name:"input-10-1",label:"Password",counter:""},on:{"click:append":function(e){t.show=!t.show}},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}})],1),a("v-col",{attrs:{lg:"6"}},[a("v-checkbox",{attrs:{label:"Staff User"},model:{value:t.user.is_staff,callback:function(e){t.$set(t.user,"is_staff",e)},expression:"user.is_staff"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),t.editing?a("v-btn",{attrs:{color:"primary"},on:{click:t.resetUser}},[t._v("Discard")]):t._e(),t.editing?a("v-btn",{attrs:{color:"warning"},on:{click:t.updateUser}},[t._v("Update")]):t._e(),t.editing?t._e():a("v-btn",{attrs:{color:"warning",disabled:null==t.user.username||""==t.user.email},on:{click:t.createUser}},[t._v("Create\n          ")])],1)],1)],1)],1),a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("v-card",[a("v-card-title",[t._v("\n          Users\n          "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"username",headers:t.headers,items:t.users,search:t.search},scopedSlots:t._u([{key:"item.is_staff",fn:function(e){var n=e.item;return[n.is_staff?a("v-chip",{attrs:{color:"primary",dark:""}},[t._v(t._s(n.is_staff))]):t._e()]}},{key:"item.date_joined",fn:function(e){var a=e.item;return[t._v("\n            "+t._s(new Date(a.date_joined).toLocaleString("en-GB"))+"\n          ")]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"ma-2",attrs:{small:"",color:"orange",tile:"",dark:""},on:{click:function(e){return t.editUser(n)}}},[t._v("\n                update\n              ")]),a("v-btn",{attrs:{small:"",color:"red",tile:"",dark:""},on:{click:function(e){return t.deleteUser(n.id)}}},[t._v("\n                delete\n              ")])],1)]}}])})],1)],1)],1)],1)},Cs=[],Vs={name:"UserCard",data(){return{search:"",headers:[{text:"Username",value:"username"},{text:"First Name",value:"first_name"},{text:"Last Name",value:"last_name"},{text:"Email",value:"email"},{text:"Staff",value:"is_staff"},{text:"Date Joined",value:"date_joined"},{text:"Actions",value:"action",sortable:!1}],userRules:[t=>!!t||"Username is required"],emailRules:[t=>!!t||"E-mail is required",t=>/.+@.+/.test(t)||"E-mail must be valid"],users:[],user:{},editing:!1,show:!1}},mounted(){this.getUsers()},methods:{getUsers(){this.$http.get("api/users/").then(t=>{this.users=t.data})},createUser(){let t=new FormData;Object.keys(this.user).forEach(e=>t.append(e,this.user[e])),this.$http.post("api/users/",t).then(()=>{this.$toast("User created")}).then(()=>{this.user={},this.getUsers()})},updateUser(){this.editing=!1;let t=new FormData;t.set("username",this.user.username),t.set("email",this.user.email),t.set("first_name",this.user.first_name),t.set("last_name",this.user.last_name),t.set("password",this.user.password),t.set("is_staff",this.user.is_staff),this.$http.patch("api/users/"+this.user.id+"/",t).then(()=>{this.$toast("User updated"),this.user={}}).then(()=>{this.getUsers()})},deleteUser(t){this.$http.delete("api/users/"+t).then(()=>{this.$toast("User deleted")}).then(()=>this.getUsers())},editUser(t){this.editing=!0,this.user=t},resetUser(){this.editing=!1,this.user={}}}},js=Vs,ws=a("ac7c"),Ss=Object(u["a"])(js,ks,Cs,!1,null,"771adece",null),Ts=Ss.exports;h()(Ss,{VBtn:_["a"],VCard:ut["a"],VCardActions:mt["a"],VCardText:mt["b"],VCardTitle:mt["c"],VCheckbox:ws["a"],VChip:Et["a"],VCol:Pt["a"],VContainer:g["a"],VDataTable:Gt["a"],VRow:Ut["a"],VSpacer:E["a"],VTextField:O["a"]});var $s={name:"Users",components:{UserCard:Ts}},Ds=$s,Es=Object(u["a"])(Ds,ys,xs,!1,null,"68043e29",null),Os=Es.exports;h()(Es,{VContainer:g["a"]});var Ls=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("ScheduleTable",{key:t.refreshKey}),t.fabs?a("Fab",{attrs:{fabs:t.fabs},on:{fab_action:t.fabAction}}):t._e()],1)},Fs=[],As=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-card",[a("v-card-title",[t._v("\n      Schedules\n      "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{"sort-by":"minion",headers:t.headers,items:t.schedules,search:t.search,loading:t.loading},scopedSlots:t._u([{key:"item.enabled",fn:function(e){var n=e.item;return[a("v-chip",{attrs:{color:t.boolRepr(n.enabled),dark:""}},[t._v(t._s(n.enabled))])]}},{key:"item.action",fn:function(e){var n=e.item;return[a("div",{staticClass:"text-center"},[a("v-btn",{attrs:{small:"",color:"red",tile:"",dark:""},on:{click:function(e){return t.manageSchedule("delete",n.name,n.minion)}}},[t._v("\n            delete\n          ")])],1)]}}])})],1)],1)},Rs=[],Is={name:"ScheduleTable",data(){return{search:"",headers:[],schedules:[],loading:!0}},methods:{loadData(){this.loading=!1,this.$http.get("api/schedules/").then(t=>{this.schedules=t.data,this.schedules.length>0&&(Object.keys(t.data[0]).forEach(t=>{"id"!==t&&this.headers.push({text:t,value:t})}),this.headers.push({text:"action",value:"action"}))})},manageSchedule(t,e,a){let n=new FormData;n.set("action",t),n.set("name",e),n.set("minion",a),this.$toast("performing "+t+" schedule "+e+" on "+a),this.$http.post("api/schedules/manage/",n).then(t=>{this.$toast(t.data.result)})},boolRepr(t){return!0===t?"green":!1===t?"red":"primary"}},mounted(){this.loadData()}},Ms=Is,Ps=Object(u["a"])(Ms,As,Rs,!1,null,"24377ece",null),Us=Ps.exports;h()(Ps,{VBtn:_["a"],VCard:ut["a"],VCardTitle:mt["c"],VChip:Et["a"],VContainer:g["a"],VDataTable:Gt["a"],VSpacer:E["a"],VTextField:O["a"]});var Js={name:"Schedules",components:{Fab:$e,ScheduleTable:Us},data:()=>({fabs:[{color:"pink",action:"refreshSchedules",icon:"refresh",tooltip:"Refresh schedules"}],refreshKey:0}),methods:{fabAction(t){this[t]()},refreshSchedules(){this.$toast("refreshing schedules"),this.$http.post("/api/schedules/refresh/").then(()=>{this.refreshKey+=1,this.$toast("schedules refreshed")}).catch(function(t){alert(t)})}}},Ns=Js,qs=Object(u["a"])(Ns,Ls,Fs,!1,null,"98bcc40c",null),zs=qs.exports;h()(qs,{VContainer:g["a"]});var Bs=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"4",offset:"4"}},[a("v-card",[a("v-card-title",{staticClass:"black white--text subheading",attrs:{"primary-title":""}},[a("span",{staticClass:"title"},[t._v("Oops")])]),a("v-card-text",{staticClass:"display-1 ma-7 text-center"},[t._v("\n          404. There is no page here.\n        ")]),a("v-card-actions",[a("v-btn",{staticClass:"primary darken-3 white--text",attrs:{text:"",to:"/"}},[a("v-icon",{attrs:{left:""},domProps:{textContent:t._s("mdi-arrow-left")}}),t._v("\n            Back\n          ")],1)],1)],1)],1)],1)],1)},Ks=[],Hs={name:"NotFound"},Gs=Hs,Ws=Object(u["a"])(Gs,Bs,Ks,!1,null,"06e44549",null),Ys=Ws.exports;h()(Ws,{VBtn:_["a"],VCard:ut["a"],VCardActions:mt["a"],VCardText:mt["b"],VCardTitle:mt["c"],VCol:Pt["a"],VContainer:g["a"],VIcon:C["a"],VRow:Ut["a"]}),n["a"].use(tt["a"]);const Qs=new tt["a"]({routes:[{path:"/",name:"home",component:te},{path:"/minions",name:"minions",component:Ke},{path:"/minions/:minion_id",name:"minion_detail",component:ja,props:!0},{path:"/jobs",name:"jobs",component:ve},{path:"/jobs/:jid/:minion_id",name:"job_detail",component:Ea,props:!0},{path:"/run",name:"run",component:xn},{path:"/keys",name:"keys",component:Le},{path:"/events",name:"events",component:Ka},{path:"/conformity",name:"conformity",component:Qn},{path:"/conformity/:minion_id",name:"conformity_detail",component:gs,props:!0},{path:"/schedules",name:"schedules",component:zs},{path:"/users",name:"users",component:Os},{path:"/settings",name:"settings",component:Pn},{path:"/login",name:"Login",component:le,meta:{plainLayout:!0}},{path:"*",component:Ys}]});Qs.beforeEach((t,e,a)=>{st.getters.isLoggedIn||"/login"===t.path?"/login"===t.path&&st.getters.isLoggedIn?a("/"):a():a("/login")});var Xs=Qs;n["a"].config.productionTip=!1,n["a"].prototype.$http=nt.a,n["a"].prototype.$http.defaults.xsrfCookieName="csrftoken",n["a"].prototype.$http.defaults.xsrfHeaderName="X-CSRFToken",n["a"].prototype.$http.defaults.headers.common["Content-Type"]="application/json";const Zs=localStorage.getItem("token");Zs&&(n["a"].prototype.$http.defaults.headers.common.Authorization=`Bearer ${Zs}`,n["a"].prototype.$http.defaults.withCredentials=!0);let ti=!1,ei=[];const ai=(t,e=null)=>{ei.forEach(a=>{t?a.reject(t):a.resolve(e)}),ei=[]};n["a"].prototype.$http.interceptors.response.use(function(t){return t},function(t){const e=t.config;if(401===t.response.status&&!e._retry){if(ti)return new Promise(function(t,e){ei.push({resolve:t,reject:e})}).then(t=>{return e.headers["Authorization"]="Bearer "+t,n["a"].prototype.$http(e)}).catch(t=>{return t});e._retry=!0,ti=!0;const t=window.localStorage.getItem("refresh");return new Promise(function(a,s){n["a"].prototype.$http.post("/api/token/refresh/",{refresh:t}).then(({data:t})=>{window.localStorage.setItem("access",t.access),n["a"].prototype.$http.defaults.headers.common["Authorization"]="Bearer "+t.access,e.headers["Authorization"]="Bearer "+t.access,ai(null,t.access),a(n["a"].prototype.$http(e))}).catch(t=>{ai(t,null),s(t)}).then(()=>{ti=!1})})}return Promise.reject(t).then(()=>{Xs.push("/login")})}),new n["a"]({vuetify:Z,router:Xs,store:st,render:t=>t(K)}).$mount("#app")},6141:function(t,e,a){"use strict";var n=a("0e47"),s=a.n(n);s.a},"7d02":function(t,e,a){},"84d3":function(t,e,a){"use strict";var n=a("7d02"),s=a.n(n);s.a},"91a6":function(t,e,a){},ab34:function(t,e,a){},e6f2:function(t,e,a){},efe9:function(t,e,a){}});
//# sourceMappingURL=app.fb5dceb4.js.map